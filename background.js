"use strict";(()=>{var yc=Object.create;var Oo=Object.defineProperty;var wc=Object.getOwnPropertyDescriptor;var Dc=Object.getOwnPropertyNames;var Fc=Object.getPrototypeOf,Sc=Object.prototype.hasOwnProperty;var et=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var kc=(e,t,A,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Dc(t))!Sc.call(e,r)&&r!==A&&Oo(e,r,{get:()=>t[r],enumerable:!(i=wc(t,r))||i.enumerable});return e};var U=(e,t,A)=>(A=e!=null?yc(Fc(e)):{},kc(t||!e||!e.__esModule?Oo(A,"default",{value:e,enumerable:!0}):A,e));var K=et((pr,Pa)=>{(function(e,t){if(typeof define=="function"&&define.amd)define("webextension-polyfill",["module"],t);else if(typeof pr<"u")t(Pa);else{var A={exports:{}};t(A),e.browser=A.exports}})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:pr,function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{let t="The message port closed before a response was received.",A=i=>{let r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(r).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class o extends WeakMap{constructor(p,f=void 0){super(f),this.createItem=p}get(p){return this.has(p)||this.set(p,this.createItem(p)),super.get(p)}}let n=E=>E&&typeof E=="object"&&typeof E.then=="function",a=(E,p)=>(...f)=>{i.runtime.lastError?E.reject(new Error(i.runtime.lastError.message)):p.singleCallbackArg||f.length<=1&&p.singleCallbackArg!==!1?E.resolve(f[0]):E.resolve(f)},s=E=>E==1?"argument":"arguments",g=(E,p)=>function(d,...B){if(B.length<p.minArgs)throw new Error(`Expected at least ${p.minArgs} ${s(p.minArgs)} for ${E}(), got ${B.length}`);if(B.length>p.maxArgs)throw new Error(`Expected at most ${p.maxArgs} ${s(p.maxArgs)} for ${E}(), got ${B.length}`);return new Promise((D,b)=>{if(p.fallbackToNoCallback)try{d[E](...B,a({resolve:D,reject:b},p))}catch{d[E](...B),p.fallbackToNoCallback=!1,p.noCallback=!0,D()}else p.noCallback?(d[E](...B),D()):d[E](...B,a({resolve:D,reject:b},p))})},I=(E,p,f)=>new Proxy(p,{apply(d,B,D){return f.call(B,E,...D)}}),l=Function.call.bind(Object.prototype.hasOwnProperty),c=(E,p={},f={})=>{let d=Object.create(null),B={has(b,S){return S in E||S in d},get(b,S,G){if(S in d)return d[S];if(!(S in E))return;let Q=E[S];if(typeof Q=="function")if(typeof p[S]=="function")Q=I(E,E[S],p[S]);else if(l(f,S)){let k=g(S,f[S]);Q=I(E,E[S],k)}else Q=Q.bind(E);else if(typeof Q=="object"&&Q!==null&&(l(p,S)||l(f,S)))Q=c(Q,p[S],f[S]);else if(l(f,"*"))Q=c(Q,p[S],f["*"]);else return Object.defineProperty(d,S,{configurable:!0,enumerable:!0,get(){return E[S]},set(k){E[S]=k}}),Q;return d[S]=Q,Q},set(b,S,G,Q){return S in d?d[S]=G:E[S]=G,!0},defineProperty(b,S,G){return Reflect.defineProperty(d,S,G)},deleteProperty(b,S){return Reflect.deleteProperty(d,S)}},D=Object.create(E);return new Proxy(D,B)},u=E=>({addListener(p,f,...d){p.addListener(E.get(f),...d)},hasListener(p,f){return p.hasListener(E.get(f))},removeListener(p,f){p.removeListener(E.get(f))}}),m=new o(E=>typeof E!="function"?E:function(f){let d=c(f,{},{getContent:{minArgs:0,maxArgs:0}});E(d)}),y=new o(E=>typeof E!="function"?E:function(f,d,B){let D=!1,b,S=new Promise(R=>{b=function(T){D=!0,R(T)}}),G;try{G=E(f,d,b)}catch(R){G=Promise.reject(R)}let Q=G!==!0&&n(G);if(G!==!0&&!Q&&!D)return!1;let k=R=>{R.then(T=>{B(T)},T=>{let v;T&&(T instanceof Error||typeof T.message=="string")?v=T.message:v="An unexpected error occurred",B({__mozWebExtensionPolyfillReject__:!0,message:v})}).catch(T=>{})};return k(Q?G:S),!0}),C=({reject:E,resolve:p},f)=>{i.runtime.lastError?i.runtime.lastError.message===t?p():E(new Error(i.runtime.lastError.message)):f&&f.__mozWebExtensionPolyfillReject__?E(new Error(f.message)):p(f)},w=(E,p,f,...d)=>{if(d.length<p.minArgs)throw new Error(`Expected at least ${p.minArgs} ${s(p.minArgs)} for ${E}(), got ${d.length}`);if(d.length>p.maxArgs)throw new Error(`Expected at most ${p.maxArgs} ${s(p.maxArgs)} for ${E}(), got ${d.length}`);return new Promise((B,D)=>{let b=C.bind(null,{resolve:B,reject:D});d.push(b),f.sendMessage(...d)})},x={devtools:{network:{onRequestFinished:u(m)}},runtime:{onMessage:u(y),onMessageExternal:u(y),sendMessage:w.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:w.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},N={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":N},services:{"*":N},websites:{"*":N}},c(i,x,r)};e.exports=A(chrome)}})});var Us=et((vx,yi)=>{(function(){"use strict";var e={}.hasOwnProperty;function t(){for(var r="",o=0;o<arguments.length;o++){var n=arguments[o];n&&(r=i(r,A(n)))}return r}function A(r){if(typeof r=="string"||typeof r=="number")return r;if(typeof r!="object")return"";if(Array.isArray(r))return t.apply(null,r);if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]"))return r.toString();var o="";for(var n in r)e.call(r,n)&&r[n]&&(o=i(o,n));return o}function i(r,o){return o?r?r+" "+o:r+o:r}typeof yi<"u"&&yi.exports?(t.default=t,yi.exports=t):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return t}):window.classNames=t})()});var Kg=et(_=>{"use strict";var xA=Symbol.for("react.element"),iC=Symbol.for("react.portal"),rC=Symbol.for("react.fragment"),oC=Symbol.for("react.strict_mode"),nC=Symbol.for("react.profiler"),aC=Symbol.for("react.provider"),sC=Symbol.for("react.context"),gC=Symbol.for("react.forward_ref"),IC=Symbol.for("react.suspense"),cC=Symbol.for("react.memo"),lC=Symbol.for("react.lazy"),Ug=Symbol.iterator;function uC(e){return e===null||typeof e!="object"?null:(e=Ug&&e[Ug]||e["@@iterator"],typeof e=="function"?e:null)}var Rg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vg=Object.assign,Tg={};function $t(e,t,A){this.props=e,this.context=t,this.refs=Tg,this.updater=A||Rg}$t.prototype.isReactComponent={};$t.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$t.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qg(){}qg.prototype=$t.prototype;function Ao(e,t,A){this.props=e,this.context=t,this.refs=Tg,this.updater=A||Rg}var io=Ao.prototype=new qg;io.constructor=Ao;vg(io,$t.prototype);io.isPureReactComponent=!0;var Mg=Array.isArray,_g=Object.prototype.hasOwnProperty,ro={current:null},Jg={key:!0,ref:!0,__self:!0,__source:!0};function Pg(e,t,A){var i,r={},o=null,n=null;if(t!=null)for(i in t.ref!==void 0&&(n=t.ref),t.key!==void 0&&(o=""+t.key),t)_g.call(t,i)&&!Jg.hasOwnProperty(i)&&(r[i]=t[i]);var a=arguments.length-2;if(a===1)r.children=A;else if(1<a){for(var s=Array(a),g=0;g<a;g++)s[g]=arguments[g+2];r.children=s}if(e&&e.defaultProps)for(i in a=e.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:xA,type:e,key:o,ref:n,props:r,_owner:ro.current}}function fC(e,t){return{$$typeof:xA,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function oo(e){return typeof e=="object"&&e!==null&&e.$$typeof===xA}function BC(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(A){return t[A]})}var Hg=/\/+/g;function to(e,t){return typeof e=="object"&&e!==null&&e.key!=null?BC(""+e.key):t.toString(36)}function Hi(e,t,A,i,r){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var n=!1;if(e===null)n=!0;else switch(o){case"string":case"number":n=!0;break;case"object":switch(e.$$typeof){case xA:case iC:n=!0}}if(n)return n=e,r=r(n),e=i===""?"."+to(n,0):i,Mg(r)?(A="",e!=null&&(A=e.replace(Hg,"$&/")+"/"),Hi(r,t,A,"",function(g){return g})):r!=null&&(oo(r)&&(r=fC(r,A+(!r.key||n&&n.key===r.key?"":(""+r.key).replace(Hg,"$&/")+"/")+e)),t.push(r)),1;if(n=0,i=i===""?".":i+":",Mg(e))for(var a=0;a<e.length;a++){o=e[a];var s=i+to(o,a);n+=Hi(o,t,A,s,r)}else if(s=uC(e),typeof s=="function")for(e=s.call(e),a=0;!(o=e.next()).done;)o=o.value,s=i+to(o,a++),n+=Hi(o,t,A,s,r);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return n}function Mi(e,t,A){if(e==null)return e;var i=[],r=0;return Hi(e,i,"","",function(o){return t.call(A,o,r++)}),i}function pC(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(A){(e._status===0||e._status===-1)&&(e._status=1,e._result=A)},function(A){(e._status===0||e._status===-1)&&(e._status=2,e._result=A)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var fe={current:null},Ri={transition:null},dC={ReactCurrentDispatcher:fe,ReactCurrentBatchConfig:Ri,ReactCurrentOwner:ro};_.Children={map:Mi,forEach:function(e,t,A){Mi(e,function(){t.apply(this,arguments)},A)},count:function(e){var t=0;return Mi(e,function(){t++}),t},toArray:function(e){return Mi(e,function(t){return t})||[]},only:function(e){if(!oo(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_.Component=$t;_.Fragment=rC;_.Profiler=nC;_.PureComponent=Ao;_.StrictMode=oC;_.Suspense=IC;_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dC;_.cloneElement=function(e,t,A){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=vg({},e.props),r=e.key,o=e.ref,n=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,n=ro.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(s in t)_g.call(t,s)&&!Jg.hasOwnProperty(s)&&(i[s]=t[s]===void 0&&a!==void 0?a[s]:t[s])}var s=arguments.length-2;if(s===1)i.children=A;else if(1<s){a=Array(s);for(var g=0;g<s;g++)a[g]=arguments[g+2];i.children=a}return{$$typeof:xA,type:e.type,key:r,ref:o,props:i,_owner:n}};_.createContext=function(e){return e={$$typeof:sC,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:aC,_context:e},e.Consumer=e};_.createElement=Pg;_.createFactory=function(e){var t=Pg.bind(null,e);return t.type=e,t};_.createRef=function(){return{current:null}};_.forwardRef=function(e){return{$$typeof:gC,render:e}};_.isValidElement=oo;_.lazy=function(e){return{$$typeof:lC,_payload:{_status:-1,_result:e},_init:pC}};_.memo=function(e,t){return{$$typeof:cC,type:e,compare:t===void 0?null:t}};_.startTransition=function(e){var t=Ri.transition;Ri.transition={};try{e()}finally{Ri.transition=t}};_.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};_.useCallback=function(e,t){return fe.current.useCallback(e,t)};_.useContext=function(e){return fe.current.useContext(e)};_.useDebugValue=function(){};_.useDeferredValue=function(e){return fe.current.useDeferredValue(e)};_.useEffect=function(e,t){return fe.current.useEffect(e,t)};_.useId=function(){return fe.current.useId()};_.useImperativeHandle=function(e,t,A){return fe.current.useImperativeHandle(e,t,A)};_.useInsertionEffect=function(e,t){return fe.current.useInsertionEffect(e,t)};_.useLayoutEffect=function(e,t){return fe.current.useLayoutEffect(e,t)};_.useMemo=function(e,t){return fe.current.useMemo(e,t)};_.useReducer=function(e,t,A){return fe.current.useReducer(e,t,A)};_.useRef=function(e){return fe.current.useRef(e)};_.useState=function(e){return fe.current.useState(e)};_.useSyncExternalStore=function(e,t,A){return fe.current.useSyncExternalStore(e,t,A)};_.useTransition=function(){return fe.current.useTransition()};_.version="18.2.0"});var Qe=et((FN,Og)=>{"use strict";Og.exports=Kg()});var Zg=et((vN,Xg)=>{"use strict";Xg.exports=()=>{let e={};return e.promise=new Promise((t,A)=>{e.resolve=t,e.reject=A}),e}});var $g=et((TN,jg)=>{"use strict";var wC=Zg();function DC(e,t="maxAge"){let A,i,r,o=async()=>{if(A!==void 0)return;let s=async g=>{r=wC();let I=g[1][t]-Date.now();if(I<=0){e.delete(g[0]),r.resolve();return}return A=g[0],i=setTimeout(()=>{e.delete(g[0]),r&&r.resolve()},I),typeof i.unref=="function"&&i.unref(),r.promise};try{for(let g of e)await s(g)}catch{}A=void 0},n=()=>{A=void 0,i!==void 0&&(clearTimeout(i),i=void 0),r!==void 0&&(r.reject(void 0),r=void 0)},a=e.set.bind(e);return e.set=(s,g)=>{e.has(s)&&e.delete(s);let I=a(s,g);return A&&A===s&&n(),o(),I},o(),e}jg.exports=DC});var go=et((qN,eI)=>{"use strict";var FC=$g(),so=class{constructor(t,A){if(this.maxAge=t,this[Symbol.toStringTag]="Map",this.data=new Map,FC(this.data),A)for(let[i,r]of A)this.set(i,r)}get size(){return this.data.size}clear(){this.data.clear()}delete(t){return this.data.delete(t)}has(t){return this.data.has(t)}get(t){let A=this.data.get(t);if(A)return A.data}set(t,A){return this.data.set(t,{maxAge:Date.now()+this.maxAge,data:A}),this}values(){return this.createIterator(t=>t[1].data)}keys(){return this.data.keys()}entries(){return this.createIterator(t=>[t[0],t[1].data])}forEach(t,A){for(let[i,r]of this.entries())t.apply(A,[r,i,this])}[Symbol.iterator](){return this.entries()}*createIterator(t){for(let A of this.data.entries())yield t(A)}};eI.exports=so});var PI=et(($G,JI)=>{JI.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var xc=typeof global=="object"&&global&&global.Object===Object&&global,PA=xc;var bc=typeof self=="object"&&self&&self.Object===Object&&self,Nc=PA||bc||Function("return this")(),ee=Nc;var Gc=ee.Symbol,Pe=Gc;var Lo=Object.prototype,Uc=Lo.hasOwnProperty,Mc=Lo.toString,aA=Pe?Pe.toStringTag:void 0;function Hc(e){var t=Uc.call(e,aA),A=e[aA];try{e[aA]=void 0;var i=!0}catch{}var r=Mc.call(e);return i&&(t?e[aA]=A:delete e[aA]),r}var Yo=Hc;var Rc=Object.prototype,vc=Rc.toString;function Tc(e){return vc.call(e)}var Vo=Tc;var qc="[object Null]",_c="[object Undefined]",zo=Pe?Pe.toStringTag:void 0;function Jc(e){return e==null?e===void 0?_c:qc:zo&&zo in Object(e)?Yo(e):Vo(e)}var Ce=Jc;function Pc(e){return e!=null&&typeof e=="object"}var Ie=Pc;var Kc="[object Symbol]";function Oc(e){return typeof e=="symbol"||Ie(e)&&Ce(e)==Kc}var Wo=Oc;var Lc=Array.isArray,we=Lc;var Yc=/\s/;function Vc(e){for(var t=e.length;t--&&Yc.test(e.charAt(t)););return t}var Xo=Vc;var zc=/^\s+/;function Wc(e){return e&&e.slice(0,Xo(e)+1).replace(zc,"")}var Zo=Wc;function Xc(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var te=Xc;var jo=NaN,Zc=/^[-+]0x[0-9a-f]+$/i,jc=/^0b[01]+$/i,$c=/^0o[0-7]+$/i,el=parseInt;function tl(e){if(typeof e=="number")return e;if(Wo(e))return jo;if(te(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=te(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Zo(e);var A=jc.test(e);return A||$c.test(e)?el(e.slice(2),A?2:8):Zc.test(e)?jo:+e}var or=tl;function Al(e){return e}var KA=Al;var il="[object AsyncFunction]",rl="[object Function]",ol="[object GeneratorFunction]",nl="[object Proxy]";function al(e){if(!te(e))return!1;var t=Ce(e);return t==rl||t==ol||t==il||t==nl}var xt=al;var sl=ee["__core-js_shared__"],OA=sl;var $o=function(){var e=/[^.]+$/.exec(OA&&OA.keys&&OA.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function gl(e){return!!$o&&$o in e}var en=gl;var Il=Function.prototype,cl=Il.toString;function ll(e){if(e!=null){try{return cl.call(e)}catch{}try{return e+""}catch{}}return""}var Ke=ll;var ul=/[\\^$.*+?()[\]{}|]/g,fl=/^\[object .+?Constructor\]$/,Bl=Function.prototype,pl=Object.prototype,dl=Bl.toString,Cl=pl.hasOwnProperty,Ql=RegExp("^"+dl.call(Cl).replace(ul,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ml(e){if(!te(e)||en(e))return!1;var t=xt(e)?Ql:fl;return t.test(Ke(e))}var tn=ml;function hl(e,t){return e?.[t]}var An=hl;function El(e,t){var A=An(e,t);return tn(A)?A:void 0}var Be=El;var yl=Be(ee,"WeakMap"),LA=yl;var rn=Object.create,wl=function(){function e(){}return function(t){if(!te(t))return{};if(rn)return rn(t);e.prototype=t;var A=new e;return e.prototype=void 0,A}}(),on=wl;function Dl(e,t,A){switch(A.length){case 0:return e.call(t);case 1:return e.call(t,A[0]);case 2:return e.call(t,A[0],A[1]);case 3:return e.call(t,A[0],A[1],A[2])}return e.apply(t,A)}var nn=Dl;function Fl(){}var Oe=Fl;function Sl(e,t){var A=-1,i=e.length;for(t||(t=Array(i));++A<i;)t[A]=e[A];return t}var YA=Sl;var kl=800,xl=16,bl=Date.now;function Nl(e){var t=0,A=0;return function(){var i=bl(),r=xl-(i-A);if(A=i,r>0){if(++t>=kl)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var an=Nl;function Gl(e){return function(){return e}}var sn=Gl;var Ul=function(){try{var e=Be(Object,"defineProperty");return e({},"",{}),e}catch{}}(),bt=Ul;var Ml=bt?function(e,t){return bt(e,"toString",{configurable:!0,enumerable:!1,value:sn(t),writable:!0})}:KA,gn=Ml;var Hl=an(gn),In=Hl;function Rl(e,t){for(var A=-1,i=e==null?0:e.length;++A<i&&t(e[A],A,e)!==!1;);return e}var cn=Rl;var vl=9007199254740991,Tl=/^(?:0|[1-9]\d*)$/;function ql(e,t){var A=typeof e;return t=t??vl,!!t&&(A=="number"||A!="symbol"&&Tl.test(e))&&e>-1&&e%1==0&&e<t}var VA=ql;function _l(e,t,A){t=="__proto__"&&bt?bt(e,t,{configurable:!0,enumerable:!0,value:A,writable:!0}):e[t]=A}var Nt=_l;function Jl(e,t){return e===t||e!==e&&t!==t}var tt=Jl;var Pl=Object.prototype,Kl=Pl.hasOwnProperty;function Ol(e,t,A){var i=e[t];(!(Kl.call(e,t)&&tt(i,A))||A===void 0&&!(t in e))&&Nt(e,t,A)}var zA=Ol;function Ll(e,t,A,i){var r=!A;A||(A={});for(var o=-1,n=t.length;++o<n;){var a=t[o],s=i?i(A[a],e[a],a,A,e):void 0;s===void 0&&(s=e[a]),r?Nt(A,a,s):zA(A,a,s)}return A}var Ne=Ll;var ln=Math.max;function Yl(e,t,A){return t=ln(t===void 0?e.length-1:t,0),function(){for(var i=arguments,r=-1,o=ln(i.length-t,0),n=Array(o);++r<o;)n[r]=i[t+r];r=-1;for(var a=Array(t+1);++r<t;)a[r]=i[r];return a[t]=A(n),nn(e,this,a)}}var un=Yl;function Vl(e,t){return In(un(e,t,KA),e+"")}var fn=Vl;var zl=9007199254740991;function Wl(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=zl}var WA=Wl;function Xl(e){return e!=null&&WA(e.length)&&!xt(e)}var Ge=Xl;function Zl(e,t,A){if(!te(A))return!1;var i=typeof t;return(i=="number"?Ge(A)&&VA(t,A.length):i=="string"&&t in A)?tt(A[t],e):!1}var Bn=Zl;function jl(e){return fn(function(t,A){var i=-1,r=A.length,o=r>1?A[r-1]:void 0,n=r>2?A[2]:void 0;for(o=e.length>3&&typeof o=="function"?(r--,o):void 0,n&&Bn(A[0],A[1],n)&&(o=r<3?void 0:o,r=1),t=Object(t);++i<r;){var a=A[i];a&&e(t,a,i,o)}return t})}var pn=jl;var $l=Object.prototype;function eu(e){var t=e&&e.constructor,A=typeof t=="function"&&t.prototype||$l;return e===A}var At=eu;function tu(e,t){for(var A=-1,i=Array(e);++A<e;)i[A]=t(A);return i}var dn=tu;var Au="[object Arguments]";function iu(e){return Ie(e)&&Ce(e)==Au}var nr=iu;var Cn=Object.prototype,ru=Cn.hasOwnProperty,ou=Cn.propertyIsEnumerable,nu=nr(function(){return arguments}())?nr:function(e){return Ie(e)&&ru.call(e,"callee")&&!ou.call(e,"callee")},Ct=nu;function au(){return!1}var Qn=au;var En=typeof exports=="object"&&exports&&!exports.nodeType&&exports,mn=En&&typeof module=="object"&&module&&!module.nodeType&&module,su=mn&&mn.exports===En,hn=su?ee.Buffer:void 0,gu=hn?hn.isBuffer:void 0,Iu=gu||Qn,it=Iu;var cu="[object Arguments]",lu="[object Array]",uu="[object Boolean]",fu="[object Date]",Bu="[object Error]",pu="[object Function]",du="[object Map]",Cu="[object Number]",Qu="[object Object]",mu="[object RegExp]",hu="[object Set]",Eu="[object String]",yu="[object WeakMap]",wu="[object ArrayBuffer]",Du="[object DataView]",Fu="[object Float32Array]",Su="[object Float64Array]",ku="[object Int8Array]",xu="[object Int16Array]",bu="[object Int32Array]",Nu="[object Uint8Array]",Gu="[object Uint8ClampedArray]",Uu="[object Uint16Array]",Mu="[object Uint32Array]",W={};W[Fu]=W[Su]=W[ku]=W[xu]=W[bu]=W[Nu]=W[Gu]=W[Uu]=W[Mu]=!0;W[cu]=W[lu]=W[wu]=W[uu]=W[Du]=W[fu]=W[Bu]=W[pu]=W[du]=W[Cu]=W[Qu]=W[mu]=W[hu]=W[Eu]=W[yu]=!1;function Hu(e){return Ie(e)&&WA(e.length)&&!!W[Ce(e)]}var yn=Hu;function Ru(e){return function(t){return e(t)}}var Gt=Ru;var wn=typeof exports=="object"&&exports&&!exports.nodeType&&exports,sA=wn&&typeof module=="object"&&module&&!module.nodeType&&module,vu=sA&&sA.exports===wn,ar=vu&&PA.process,Tu=function(){try{var e=sA&&sA.require&&sA.require("util").types;return e||ar&&ar.binding&&ar.binding("util")}catch{}}(),Le=Tu;var Dn=Le&&Le.isTypedArray,qu=Dn?Gt(Dn):yn,Ut=qu;var _u=Object.prototype,Ju=_u.hasOwnProperty;function Pu(e,t){var A=we(e),i=!A&&Ct(e),r=!A&&!i&&it(e),o=!A&&!i&&!r&&Ut(e),n=A||i||r||o,a=n?dn(e.length,String):[],s=a.length;for(var g in e)(t||Ju.call(e,g))&&!(n&&(g=="length"||r&&(g=="offset"||g=="parent")||o&&(g=="buffer"||g=="byteLength"||g=="byteOffset")||VA(g,s)))&&a.push(g);return a}var XA=Pu;function Ku(e,t){return function(A){return e(t(A))}}var ZA=Ku;var Ou=ZA(Object.keys,Object),Fn=Ou;var Lu=Object.prototype,Yu=Lu.hasOwnProperty;function Vu(e){if(!At(e))return Fn(e);var t=[];for(var A in Object(e))Yu.call(e,A)&&A!="constructor"&&t.push(A);return t}var jA=Vu;function zu(e){return Ge(e)?XA(e):jA(e)}var Mt=zu;function Wu(e){var t=[];if(e!=null)for(var A in Object(e))t.push(A);return t}var Sn=Wu;var Xu=Object.prototype,Zu=Xu.hasOwnProperty;function ju(e){if(!te(e))return Sn(e);var t=At(e),A=[];for(var i in e)i=="constructor"&&(t||!Zu.call(e,i))||A.push(i);return A}var kn=ju;function $u(e){return Ge(e)?XA(e,!0):kn(e)}var Ue=$u;var ef=Be(Object,"create"),Ye=ef;function tf(){this.__data__=Ye?Ye(null):{},this.size=0}var xn=tf;function Af(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var bn=Af;var rf="__lodash_hash_undefined__",of=Object.prototype,nf=of.hasOwnProperty;function af(e){var t=this.__data__;if(Ye){var A=t[e];return A===rf?void 0:A}return nf.call(t,e)?t[e]:void 0}var Nn=af;var sf=Object.prototype,gf=sf.hasOwnProperty;function If(e){var t=this.__data__;return Ye?t[e]!==void 0:gf.call(t,e)}var Gn=If;var cf="__lodash_hash_undefined__";function lf(e,t){var A=this.__data__;return this.size+=this.has(e)?0:1,A[e]=Ye&&t===void 0?cf:t,this}var Un=lf;function Ht(e){var t=-1,A=e==null?0:e.length;for(this.clear();++t<A;){var i=e[t];this.set(i[0],i[1])}}Ht.prototype.clear=xn;Ht.prototype.delete=bn;Ht.prototype.get=Nn;Ht.prototype.has=Gn;Ht.prototype.set=Un;var sr=Ht;function uf(){this.__data__=[],this.size=0}var Mn=uf;function ff(e,t){for(var A=e.length;A--;)if(tt(e[A][0],t))return A;return-1}var rt=ff;var Bf=Array.prototype,pf=Bf.splice;function df(e){var t=this.__data__,A=rt(t,e);if(A<0)return!1;var i=t.length-1;return A==i?t.pop():pf.call(t,A,1),--this.size,!0}var Hn=df;function Cf(e){var t=this.__data__,A=rt(t,e);return A<0?void 0:t[A][1]}var Rn=Cf;function Qf(e){return rt(this.__data__,e)>-1}var vn=Qf;function mf(e,t){var A=this.__data__,i=rt(A,e);return i<0?(++this.size,A.push([e,t])):A[i][1]=t,this}var Tn=mf;function Rt(e){var t=-1,A=e==null?0:e.length;for(this.clear();++t<A;){var i=e[t];this.set(i[0],i[1])}}Rt.prototype.clear=Mn;Rt.prototype.delete=Hn;Rt.prototype.get=Rn;Rt.prototype.has=vn;Rt.prototype.set=Tn;var ot=Rt;var hf=Be(ee,"Map"),nt=hf;function Ef(){this.size=0,this.__data__={hash:new sr,map:new(nt||ot),string:new sr}}var qn=Ef;function yf(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var _n=yf;function wf(e,t){var A=e.__data__;return _n(t)?A[typeof t=="string"?"string":"hash"]:A.map}var at=wf;function Df(e){var t=at(this,e).delete(e);return this.size-=t?1:0,t}var Jn=Df;function Ff(e){return at(this,e).get(e)}var Pn=Ff;function Sf(e){return at(this,e).has(e)}var Kn=Sf;function kf(e,t){var A=at(this,e),i=A.size;return A.set(e,t),this.size+=A.size==i?0:1,this}var On=kf;function vt(e){var t=-1,A=e==null?0:e.length;for(this.clear();++t<A;){var i=e[t];this.set(i[0],i[1])}}vt.prototype.clear=qn;vt.prototype.delete=Jn;vt.prototype.get=Pn;vt.prototype.has=Kn;vt.prototype.set=On;var gA=vt;var xf="Expected a function";function gr(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(xf);var A=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=A.cache;if(o.has(r))return o.get(r);var n=e.apply(this,i);return A.cache=o.set(r,n)||o,n};return A.cache=new(gr.Cache||gA),A}gr.Cache=gA;var Ir=gr;function bf(e,t){for(var A=-1,i=t.length,r=e.length;++A<i;)e[r+A]=t[A];return e}var $A=bf;var Nf=ZA(Object.getPrototypeOf,Object),Tt=Nf;var Gf="[object Object]",Uf=Function.prototype,Mf=Object.prototype,Ln=Uf.toString,Hf=Mf.hasOwnProperty,Rf=Ln.call(Object);function vf(e){if(!Ie(e)||Ce(e)!=Gf)return!1;var t=Tt(e);if(t===null)return!0;var A=Hf.call(t,"constructor")&&t.constructor;return typeof A=="function"&&A instanceof A&&Ln.call(A)==Rf}var qt=vf;function Tf(){this.__data__=new ot,this.size=0}var Yn=Tf;function qf(e){var t=this.__data__,A=t.delete(e);return this.size=t.size,A}var Vn=qf;function _f(e){return this.__data__.get(e)}var zn=_f;function Jf(e){return this.__data__.has(e)}var Wn=Jf;var Pf=200;function Kf(e,t){var A=this.__data__;if(A instanceof ot){var i=A.__data__;if(!nt||i.length<Pf-1)return i.push([e,t]),this.size=++A.size,this;A=this.__data__=new gA(i)}return A.set(e,t),this.size=A.size,this}var Xn=Kf;function _t(e){var t=this.__data__=new ot(e);this.size=t.size}_t.prototype.clear=Yn;_t.prototype.delete=Vn;_t.prototype.get=zn;_t.prototype.has=Wn;_t.prototype.set=Xn;var ei=_t;function Of(e,t){return e&&Ne(t,Mt(t),e)}var Zn=Of;function Lf(e,t){return e&&Ne(t,Ue(t),e)}var jn=Lf;var Aa=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$n=Aa&&typeof module=="object"&&module&&!module.nodeType&&module,Yf=$n&&$n.exports===Aa,ea=Yf?ee.Buffer:void 0,ta=ea?ea.allocUnsafe:void 0;function Vf(e,t){if(t)return e.slice();var A=e.length,i=ta?ta(A):new e.constructor(A);return e.copy(i),i}var ti=Vf;function zf(e,t){for(var A=-1,i=e==null?0:e.length,r=0,o=[];++A<i;){var n=e[A];t(n,A,e)&&(o[r++]=n)}return o}var ia=zf;function Wf(){return[]}var Ai=Wf;var Xf=Object.prototype,Zf=Xf.propertyIsEnumerable,ra=Object.getOwnPropertySymbols,jf=ra?function(e){return e==null?[]:(e=Object(e),ia(ra(e),function(t){return Zf.call(e,t)}))}:Ai,Jt=jf;function $f(e,t){return Ne(e,Jt(e),t)}var oa=$f;var eB=Object.getOwnPropertySymbols,tB=eB?function(e){for(var t=[];e;)$A(t,Jt(e)),e=Tt(e);return t}:Ai,ii=tB;function AB(e,t){return Ne(e,ii(e),t)}var na=AB;function iB(e,t,A){var i=t(e);return we(e)?i:$A(i,A(e))}var ri=iB;function rB(e){return ri(e,Mt,Jt)}var aa=rB;function oB(e){return ri(e,Ue,ii)}var sa=oB;var nB=Be(ee,"DataView"),oi=nB;var aB=Be(ee,"Promise"),ni=aB;var sB=Be(ee,"Set"),ai=sB;var ga="[object Map]",gB="[object Object]",Ia="[object Promise]",ca="[object Set]",la="[object WeakMap]",ua="[object DataView]",IB=Ke(oi),cB=Ke(nt),lB=Ke(ni),uB=Ke(ai),fB=Ke(LA),Qt=Ce;(oi&&Qt(new oi(new ArrayBuffer(1)))!=ua||nt&&Qt(new nt)!=ga||ni&&Qt(ni.resolve())!=Ia||ai&&Qt(new ai)!=ca||LA&&Qt(new LA)!=la)&&(Qt=function(e){var t=Ce(e),A=t==gB?e.constructor:void 0,i=A?Ke(A):"";if(i)switch(i){case IB:return ua;case cB:return ga;case lB:return Ia;case uB:return ca;case fB:return la}return t});var st=Qt;var BB=Object.prototype,pB=BB.hasOwnProperty;function dB(e){var t=e.length,A=new e.constructor(t);return t&&typeof e[0]=="string"&&pB.call(e,"index")&&(A.index=e.index,A.input=e.input),A}var fa=dB;var CB=ee.Uint8Array,cr=CB;function QB(e){var t=new e.constructor(e.byteLength);return new cr(t).set(new cr(e)),t}var Pt=QB;function mB(e,t){var A=t?Pt(e.buffer):e.buffer;return new e.constructor(A,e.byteOffset,e.byteLength)}var Ba=mB;var hB=/\w*$/;function EB(e){var t=new e.constructor(e.source,hB.exec(e));return t.lastIndex=e.lastIndex,t}var pa=EB;var da=Pe?Pe.prototype:void 0,Ca=da?da.valueOf:void 0;function yB(e){return Ca?Object(Ca.call(e)):{}}var Qa=yB;function wB(e,t){var A=t?Pt(e.buffer):e.buffer;return new e.constructor(A,e.byteOffset,e.length)}var si=wB;var DB="[object Boolean]",FB="[object Date]",SB="[object Map]",kB="[object Number]",xB="[object RegExp]",bB="[object Set]",NB="[object String]",GB="[object Symbol]",UB="[object ArrayBuffer]",MB="[object DataView]",HB="[object Float32Array]",RB="[object Float64Array]",vB="[object Int8Array]",TB="[object Int16Array]",qB="[object Int32Array]",_B="[object Uint8Array]",JB="[object Uint8ClampedArray]",PB="[object Uint16Array]",KB="[object Uint32Array]";function OB(e,t,A){var i=e.constructor;switch(t){case UB:return Pt(e);case DB:case FB:return new i(+e);case MB:return Ba(e,A);case HB:case RB:case vB:case TB:case qB:case _B:case JB:case PB:case KB:return si(e,A);case SB:return new i;case kB:case NB:return new i(e);case xB:return pa(e);case bB:return new i;case GB:return Qa(e)}}var ma=OB;function LB(e){return typeof e.constructor=="function"&&!At(e)?on(Tt(e)):{}}var gi=LB;var YB="[object Map]";function VB(e){return Ie(e)&&st(e)==YB}var ha=VB;var Ea=Le&&Le.isMap,zB=Ea?Gt(Ea):ha,ya=zB;var WB="[object Set]";function XB(e){return Ie(e)&&st(e)==WB}var wa=XB;var Da=Le&&Le.isSet,ZB=Da?Gt(Da):wa,Fa=ZB;var jB=1,$B=2,ep=4,Sa="[object Arguments]",tp="[object Array]",Ap="[object Boolean]",ip="[object Date]",rp="[object Error]",ka="[object Function]",op="[object GeneratorFunction]",np="[object Map]",ap="[object Number]",xa="[object Object]",sp="[object RegExp]",gp="[object Set]",Ip="[object String]",cp="[object Symbol]",lp="[object WeakMap]",up="[object ArrayBuffer]",fp="[object DataView]",Bp="[object Float32Array]",pp="[object Float64Array]",dp="[object Int8Array]",Cp="[object Int16Array]",Qp="[object Int32Array]",mp="[object Uint8Array]",hp="[object Uint8ClampedArray]",Ep="[object Uint16Array]",yp="[object Uint32Array]",V={};V[Sa]=V[tp]=V[up]=V[fp]=V[Ap]=V[ip]=V[Bp]=V[pp]=V[dp]=V[Cp]=V[Qp]=V[np]=V[ap]=V[xa]=V[sp]=V[gp]=V[Ip]=V[cp]=V[mp]=V[hp]=V[Ep]=V[yp]=!0;V[rp]=V[ka]=V[lp]=!1;function Ii(e,t,A,i,r,o){var n,a=t&jB,s=t&$B,g=t&ep;if(A&&(n=r?A(e,i,r,o):A(e)),n!==void 0)return n;if(!te(e))return e;var I=we(e);if(I){if(n=fa(e),!a)return YA(e,n)}else{var l=st(e),c=l==ka||l==op;if(it(e))return ti(e,a);if(l==xa||l==Sa||c&&!r){if(n=s||c?{}:gi(e),!a)return s?na(e,jn(n,e)):oa(e,Zn(n,e))}else{if(!V[l])return r?e:{};n=ma(e,l,a)}}o||(o=new ei);var u=o.get(e);if(u)return u;o.set(e,n),Fa(e)?e.forEach(function(C){n.add(Ii(C,t,A,C,e,o))}):ya(e)&&e.forEach(function(C,w){n.set(w,Ii(C,t,A,w,e,o))});var m=g?s?sa:aa:s?Ue:Mt,y=I?void 0:m(e);return cn(y||e,function(C,w){y&&(w=C,C=e[w]),zA(n,w,Ii(C,t,A,w,e,o))}),n}var ba=Ii;var wp=4;function Dp(e){return ba(e,wp)}var lr=Dp;function Fp(e){return function(t,A,i){for(var r=-1,o=Object(t),n=i(t),a=n.length;a--;){var s=n[e?a:++r];if(A(o[s],s,o)===!1)break}return t}}var Na=Fp;var Sp=Na(),Ga=Sp;var kp=function(){return ee.Date.now()},ci=kp;var xp="Expected a function",bp=Math.max,Np=Math.min;function Gp(e,t,A){var i,r,o,n,a,s,g=0,I=!1,l=!1,c=!0;if(typeof e!="function")throw new TypeError(xp);t=or(t)||0,te(A)&&(I=!!A.leading,l="maxWait"in A,o=l?bp(or(A.maxWait)||0,t):o,c="trailing"in A?!!A.trailing:c);function u(f){var d=i,B=r;return i=r=void 0,g=f,n=e.apply(B,d),n}function m(f){return g=f,a=setTimeout(w,t),I?u(f):n}function y(f){var d=f-s,B=f-g,D=t-d;return l?Np(D,o-B):D}function C(f){var d=f-s,B=f-g;return s===void 0||d>=t||d<0||l&&B>=o}function w(){var f=ci();if(C(f))return x(f);a=setTimeout(w,y(f))}function x(f){return a=void 0,c&&i?u(f):(i=r=void 0,n)}function N(){a!==void 0&&clearTimeout(a),g=0,i=s=r=a=void 0}function E(){return a===void 0?n:x(ci())}function p(){var f=ci(),d=C(f);if(i=arguments,r=this,s=f,d){if(a===void 0)return m(s);if(l)return clearTimeout(a),a=setTimeout(w,t),u(s)}return a===void 0&&(a=setTimeout(w,t)),n}return p.cancel=N,p.flush=E,p}var ue=Gp;function Up(e,t,A){(A!==void 0&&!tt(e[t],A)||A===void 0&&!(t in e))&&Nt(e,t,A)}var IA=Up;function Mp(e){return Ie(e)&&Ge(e)}var Ua=Mp;function Hp(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var cA=Hp;function Rp(e){return Ne(e,Ue(e))}var Ma=Rp;function vp(e,t,A,i,r,o,n){var a=cA(e,A),s=cA(t,A),g=n.get(s);if(g){IA(e,A,g);return}var I=o?o(a,s,A+"",e,t,n):void 0,l=I===void 0;if(l){var c=we(s),u=!c&&it(s),m=!c&&!u&&Ut(s);I=s,c||u||m?we(a)?I=a:Ua(a)?I=YA(a):u?(l=!1,I=ti(s,!0)):m?(l=!1,I=si(s,!0)):I=[]:qt(s)||Ct(s)?(I=a,Ct(a)?I=Ma(a):(!te(a)||xt(a))&&(I=gi(s))):l=!1}l&&(n.set(s,I),r(I,s,i,o,n),n.delete(s)),IA(e,A,I)}var Ha=vp;function Ra(e,t,A,i,r){e!==t&&Ga(t,function(o,n){if(r||(r=new ei),te(o))Ha(e,t,n,A,Ra,i,r);else{var a=i?i(cA(e,n),o,n+"",e,t,r):void 0;a===void 0&&(a=o),IA(e,n,a)}},Ue)}var va=Ra;var Tp=pn(function(e,t,A,i){va(e,t,A,i)}),lA=Tp;var qp="[object Map]",_p="[object Set]",Jp=Object.prototype,Pp=Jp.hasOwnProperty;function Kp(e){if(e==null)return!0;if(Ge(e)&&(we(e)||typeof e=="string"||typeof e.splice=="function"||it(e)||Ut(e)||Ct(e)))return!e.length;var t=st(e);if(t==qp||t==_p)return!e.size;if(At(e))return!jA(e).length;for(var A in e)if(Pp.call(e,A))return!1;return!0}var uA=Kp;var Op=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(e=>[e.name,e]),Lp=new Map(Op),Ta=Lp;var ur=class e extends Error{name="NonError";constructor(t){super(e._prepareSuperMessage(t))}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}},Yp=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],fr=new WeakSet,Vp=e=>{fr.add(e);let t=e.toJSON();return fr.delete(e),t},_a=e=>Ta.get(e)??Error,Br=({from:e,seen:t,to:A,forceEnumerable:i,maxDepth:r,depth:o,useToJSON:n,serialize:a})=>{if(!A)if(Array.isArray(e))A=[];else if(!a&&qa(e)){let g=_a(e.name);A=new g}else A={};if(t.push(e),o>=r)return A;if(n&&typeof e.toJSON=="function"&&!fr.has(e))return Vp(e);let s=g=>Br({from:g,seen:[...t],forceEnumerable:i,maxDepth:r,depth:o,useToJSON:n,serialize:a});for(let[g,I]of Object.entries(e)){if(I&&I instanceof Uint8Array&&I.constructor.name==="Buffer"){A[g]="[object Buffer]";continue}if(I!==null&&typeof I=="object"&&typeof I.pipe=="function"){A[g]="[object Stream]";continue}if(typeof I!="function"){if(!I||typeof I!="object"){try{A[g]=I}catch{}continue}if(!t.includes(e[g])){o++,A[g]=s(e[g]);continue}A[g]="[Circular]"}}for(let{property:g,enumerable:I}of Yp)typeof e[g]<"u"&&e[g]!==null&&Object.defineProperty(A,g,{value:qa(e[g])?s(e[g]):e[g],enumerable:i?!0:I,configurable:!0,writable:!0});return A};function fA(e,t={}){let{maxDepth:A=Number.POSITIVE_INFINITY,useToJSON:i=!0}=t;return typeof e=="object"&&e!==null?Br({from:e,seen:[],forceEnumerable:!0,maxDepth:A,depth:0,useToJSON:i,serialize:!0}):typeof e=="function"?`[Function: ${e.name||"anonymous"}]`:e}function Ja(e,t={}){let{maxDepth:A=Number.POSITIVE_INFINITY}=t;if(e instanceof Error)return e;if(zp(e)){let i=_a(e.name);return Br({from:e,seen:[],to:new i,maxDepth:A,depth:0,serialize:!1})}return new ur(e)}function qa(e){return!!e&&typeof e=="object"&&"name"in e&&"message"in e&&"stack"in e}function zp(e){return!!e&&typeof e=="object"&&"message"in e&&!Array.isArray(e)}var h=U(K());var li,Wp=new Uint8Array(16);function dr(){if(!li&&(li=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!li))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return li(Wp)}var se=[];for(let e=0;e<256;++e)se.push((e+256).toString(16).slice(1));function Ka(e,t=0){return se[e[t+0]]+se[e[t+1]]+se[e[t+2]]+se[e[t+3]]+"-"+se[e[t+4]]+se[e[t+5]]+"-"+se[e[t+6]]+se[e[t+7]]+"-"+se[e[t+8]]+se[e[t+9]]+"-"+se[e[t+10]]+se[e[t+11]]+se[e[t+12]]+se[e[t+13]]+se[e[t+14]]+se[e[t+15]]}var Xp=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Cr={randomUUID:Xp};function Zp(e,t,A){if(Cr.randomUUID&&!t&&!e)return Cr.randomUUID();e=e||{};let i=e.random||(e.rng||dr)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){A=A||0;for(let r=0;r<16;++r)t[A+r]=i[r];return t}return Ka(i)}var $=Zp;var kA=U(K());var Cs=U(K());var Qr=function(e,t){return Qr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,i){A.__proto__=i}||function(A,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(A[r]=i[r])},Qr(e,t)};function gt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Qr(e,t);function A(){this.constructor=e}e.prototype=t===null?Object.create(t):(A.prototype=t.prototype,new A)}function Oa(e,t,A,i){function r(o){return o instanceof A?o:new A(function(n){n(o)})}return new(A||(A=Promise))(function(o,n){function a(I){try{g(i.next(I))}catch(l){n(l)}}function s(I){try{g(i.throw(I))}catch(l){n(l)}}function g(I){I.done?o(I.value):r(I.value).then(a,s)}g((i=i.apply(e,t||[])).next())})}function ui(e,t){var A={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,n;return n={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(n[Symbol.iterator]=function(){return this}),n;function a(g){return function(I){return s([g,I])}}function s(g){if(i)throw new TypeError("Generator is already executing.");for(;n&&(n=0,g[0]&&(A=0)),A;)try{if(i=1,r&&(o=g[0]&2?r.return:g[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,g[1])).done)return o;switch(r=0,o&&(g=[g[0]&2,o.value]),g[0]){case 0:case 1:o=g;break;case 4:return A.label++,{value:g[1],done:!1};case 5:A.label++,r=g[1],g=[0];continue;case 7:g=A.ops.pop(),A.trys.pop();continue;default:if(o=A.trys,!(o=o.length>0&&o[o.length-1])&&(g[0]===6||g[0]===2)){A=0;continue}if(g[0]===3&&(!o||g[1]>o[0]&&g[1]<o[3])){A.label=g[1];break}if(g[0]===6&&A.label<o[1]){A.label=o[1],o=g;break}if(o&&A.label<o[2]){A.label=o[2],A.ops.push(g);break}o[2]&&A.ops.pop(),A.trys.pop();continue}g=t.call(e,A)}catch(I){g=[6,I],r=0}finally{i=o=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}}function Ve(e){var t=typeof Symbol=="function"&&Symbol.iterator,A=t&&e[t],i=0;if(A)return A.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Me(e,t){var A=typeof Symbol=="function"&&e[Symbol.iterator];if(!A)return e;var i=A.call(e),r,o=[],n;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){n={error:a}}finally{try{r&&!r.done&&(A=i.return)&&A.call(i)}finally{if(n)throw n.error}}return o}function He(e,t,A){if(A||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))}function mt(e){return this instanceof mt?(this.v=e,this):new mt(e)}function La(e,t,A){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=A.apply(e,t||[]),r,o=[];return r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r;function n(c){i[c]&&(r[c]=function(u){return new Promise(function(m,y){o.push([c,u,m,y])>1||a(c,u)})})}function a(c,u){try{s(i[c](u))}catch(m){l(o[0][3],m)}}function s(c){c.value instanceof mt?Promise.resolve(c.value.v).then(g,I):l(o[0][2],c)}function g(c){a("next",c)}function I(c){a("throw",c)}function l(c,u){c(u),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Ya(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],A;return t?t.call(e):(e=typeof Ve=="function"?Ve(e):e[Symbol.iterator](),A={},i("next"),i("throw"),i("return"),A[Symbol.asyncIterator]=function(){return this},A);function i(o){A[o]=e[o]&&function(n){return new Promise(function(a,s){n=e[o](n),r(a,s,n.done,n.value)})}}function r(o,n,a,s){Promise.resolve(s).then(function(g){o({value:g,done:a})},n)}}function L(e){return typeof e=="function"}function fi(e){var t=function(i){Error.call(i),i.stack=new Error().stack},A=e(t);return A.prototype=Object.create(Error.prototype),A.prototype.constructor=A,A}var Bi=fi(function(e){return function(A){e(this),this.message=A?A.length+` errors occurred during unsubscription:
`+A.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=A}});function BA(e,t){if(e){var A=e.indexOf(t);0<=A&&e.splice(A,1)}}var Kt=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,A,i,r,o;if(!this.closed){this.closed=!0;var n=this._parentage;if(n)if(this._parentage=null,Array.isArray(n))try{for(var a=Ve(n),s=a.next();!s.done;s=a.next()){var g=s.value;g.remove(this)}}catch(y){t={error:y}}finally{try{s&&!s.done&&(A=a.return)&&A.call(a)}finally{if(t)throw t.error}}else n.remove(this);var I=this.initialTeardown;if(L(I))try{I()}catch(y){o=y instanceof Bi?y.errors:[y]}var l=this._finalizers;if(l){this._finalizers=null;try{for(var c=Ve(l),u=c.next();!u.done;u=c.next()){var m=u.value;try{Va(m)}catch(y){o=o??[],y instanceof Bi?o=He(He([],Me(o)),Me(y.errors)):o.push(y)}}}catch(y){i={error:y}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(i)throw i.error}}}if(o)throw new Bi(o)}},e.prototype.add=function(t){var A;if(t&&t!==this)if(this.closed)Va(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(A=this._finalizers)!==null&&A!==void 0?A:[]).push(t)}},e.prototype._hasParent=function(t){var A=this._parentage;return A===t||Array.isArray(A)&&A.includes(t)},e.prototype._addParent=function(t){var A=this._parentage;this._parentage=Array.isArray(A)?(A.push(t),A):A?[A,t]:t},e.prototype._removeParent=function(t){var A=this._parentage;A===t?this._parentage=null:Array.isArray(A)&&BA(A,t)},e.prototype.remove=function(t){var A=this._finalizers;A&&BA(A,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}();var mr=Kt.EMPTY;function pi(e){return e instanceof Kt||e&&"closed"in e&&L(e.remove)&&L(e.add)&&L(e.unsubscribe)}function Va(e){L(e)?e():e.unsubscribe()}var De={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ot={setTimeout:function(e,t){for(var A=[],i=2;i<arguments.length;i++)A[i-2]=arguments[i];var r=Ot.delegate;return r?.setTimeout?r.setTimeout.apply(r,He([e,t],Me(A))):setTimeout.apply(void 0,He([e,t],Me(A)))},clearTimeout:function(e){var t=Ot.delegate;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function di(e){Ot.setTimeout(function(){var t=De.onUnhandledError;if(t)t(e);else throw e})}function hr(){}var za=function(){return Er("C",void 0,void 0)}();function Wa(e){return Er("E",void 0,e)}function Xa(e){return Er("N",e,void 0)}function Er(e,t,A){return{kind:e,value:t,error:A}}var ht=null;function Lt(e){if(De.useDeprecatedSynchronousErrorHandling){var t=!ht;if(t&&(ht={errorThrown:!1,error:null}),e(),t){var A=ht,i=A.errorThrown,r=A.error;if(ht=null,i)throw r}}else e()}function Za(e){De.useDeprecatedSynchronousErrorHandling&&ht&&(ht.errorThrown=!0,ht.error=e)}var pA=function(e){gt(t,e);function t(A){var i=e.call(this)||this;return i.isStopped=!1,A?(i.destination=A,pi(A)&&A.add(i)):i.destination=td,i}return t.create=function(A,i,r){return new Et(A,i,r)},t.prototype.next=function(A){this.isStopped?wr(Xa(A),this):this._next(A)},t.prototype.error=function(A){this.isStopped?wr(Wa(A),this):(this.isStopped=!0,this._error(A))},t.prototype.complete=function(){this.isStopped?wr(za,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(A){this.destination.next(A)},t.prototype._error=function(A){try{this.destination.error(A)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Kt);var jp=Function.prototype.bind;function yr(e,t){return jp.call(e,t)}var $p=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var A=this.partialObserver;if(A.next)try{A.next(t)}catch(i){Ci(i)}},e.prototype.error=function(t){var A=this.partialObserver;if(A.error)try{A.error(t)}catch(i){Ci(i)}else Ci(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(A){Ci(A)}},e}(),Et=function(e){gt(t,e);function t(A,i,r){var o=e.call(this)||this,n;if(L(A)||!A)n={next:A??void 0,error:i??void 0,complete:r??void 0};else{var a;o&&De.useDeprecatedNextContext?(a=Object.create(A),a.unsubscribe=function(){return o.unsubscribe()},n={next:A.next&&yr(A.next,a),error:A.error&&yr(A.error,a),complete:A.complete&&yr(A.complete,a)}):n=A}return o.destination=new $p(n),o}return t}(pA);function Ci(e){De.useDeprecatedSynchronousErrorHandling?Za(e):di(e)}function ed(e){throw e}function wr(e,t){var A=De.onStoppedNotification;A&&Ot.setTimeout(function(){return A(e,t)})}var td={closed:!0,next:hr,error:ed,complete:hr};var Yt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ja(e){return e}function $a(e){return e.length===0?ja:e.length===1?e[0]:function(A){return e.reduce(function(i,r){return r(i)},A)}}var me=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var A=new e;return A.source=this,A.operator=t,A},e.prototype.subscribe=function(t,A,i){var r=this,o=id(t)?t:new Et(t,A,i);return Lt(function(){var n=r,a=n.operator,s=n.source;o.add(a?a.call(o,s):s?r._subscribe(o):r._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(A){t.error(A)}},e.prototype.forEach=function(t,A){var i=this;return A=es(A),new A(function(r,o){var n=new Et({next:function(a){try{t(a)}catch(s){o(s),n.unsubscribe()}},error:o,complete:r});i.subscribe(n)})},e.prototype._subscribe=function(t){var A;return(A=this.source)===null||A===void 0?void 0:A.subscribe(t)},e.prototype[Yt]=function(){return this},e.prototype.pipe=function(){for(var t=[],A=0;A<arguments.length;A++)t[A]=arguments[A];return $a(t)(this)},e.prototype.toPromise=function(t){var A=this;return t=es(t),new t(function(i,r){var o;A.subscribe(function(n){return o=n},function(n){return r(n)},function(){return i(o)})})},e.create=function(t){return new e(t)},e}();function es(e){var t;return(t=e??De.Promise)!==null&&t!==void 0?t:Promise}function Ad(e){return e&&L(e.next)&&L(e.error)&&L(e.complete)}function id(e){return e&&e instanceof pA||Ad(e)&&pi(e)}function rd(e){return L(e?.lift)}function Qi(e){return function(t){if(rd(t))return t.lift(function(A){try{return e(A,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ts(e,t,A,i,r){return new od(e,t,A,i,r)}var od=function(e){gt(t,e);function t(A,i,r,o,n,a){var s=e.call(this,A)||this;return s.onFinalize=n,s.shouldUnsubscribe=a,s._next=i?function(g){try{i(g)}catch(I){A.error(I)}}:e.prototype._next,s._error=o?function(g){try{o(g)}catch(I){A.error(I)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(g){A.error(g)}finally{this.unsubscribe()}}:e.prototype._complete,s}return t.prototype.unsubscribe=function(){var A;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;e.prototype.unsubscribe.call(this),!i&&((A=this.onFinalize)===null||A===void 0||A.call(this))}},t}(pA);var As=fi(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}});var Dr=function(e){gt(t,e);function t(){var A=e.call(this)||this;return A.closed=!1,A.currentObservers=null,A.observers=[],A.isStopped=!1,A.hasError=!1,A.thrownError=null,A}return t.prototype.lift=function(A){var i=new is(this,this);return i.operator=A,i},t.prototype._throwIfClosed=function(){if(this.closed)throw new As},t.prototype.next=function(A){var i=this;Lt(function(){var r,o;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var n=Ve(i.currentObservers),a=n.next();!a.done;a=n.next()){var s=a.value;s.next(A)}}catch(g){r={error:g}}finally{try{a&&!a.done&&(o=n.return)&&o.call(n)}finally{if(r)throw r.error}}}})},t.prototype.error=function(A){var i=this;Lt(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=A;for(var r=i.observers;r.length;)r.shift().error(A)}})},t.prototype.complete=function(){var A=this;Lt(function(){if(A._throwIfClosed(),!A.isStopped){A.isStopped=!0;for(var i=A.observers;i.length;)i.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var A;return((A=this.observers)===null||A===void 0?void 0:A.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(A){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,A)},t.prototype._subscribe=function(A){return this._throwIfClosed(),this._checkFinalizedStatuses(A),this._innerSubscribe(A)},t.prototype._innerSubscribe=function(A){var i=this,r=this,o=r.hasError,n=r.isStopped,a=r.observers;return o||n?mr:(this.currentObservers=null,a.push(A),new Kt(function(){i.currentObservers=null,BA(a,A)}))},t.prototype._checkFinalizedStatuses=function(A){var i=this,r=i.hasError,o=i.thrownError,n=i.isStopped;r?A.error(o):n&&A.complete()},t.prototype.asObservable=function(){var A=new me;return A.source=this,A},t.create=function(A,i){return new is(A,i)},t}(me);var is=function(e){gt(t,e);function t(A,i){var r=e.call(this)||this;return r.destination=A,r.source=i,r}return t.prototype.next=function(A){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.next)===null||r===void 0||r.call(i,A)},t.prototype.error=function(A){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.error)===null||r===void 0||r.call(i,A)},t.prototype.complete=function(){var A,i;(i=(A=this.destination)===null||A===void 0?void 0:A.complete)===null||i===void 0||i.call(A)},t.prototype._subscribe=function(A){var i,r;return(r=(i=this.source)===null||i===void 0?void 0:i.subscribe(A))!==null&&r!==void 0?r:mr},t}(Dr);var rs=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function os(e){return L(e?.then)}function ns(e){return L(e[Yt])}function as(e){return Symbol.asyncIterator&&L(e?.[Symbol.asyncIterator])}function ss(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function nd(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var gs=nd();function Is(e){return L(e?.[gs])}function cs(e){return La(this,arguments,function(){var A,i,r,o;return ui(this,function(n){switch(n.label){case 0:A=e.getReader(),n.label=1;case 1:n.trys.push([1,,9,10]),n.label=2;case 2:return[4,mt(A.read())];case 3:return i=n.sent(),r=i.value,o=i.done,o?[4,mt(void 0)]:[3,5];case 4:return[2,n.sent()];case 5:return[4,mt(r)];case 6:return[4,n.sent()];case 7:return n.sent(),[3,2];case 8:return[3,10];case 9:return A.releaseLock(),[7];case 10:return[2]}})})}function ls(e){return L(e?.getReader)}function Fr(e){if(e instanceof me)return e;if(e!=null){if(ns(e))return ad(e);if(rs(e))return sd(e);if(os(e))return gd(e);if(as(e))return us(e);if(Is(e))return Id(e);if(ls(e))return cd(e)}throw ss(e)}function ad(e){return new me(function(t){var A=e[Yt]();if(L(A.subscribe))return A.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function sd(e){return new me(function(t){for(var A=0;A<e.length&&!t.closed;A++)t.next(e[A]);t.complete()})}function gd(e){return new me(function(t){e.then(function(A){t.closed||(t.next(A),t.complete())},function(A){return t.error(A)}).then(null,di)})}function Id(e){return new me(function(t){var A,i;try{for(var r=Ve(e),o=r.next();!o.done;o=r.next()){var n=o.value;if(t.next(n),t.closed)return}}catch(a){A={error:a}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(A)throw A.error}}t.complete()})}function us(e){return new me(function(t){ld(e,t).catch(function(A){return t.error(A)})})}function cd(e){return us(cs(e))}function ld(e,t){var A,i,r,o;return Oa(this,void 0,void 0,function(){var n,a;return ui(this,function(s){switch(s.label){case 0:s.trys.push([0,5,6,11]),A=Ya(e),s.label=1;case 1:return[4,A.next()];case 2:if(i=s.sent(),!!i.done)return[3,4];if(n=i.value,t.next(n),t.closed)return[2];s.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=s.sent(),r={error:a},[3,11];case 6:return s.trys.push([6,,9,10]),i&&!i.done&&(o=A.return)?[4,o.call(A)]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function fs(e,t){return Qi(function(A,i){var r=0;A.subscribe(ts(i,function(o){i.next(e.call(t,o,r++))}))})}var ud=Array.isArray;function fd(e,t){return ud(t)?e.apply(void 0,He([],Me(t))):e(t)}function Bs(e){return fs(function(t){return fd(e,t)})}function mi(e,t,A){return A?mi(e,t).pipe(Bs(A)):new me(function(i){var r=function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return i.next(n.length===1?n[0]:n)},o=e(r);return L(t)?function(){return t(r,o)}:void 0})}function kr(e){e===void 0&&(e={});var t=e.connector,A=t===void 0?function(){return new Dr}:t,i=e.resetOnError,r=i===void 0?!0:i,o=e.resetOnComplete,n=o===void 0?!0:o,a=e.resetOnRefCountZero,s=a===void 0?!0:a;return function(g){var I,l,c,u=0,m=!1,y=!1,C=function(){l?.unsubscribe(),l=void 0},w=function(){C(),I=c=void 0,m=y=!1},x=function(){var N=I;w(),N?.unsubscribe()};return Qi(function(N,E){u++,!y&&!m&&C();var p=c=c??A();E.add(function(){u--,u===0&&!y&&!m&&(l=Sr(x,s))}),p.subscribe(E),!I&&u>0&&(I=new Et({next:function(f){return p.next(f)},error:function(f){y=!0,C(),l=Sr(w,r,f),p.error(f)},complete:function(){m=!0,C(),l=Sr(w,n),p.complete()}}),Fr(N).subscribe(I))})(g)}}function Sr(e,t){for(var A=[],i=2;i<arguments.length;i++)A[i-2]=arguments[i];if(t===!0){e();return}if(t!==!1){var r=new Et({next:function(){r.unsubscribe(),e()}});return Fr(t.apply(void 0,He([],Me(A)))).subscribe(r)}}var yt=U(K());async function O(e,t){let A=await yt.default.storage.local.get(e);return typeof e=="string"?Object.hasOwn(A,e)?A[e]:t:A}async function wt(e,t){return typeof e=="string"?yt.default.storage.local.set({[e]:t}):yt.default.storage.local.set(e)}var ps=mi(e=>yt.default.storage.local.onChanged.addListener(e),e=>yt.default.runtime.id&&yt.default.storage.local.onChanged.removeListener(e),e=>e).pipe(kr({resetOnRefCountZero:!0}));var xr=Cs.default.runtime.getManifest(),ge=xr.version_name===xr.version+"-e",Qs="Sider";var dA=ge?"dhoenijjpgpeimemopealfcbiecgceod":"difoiogjjojoaoomphldepapgpbgkhkb",hi=`ChitChat_${ge?"Edge":"Chrome"}_Ext`,ae=xr.version,ms=["gpmljinohlbfgmeoaeceoajachkabijo","nlipoenfbbikpbjkfpfillcgkoblgpmj"];var hs=["translate"],Es={name:"Robot",avatar:"",gender:"unknown",platform:"system",requireVIP:!1};var br="gpt-3.5-turbo";var Bd={dev:"",test:"",preview:"https://preview.sider.ai",prod:"https://sider.ai"},pd={dev:"",test:"",preview:"sider.ai",prod:"sider.ai"},ds=Bd.prod,Y={origin:ds,api:`${ds}/api`,domain:pd.prod},ys="https://www.google-analytics.com/mp/collect",ws="G-0PRFKME4HP";var Ds="6FX_tIISST2SsnSx29yQRg";var he={English:"en","Chinese(Simplified)":"zh_CN","Chinese(Traditional)":"zh_TW",Spanish:"es",French:"fr",Japanese:"ja",German:"de",Portuguese:"pt",Arabic:"ar",Russian:"ru",Italian:"it",Korean:"ko",Hindi:"hi",Dutch:"nl",Polish:"pl",Amharic:"am",Bulgarian:"bg",Bengali:"bn",Catalan:"ca",Czech:"cs",Danish:"da",Greek:"el",Estonian:"et",Persian:"fa",Finnish:"fi",Filipino:"fil",Gujarati:"gu",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Kannada:"kn",Lithuanian:"lt",Latvian:"lv",Malayalam:"ml",Marathi:"mr",Malay:"ms",Norwegian:"no",Romanian:"ro",Slovak:"sk",Slovenian:"sl",Serbian:"sr",Swedish:"sv",Swahili:"sw",Tamil:"ta",Telugu:"te",Thai:"th",Turkish:"tr",Ukrainian:"uk",Urdu:"ur",Vietnamese:"vi"};var Nr=Object.entries(he).reduce((e,[t,A])=>(e[A]=t,e),{});var ze=[{id:"default",title:"Default",template:`You are a question-answering assistant who answers users' questions through your own knowledge base. 
      You must answer the user's question directly,The user's question is:$[keywords].$[defaultResInfo]
      The answer must be sufficient and complete and cannot be too brief.Answer content does not need to be in markdown.
      After answering the question, Suggest three related questions users might ask , use markdown web link format, like this: [What is the question?](#related),always use #related, not the actual URL.
      - Format in markdown, including sections for:
        ### Related Questions
        - [releated question](#related)
        - ...
      
      **IMPORTANT: Regardless of the language input by the user, please make sure to respond in $[lang]. And translate the section titles  "Related Questions" into $[lang].**
    `,shorterAnswerTemplate:`You are a question-answering assistant who answers users' questions through your own knowledge base. 
      You must answer the user's question directly,The user's question is:$[keywords].
      Answers should be kept concise and no longer than 100 words.
      Answer content does not need to be in markdown.
      After answering the question, Suggest three related questions users might ask , use markdown web link format, like this: [What is the question?](#related),always use #related, not the actual URL.
      - Format in markdown, including sections for:
        ### Related Questions
        - [releated question](#related)
        - \u2026
      
      **IMPORTANT: Regardless of the language input by the user, please make sure to respond in $[lang]. And translate the section titles  "Related Questions" into $[lang].**
    `,canEdit:!1}];var Gx={triggerMode:"always",theme:"light",language:he.English,openTarget:"New tab",selectedSearchTemplate:{id:"default",title:"Default"},promptTemplates:ze,submitShortcut:"Enter"};var CA="provider:siderApi",Ux=`${CA}:SelectedModels`;async function Fs(){let e="provider:gpt3",[t="siderApi",A]=await Promise.all([O("provider"),O(e)]);return{provider:t,configs:{gpt3:A}}}var We={login:`${Y.origin}/login`,openaiChat:"https://chatgpt.com",openaiLogin:"https://platform.openai.com/login",openaiSignup:"https://platform.openai.com/signup",openaiApiKey:"https://platform.openai.com/account/api-keys",openaiApiSession:"https://chatgpt.com/api/auth/session",edgeStore:"https://microsoftedge.microsoft.com/addons/detail/sider-ai-sidebar/dhoenijjpgpeimemopealfcbiecgceod",chromeStore:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb",chromeStoreReview:"https://chromewebstore.google.com/detail/sider-chatgpt-sidebar-+-v/difoiogjjojoaoomphldepapgpbgkhkb/reviews",weChatQrCode:"https://sider.ai/resource/weixin/qrcode.jpeg",producthuntPromoteApi:"https://sider.ai/resource/promotion/extension-promote.json",promoteConfigApi:"https://sider.ai/resource/promotion/promote-config.json"};var dd={key:"j",keyCode:74,metaKey:!0,ctrlKey:!0,altKey:!1,shiftKey:!1},Cd={key:"a",keyCode:65,metaKey:!1,ctrlKey:!1,altKey:!0,shiftKey:!1};var Ei={"provider:gpt3":{apiKey:"",customURL:"",enableCustomURL:!0,model:"gpt-3.5-turbo"},language:"zh_CN",theme:"light",isShowSearch:!1,triggerMode:"questionMark",selectedSearchTemplate:{id:"suggest",title:""},submitShortcut:"Enter",sidebarShortcut:{altKey:!1,ctrlKey:!0,key:"O",keyCode:79,metaKey:!1,shiftKey:!0},sidebarLocation:"right",sidebarDisplayOption:"overlay",sidebarFab:!0,sidebarFabDisabledHost:{},selectionSidebarFab:!0,sidebarOnStartup:"new",showSelectedTextInSidebarEnable:!0,chatVisiblePromptKeys:[],readVisiblePromptKeys:[],writeVisiblePromptKeys:[],quickActionDispalyModifier:"",quickActionSelectionEnable:!0,quickActionInputSelectionEnable:!0,translatorShortcut:dd,quickActionTriggerKeyword:"//",translatorPinnedTemplates:[],quickActionPinnedReading:[],quickActionPinnedWriting:[],quickActionInputIconEnable:!0,quickActionInputIconDisabledHost:{},translatorHostConfig:{"fab-config.example.com":{favicon:"",enable:!0}},enableWebAssistantVideo:!0,enableBilingualSubtitle:!0,enableWebAssistantArticle:!0,enableWebAssistantQA:!0,enableWebAssistantEmail:!0,enableWebAssistantCode:!0,enableWebAssistantImage:!0,webAssistantImageDisabledHost:{},pageTranslationAutoEn:!0,pageTranslationDisplayStyle:"none",pageTranslationNeverHost:[],pageTranslateShortcut:Cd},Ss={device:"free",login:"free",premium_starter:"starter",premium:"basic",premium_pro:"pro",premium_ultra:"ultra",premium_ultra_mobile:"pocket"};var Mx=1024*1024*10,Hx=1024*1024*100;var ks="chatgpt:img:",xs=["g-BlafpMvzd","g-nleealfRT"],bs={"g-BlafpMvzd":{flair:{kind:"sidebar_keep"},resource:{files:[],gizmo:{appeal_info:null,author:{display_name:"sider.ai",is_verified:!0,link_to:"https://sider.ai",selected_display:"website",user_id:"user-inve40FQN9r2Tg4j1mlXSMQb",will_receive_support_emails:null},created_at:"2024-01-10T07:08:34.362699+00:00",display:{categories:["productivity"],description:"Top browser expert! Provide 3X accurate responses. Read any links: PDFs, videos, etc. Create 10+ types of files, like mind maps & spreadsheets, from search-derived contents.",name:"Browser Pro",profile_picture_url:"https://files.oaiusercontent.com/file-HKO0TEnSmvIb1M9G1HUyuAZJ?se=2123-12-27T11%3A10%3A22Z&sp=r&sv=2021-08-06&sr=b&rscc=max-age%3D1209600%2C%20immutable&rscd=attachment%3B%20filename%3DFrame%2520616.png&sig=fJSm%2BvONY8TkDO8IopKdwun%2BWeW2Wo9hti5JG%2Bb5Bj4%3D",prompt_starters:["Search for latest AI research outcomes.","Read this link and summarize the key points.","Create a mind map on ChatGPT prompt skills.","Type E to show all extensions."],welcome_message:"Hi, I'm Browser+! How can I assist you today?"},id:"g-BlafpMvzd",instructions:null,last_interacted_at:"2024-01-20T07:48:12.598861+00:00",live_version:null,model:null,organization_id:"org-i9SD3zX6OqRLnBDt97AtVHHk",settings:null,share_recipient:"marketplace",sharing_targets:null,short_url:"g-BlafpMvzd-browser-pro",tags:["public","reportable","uses_function_calls","pinned"],training_disabled:null,updated_at:"2024-01-20T11:10:24.859178+00:00",vanity_metrics:{created_ago_str:"last week",num_conversations:1066,num_conversations_str:"1066",num_pins:0,num_users_interacted_with:0},version:null,voice:{id:"ember"},workspace_approval_date:null,workspace_approved:null,workspace_id:null},product_features:{attachments:{accepted_mime_types:["application/json","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/javascript","text/plain","text/x-c++","text/x-script.python","text/x-typescript","text/markdown","application/pdf","text/x-sh","text/x-csharp","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/x-latext","text/x-tex","text/html","text/x-php","text/x-java","text/x-c","text/x-ruby","application/msword"],can_accept_all_mime_types:!0,image_mime_types:["image/webp","image/gif","image/png","image/jpeg"],type:"retrieval"}},tools:[{id:"gzm_cnf_jSWQ9Aj5eNZu3L3mS3bzGxGI~gzm_tool_l6SR7MvRO40YmUGDO8JfhnU8",metadata:{action_id:"g-d08200cb39473e72a1058ed24f66ff9838cf07c1",auth:{type:"none"},domain:"actions.sider.ai",json_schema:null,privacy_policy_url:"https://sider.ai/policies/privacy",raw_spec:""},settings:null,type:"plugins_prototype"},{id:"gzm_cnf_p4GmqNKla5EIJWaJ78Qjnq0B~gzm_tool_wtkmQ099hG3LZNbfZ6jXBMfN",metadata:null,settings:null,type:"dalle"}]}},"g-nleealfRT":{flair:{kind:"sidebar_keep"},resource:{files:[],gizmo:{appeal_info:null,author:{display_name:"awesomegpts.ai",is_verified:!0,link_to:"https://awesomegpts.ai",selected_display:"website",user_id:"user-MV1EPMI80LBUBFXL3yqj7TxP",will_receive_support_emails:null},created_at:"2023-11-15T09:08:04.569234+00:00",display:{categories:["lifestyle"],description:"Shop Smarter, Save Bigger! Quickly find top-rated gems and the best deals in the shopping sea!",name:"Shopping GPT",profile_picture_url:"https://files.oaiusercontent.com/file-epOlIRgMgGrqAHUd0l3Oq2HP?se=2123-12-22T06%3A43%3A25Z&sp=r&sv=2021-08-06&sr=b&rscc=max-age%3D1209600%2C%20immutable&rscd=attachment%3B%20filename%3DFrame%2520613.png&sig=ryqJXchYBS%2BMGC2aa4EPU6zGnOR93RgQoBXoV12b5KY%3D",prompt_starters:["Compare MacBook series products in a table","Locate nearby headphone retailers","Find sofas with top reviews","Find the cheapest Apple Watch Series 9"],welcome_message:""},id:"g-nleealfRT",instructions:null,last_interacted_at:"2024-01-20T06:16:29.030796+00:00",live_version:null,model:null,organization_id:"org-1uI21Op8M017HxHB8qTGnaym",settings:null,share_recipient:"marketplace",sharing_targets:null,short_url:"g-nleealfRT-shopping-gpt",tags:["public","reportable","uses_function_calls","pinned"],training_disabled:null,updated_at:"2024-01-20T02:52:49.252542+00:00",vanity_metrics:{created_ago_str:"2 months ago",num_conversations:341,num_conversations_str:"341",num_pins:0,num_users_interacted_with:0},version:null,voice:{id:"ember"},workspace_approval_date:null,workspace_approved:null,workspace_id:null},product_features:{attachments:{accepted_mime_types:["text/x-csharp","text/javascript","application/json","text/x-php","application/pdf","text/x-c","application/x-latext","text/html","text/x-sh","text/markdown","text/x-script.python","application/msword","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-typescript","text/x-c++","text/x-ruby","text/plain","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/x-tex","text/x-java"],can_accept_all_mime_types:!0,image_mime_types:["image/gif","image/png","image/jpeg","image/webp"],type:"retrieval"}},tools:[{id:"gzm_cnf_mEdggaHyWwxFTAlH5vuabKsd~gzm_tool_sJQMJJ1tT9JqB6NizdOV6ChU",metadata:{action_id:"g-6a3d44cc7cf012a5f2222be5dadb5cc8140a15e3",auth:{type:"none"},domain:"actions.sider.ai",json_schema:null,privacy_policy_url:"https://sider.ai/policies/privacy",raw_spec:""},settings:null,type:"plugins_prototype"},{id:"gzm_cnf_gWRjhVNf1a0XZfN7oDjbgOEC~gzm_tool_YJucv3shUVUdtXn36lZJWVfs",metadata:null,settings:null,type:"browser"}]}}},Ns=["thinking_mode","artifacts","search","text_to_image","data_analysis"],Gs=[{name:"thinking_mode",isExperimental:!0,isPro:!0},{name:"artifacts",isExperimental:!1,isPro:!0},{name:"search",isExperimental:!1,isPro:!0},{name:"text_to_image",isExperimental:!1,isPro:!0},{name:"data_analysis",isExperimental:!1,isPro:!0}];var Sd=U(Us());var Fe=U(K());var J=U(K());var Vt=U(K());var Ms="__webext_forward_tabs_message__",wi=new Map,Qd=Ts(),md=vs(),Hs=(e,t)=>{if(Qd){let r=hd(e,t);if(r)return r}if(e.view==="sidebar"&&!md)return;let A=e.type,i=wi.get(A);if(i)return new Promise(async r=>{try{r({data:await i({sender:t,data:e.data,id:A,originalSender:e.sender})})}catch(o){r({error:fA(o)})}})};function hd(e,t){if(e.type===Ms)return new Promise(async(A,i)=>{let{tabId:r,frameId:o,type:n,data:a,view:s}=e.data,g;try{g=r==="sender"?t.tab.id:r==="active"?await Gr():r}catch(l){return i(l)}let I=o==="sender"?t.frameId:o;A(Vt.default.tabs.sendMessage(g,{type:n,data:a,sender:t,view:s},I===void 0?void 0:{frameId:I}))})}async function zt(...e){if(!Vt.default.runtime.id)throw new Error("Extension not initialized.");let[t,A,i={}]=e,r=i.tabId,o=i.frameId,n=i.view,a;if(r===void 0?a=await Vt.default.runtime.sendMessage({type:t,data:A,view:n}):r!=="sender"&&o!=="sender"&&Rs()?a=await Vt.default.tabs.sendMessage(r==="active"?await Gr():r,{type:t,data:A,view:n},o===void 0?void 0:{frameId:o}):a=await Vt.default.runtime.sendMessage({type:Ms,data:{tabId:r,frameId:o,type:t,data:A,view:n}}),!a)throw new Error(`null for Message ID "${t}". Maybe multiple async runtime.onMessage listeners or no listener.`);if("error"in a)throw Ja(a.error);return a.data}function Z(e,t,A={}){let i=A.signal;if(i?.aborted)return Oe;if(wi.get(e))throw new Error(`Message ID "${e}" already has a listener.`);wi.set(e,t);let o=()=>wi.delete(e);return i&&i.addEventListener("abort",o,{once:!0}),()=>{o(),i&&i.removeEventListener("abort",o)}}var Ed=U(K()),Di=new Map;function Ur(e,t){if(Di.get(e))throw new Error(`Channel "${e}" already has a listener.`);return Di.set(e,t),()=>Di.delete(e)}function qs(e){let t=e.name,A=Di.get(t);return A?(A(yd(e)),!0):!1}function yd(e){let t=new AbortController,A=!0;e.onDisconnect.addListener(()=>{t.abort(),A=!1});function i(o){return e.onDisconnect.addListener(o),()=>e.onDisconnect.removeListener(o)}function r(o){return e.onMessage.addListener(o),()=>e.onMessage.removeListener(o)}return{signal:t.signal,send:o=>A&&e.postMessage(o),close:()=>A&&e.disconnect(),onMessage:r,onClose:i,async*iter(...o){let n,a=r(g=>n(g)),s=i(()=>n=Oe);o.length&&e.postMessage(o[0]);try{for(;;)yield new Promise(g=>n=g)}finally{a(),s()}}}}function M(e){return J.default.storage.local.get(e)}async function F(e){return J.default.storage.local.set(e)}async function Ae(e){return J.default.storage.local.remove(e)}function Mr(e,t,A){return typeof e=="string"&&(e=[e]),wd(J.default.storage.local.onChanged,i=>{for(let r of e)if(r in i){t(e.reduce((o,n)=>(o[n]=i[n],o),{}));break}},{signal:A?.signal})}async function Hr(e){if(J.default.cookies){let t=await J.default.cookies.get(e);return t?.value?decodeURIComponent(t.value):""}return J.default.runtime.sendMessage({type:"GET_COOKIE",data:e})}async function Rr(e){return J.default?.cookies?await J.default.cookies.set(e):J.default.runtime.sendMessage({type:"SET_COOKIE",data:e})}function Fi(e){return Hr({name:e,url:Y.origin})}function vr(e,t,A=360){let i=Math.round(Date.now()/1e3)+86400*A;try{return Rr({name:e,value:t,url:Y.origin,domain:"."+new URL(Y.origin).hostname,expirationDate:i,secure:!0})}catch{}}function It(e){return J.default.tabs?J.default.tabs.create(e):J.default.runtime.sendMessage({type:"OPEN_URL_IN_NEW_TAB",details:e})}async function _s(e,t){let A=await J.default.tabs.query(e);for(let i of A)i.id&&await J.default.tabs.update(i.id,t)}async function Js(e){return J.default?.tabs?Si(e):J.default.runtime.sendMessage({type:"SWITCH_TAB",queryInfo:e})}async function Si(e,t=!1,A){let{url:i,...r}=e,o=new URL(i),n=`${o.origin}${o.pathname}*`,a=await J.default.tabs.query({url:n,...r});if(a.length)for(let s of a)s.id&&(await J.default.tabs.update(s.id,{active:!0}),t&&await J.default.tabs.reload(s.id,A));else{let{url:s,cookieStoreId:g,...I}=e,l={url:Array.isArray(s)?s[0]:s,...I};await J.default.tabs.create(l)}}function Tr(e="general",t,A){let i="/options.html";if(e&&(i+=`?section=${e}`),A){let r=new URLSearchParams(A);i+=`&${r.toString()}`}t&&(t.startsWith("#")||(t="#"+t),i+=t),J.default.tabs.create({url:i})}function Dt(e){return J.default.runtime.getURL(e)}async function Xe(){return(await J.default.tabs.query({active:!0,currentWindow:!0}))[0]}function Rs(){return!!(J.default.tabs&&J.default.tabs.query)}function wd(e,t,A={}){let i=A.signal;if(i?.aborted)return Oe;e.addListener(t);let r=()=>e.removeListener(t);return i?(i.addEventListener("abort",r,{once:!0}),()=>{r(),i.removeEventListener("abort",r)}):r}async function Gr(){let[e]=await J.default.tabs.query({active:!0,currentWindow:!0});if(!e)throw new Error("No active tab");let t=e.id;if(t===void 0)throw new Error("No active tab");return t}function vs(){try{let t=J.default.runtime.getManifest().side_panel.default_path,A=new URL(J.default.runtime.getURL(t)),i=new URL(window.location.href);return i.pathname===A.pathname&&i.origin===A.origin}catch{return!1}}function Ts(){if(!("serviceWorker"in navigator)&&!J.default.extension.getViews)return!0;try{let e=new URL(window.location.href);return browser.runtime.getManifest().background.scripts.some(A=>{let i=new URL(J.default.runtime.getURL(A));return e.pathname===i.pathname&&e.origin===i.origin})}catch{return!1}}async function QA(e,t){let{fileTextStatus:A}=await J.default.storage.local.get({fileTextStatus:{}});return e.forEach(i=>{A[i]=t}),J.default.storage.local.set({fileTextStatus:A})}var qr=Object.hasOwn;var Dd=Array.isArray;var Fd="_";function _r(e,t){let A=e in t?t[e]:t[Fd];return typeof A=="function"?A():A}function Jr(e){return[...new Set(e)]}var ct=(...e)=>e.join("/").replace(/([^:])\/{2,}/g,"$1/");function Ft(e=1e3,t){return new Promise((A,i)=>{let r=setTimeout(A,e);t&&t.addEventListener("abort",()=>{clearTimeout(r),i(new DOMException("Aborted","AbortError"))},{once:!0})})}async function Ze(e,t=1e3,A=2){let i=0;for(;;){try{return await e()}catch(r){if(A>=0&&i++>=A)throw r}await Ft(t)}}function Re(e,t=0){let A=!1,i;return function(...r){return A||(A=!0,i=new Promise((o,n)=>{e(...r).then(o).catch(n).finally(async()=>{t&&await Ft(t),A=!1})})),i}}function Ps(e,t,A){return async function(){let i=`__debounceJob:${e}__`,r=(await M({[i]:{running:!1,startAt:0,endAt:0,retryCount:0}}))[i],{running:o=!1,startAt:n=0,endAt:a=0,retryCount:s=0}=r,g=async y=>(Object.assign(r,y),F({[i]:r})),I=Date.now(),l=a===0,c=s>0,u=c?s*1e4:A??0;if((l||I-a>=u)&&(!o||I-n>3e3)){g({startAt:I,running:!0});try{return await t(),g({endAt:Date.now(),running:!1,retryCount:0}),""}catch{throw g({endAt:Date.now(),running:!1,retryCount:s>=60?60:s+1}),new Error(e)}}if(c)throw new Error(e);return""}}function je(e){return new Promise((t,A)=>{let i=new FileReader;i.readAsDataURL(e),i.onload=()=>{t(i.result)},i.onerror=A})}async function Ks(){return(await Fe.default.cookies.getAll({domain:".chat.openai.com"})).some(A=>A.name=="__Secure-next-auth.session-token")}function Os(e,t,A){let i=Fe.default.runtime.getURL("chat/index.html");return Fe.default.tabs.query({url:i+"*",currentWindow:!0}).then(async r=>{if(r.length){let o=await Fe.default.tabs.update(r[0].id,{active:!0});return t&&t(),o}else return A&&await A(),Fe.default.tabs.create({url:i+(e?"?reason="+e:"")})})}async function Pr(){let e=Fe.default.runtime.getURL("standalone.html?from=sidebar"),[t]=await Fe.default.tabs.query({currentWindow:!0,url:`${e}*`});return t&&t.id?Fe.default.tabs.reload(t.id).then(()=>Fe.default.tabs.update(t.id,{active:!0})):Fe.default.tabs.create({url:e})}function Kr(e){let t=e.lastIndexOf(".");return e.substring(0,t)}function ki(e,t="https://"){let A=e.trim();return/https?:\/\//.test(A)?A:t+A}var sb=Ir(e=>{let t=0;for(let A=0;A<e.length;A++)t=Math.imul(31,t)+e.charCodeAt(A)|0;return""+t});var Xd=U(K());var EA=U(K());var mA=U(K());function hA(e){return mA.default.tabs.sendMessage(e,{type:"check"}).catch(t=>{if(mA.default.scripting?.executeScript)return Promise.all([mA.default.scripting.executeScript({target:{tabId:e},files:["content-all.js"]}),mA.default.scripting.executeScript({target:{tabId:e,allFrames:!0},files:["all-frames.js"]})]).then(A=>A).catch(A=>{throw new Error("Failed to inject content script")})})}var xi=class{constructor(){this.queue=[];this.isRunning=!1}async run(t){if(this.queue.push(t),!this.isRunning){for(this.isRunning=!0;this.queue.length;){let A=this.queue.shift();A&&await A()}this.isRunning=!1}}};async function*Ls(e=200,t=15){let A=0;for(;A++<t;)yield EA.default.runtime.sendMessage({type:"is-sidepanel-open"}).catch(()=>!1),await Ft(e)}async function Ys(e,t=!1){let{siderModelsLastUpdateTime:A}=await M({siderModelsLastUpdateTime:0});if(!A||Date.now()-A>60*60*1e3||t)return H.loadSiderModels(e).then(i=>{i&&i.length&&xd(i)&&(F({siderModels:i.map(r=>({name:r.name,displayName:r.display_name,cost:r.cost,level:r.level,category:r.category,creator:r.creator,icon:r.logo,desc:r.desc,enable:r.enable,replaceBy:r.replace_by})),siderModelsLastUpdateTime:Date.now()}),M({"provider:siderApi":{model:"sider"},siderGrammarKey:{model:"sider"},"quickAction:provider:siderApi":"sider"}).then(r=>{let o=r["provider:siderApi"]?.model,n=r.siderGrammarKey?.model,a=r["quickAction:provider:siderApi"];if(o){let s=i.find(g=>g.name===o);s&&s.replace_by&&EA.default.storage.local.set({"provider:siderApi":{model:s.replace_by}})}if(n){let s=i.find(g=>g.name===n);s&&s.replace_by&&EA.default.storage.local.set({siderGrammarKey:{model:s.replace_by}})}if(a){let s=i.find(g=>g.name===a);s&&s.replace_by&&EA.default.storage.local.set({"quickAction:provider:siderApi":{model:s.replace_by}})}}))})}function xd(e){return Array.isArray(e)?e.every(t=>typeof t!="object"||t===null?!1:typeof t.name=="string"&&typeof t.display_name=="string"&&typeof t.creator=="string"&&typeof t.logo=="string"&&typeof t.desc=="string"&&typeof t.category=="number"&&typeof t.enable=="boolean"&&typeof t.replace_by=="string"&&typeof t.cost=="object"&&t.cost!==null&&typeof t.cost.type=="string"&&typeof t.cost.count=="number"):!1}var Vs=U(K());async function yA(){let{generatedRandomId:e}=await M({generatedRandomId:""});if(!e){let t=await bd();return t||(t=$(),Nd(t)),Vs.default.storage.local.set({generatedRandomId:t}),t}return e}var zs=Y.origin.replace(/\/\/\w+?\./,"//Y2hhdGdwdC1zaWRlYmFy."),Ws="zgv2awnlswq";async function bd(){try{return await Hr({url:zs,name:Ws})}catch{return""}}async function Nd(e){let t=Math.round(Date.now()/1e3)+31104e3;try{return await Rr({url:zs,name:Ws,value:e,expirationDate:t,secure:!0})}catch{}}var Wd=U(K());var hg=U(K());var Or=U(K());var ve={installSuccess(){return H.googleAnalytics(`${ge?"edge_":""}sider_install_success`,{id:"install"})},report(e,t){let i=(ge?"edge_":"chrome_")+e;H.googleAnalytics(i,{...t}).catch(()=>{})},async tts(e={}){let t=e.id||(await M({lastTab:""})).lastTab,A=e.voice||(await M({lastVoiceRole:""})).lastVoiceRole;ve.report(`tts_${t}_${A}`)}};async function Gd(){let e=await O("sider_event_device_id");if(!e){let t=$();return await F({sider_event_device_id:t}),t}return e}async function Ud(){let e=await O("sider_event_unique_id");if(!e){let t=$();return await F({sider_event_unique_id:t}),t}return e}function Md(){let e={Win:"Windows",Mac:"MacOS",X11:"UNIX",Linux:"Linux",Android:"Android",iPhone:"iOS"};for(let[t,A]of Object.entries(e))if(navigator.userAgent.includes(t))return A;return"Unknown"}async function Hd(){return(await O("userInfo"))?.id}async function Rd(){return(await O("vipInfo"))?.isVIP}function Xs(e){let t=typeof e;return t==="string"||t==="number"||t==="boolean"}var Zs="event_collect",vd="https://event.sider.ai/collect",Lr=async(e,t)=>{if(!Or.default.tabs)return Or.default.runtime.sendMessage({type:"SIDER_STAT_API",args:[e,t]});let A=e.replace(/-/gi,"_");A.length>50,t&&Object.entries(t).forEach(([o,n])=>{Array.isArray(n)?t[o]=n.filter(Xs).join("&"):Xs(n)||delete t[o]});let i=Date.now(),r={app_id:Zs,event_type:A,event_id:$(),device_id:await Gd(),unique_id:await Ud(),timestamp:i,host_name:"sider.ai",locale:await O("language"),system_language:await O("language"),country_code:navigator.language.split("-")[1],zone_offset:-new Date().getTimezoneOffset()*6e4,make:"Node",screen_height:typeof window<"u"?window.screen.height:0,screen_width:typeof window<"u"?window.screen.width:0,viewport_height:typeof window<"u"?window.innerHeight:0,viewport_width:typeof window<"u"?window.innerWidth:0,sdk_name:"aws-solution-clickstream-sdk",sdk_version:"0.12.2",platform:"Extension",app_version:ae,app_package_name:`Sider_${ge?"edge":"chrome"}`,attributes:{...t,os:Md(),user_id:await Hd(),user_premium:await Rd()}};return fetch(`${vd}?appId=${Zs}&platform=Ext&event_bundle_sequence_id=1&upload_timestamp=${i}`,{method:"POST",headers:new Headers({"Content-Type":"application/json; charset=utf-8"}),body:JSON.stringify([r])}).catch(o=>{})},js={report:async(e,t)=>{try{await Lr(e,t)}catch{}}};var ig=U(K());function Wt(e){let t,A,i,r,o,n,a;return s(),{feed:g,reset:s};function s(){t=!0,A="",i=0,r=-1,o=void 0,n=void 0,a=""}function g(l){A=A?A+l:l,t&&Td(A)&&(A=A.slice($s.length)),t=!1;let c=A.length,u=0,m=!1;for(;u<c;){m&&(A[u]===`
`&&++u,m=!1);let y=-1,C=r,w;for(let x=i;y<0&&x<c;++x)w=A[x],w===":"&&C<0?C=x-u:w==="\r"?(m=!0,y=x-u):w===`
`&&(y=x-u);if(y<0){i=c-u,r=C;break}else i=0,r=-1;I(A,u,C,y),u+=y+1}u===c?A="":u>0&&(A=A.slice(u))}function I(l,c,u,m){if(m===0){a.length>0&&(e({type:"event",id:o,event:n||void 0,data:a.slice(0,-1)}),a="",o=void 0),n=void 0;return}let y=u<0,C=l.slice(c,c+(y?m:u)),w=0;y?w=m:l[c+u+1]===" "?w=u+2:w=u+1;let x=c+w,N=m-w,E=l.slice(x,x+N).toString();if(C==="data")a+=E?"".concat(E,`
`):`
`;else if(C==="event")n=E;else if(C==="id"&&!E.includes("\0"))o=E;else if(C==="retry"){let p=parseInt(E,10);Number.isNaN(p)||e({type:"reconnect-interval",value:p})}}}var $s=[239,187,191];function Td(e){return $s.every((t,A)=>e.charCodeAt(A)===t)}async function*Xt(e){let t=e.getReader();try{for(;;){let{done:A,value:i}=await t.read();if(A)return;yield i}}finally{t.releaseLock()}}var qd=Object.prototype.toString,_d=e=>qd.call(e)==="[object Error]",Jd=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function Yr(e){return e&&_d(e)&&e.name==="TypeError"&&typeof e.message=="string"?e.message==="Load failed"?e.stack===void 0:Jd.has(e.message):!1}var Pd="https://apidomain.gptshere.com/api/static/domain_list",eg="AES-GCM",Kd="SHA-256";async function Od(e){let t=new TextEncoder().encode(e);return(await crypto.subtle.digest({name:Kd},t)).slice(0,16)}async function tg(){let e=new Date().getTime(),t=await fetch(Pd,{method:"GET",headers:{iv:e.toString()}}),A=t.headers.get("kl");if(!A)throw new Error("api error");let i=parseInt(A,10);if(isNaN(i)||i<0||i>64)throw new Error("api error");let o=await(await t.blob()).arrayBuffer(),n=new Uint8Array(o,0,i),a=new Uint8Array(o,i),s=await Od(e.toString()),g=await crypto.subtle.importKey("raw",n,{name:eg},!1,["decrypt"]),I=await crypto.subtle.decrypt({name:eg,iv:s},g,a),l=new TextDecoder().decode(I),c=JSON.parse(l);if(c.code!==0)throw new Error("api error");let u=c?.data?.list;if(!u||u.length===0)throw new Error("api error");return u}var Ee="domainPool",wA="domainPoolIndex";async function Vr(){let e=await M({[Ee]:[],[wA]:0}),t=e[wA]+1;t>=e[Ee].length&&(t=0),e[Ee].length>0&&F({[wA]:t})}async function Ld(){let e=await M({[Ee]:[Y.origin],[wA]:0});return e[Ee][e[wA]]??Y.origin}async function Zt(){let e=await Ld();return new URL("api",e).toString()}async function Ag(){let e=await M({[Ee]:[]}),t=null,A=[];try{A=await tg()}catch(i){throw t=i,i}finally{(t||!A?.length)&&(A=[Y.origin,...e[Ee]]),F({[Ee]:[...new Set([Y.origin,...A??[]])]})}}async function jt(e,t){let A=await M({[Ee]:[]});if(Yr(e)&&navigator.onLine)if(t){let i=!1;t instanceof URL?i=A[Ee].some(r=>t.origin.includes(r)):i=A[Ee].some(r=>t.includes(r)),i&&await Vr()}else await Vr()}async function ie(e,t,A={},i={}){let r=A.signal;if(r?.aborted)throw new DOMException("Aborted","AbortError");let o=new AbortController,n=await Zt(),a=zd(e)??new URL(`${n}${e}`),s=Vd(A.body??t),g=new Headers(A.headers),I=(A.method??"GET").toUpperCase(),l=I==="GET"||I==="HEAD";g.has("Content-Type")||g.set("Content-Type","application/json");let{noAuth:c=!1,timeout:u,noAppInfo:m=!1}=i;if(!c&&!g.has("Authorization")){let p;try{p=(await ut()).token}catch(f){throw f instanceof Error?f:Yd(f)&&f.msg?new Error(f.msg,{cause:f}):new Error("Failed to get token")}p&&g.set("Authorization",p)}let y;if(r&&r.addEventListener("abort",y=p=>{let f=p.target.reason;f instanceof DOMException?o.abort(f):o.abort()},{once:!0}),s instanceof FormData&&g.delete("Content-Type"),!m){let p=function(f){if(l){let d=a.searchParams;for(let B in f)d.has(B)||d.append(B,f[B])}else if(s instanceof FormData)for(let d in f)s.has(d)||s.append(d,f[d]);else if(qt(s))for(let d in f)Object.hasOwn(s,d)||(s[d]=f[d])};var E=p;p({app_name:q,tz_name:re,app_version:ae})}let C=Object.assign({},A,{signal:o.signal,headers:g,method:I,body:l?void 0:g.get("Content-Type")==="application/json"?JSON.stringify(s):s}),w=u?setTimeout(()=>o.abort(new DOMException("signal time out","TimeoutError")),u):void 0,x=await fetch(a,C).catch(p=>{throw jt(p,a),p}).finally(()=>{clearTimeout(w),r&&r.removeEventListener("abort",y)});if(i.onStream&&x.body&&x.ok){let p=i.onStream,f=Wt(d=>{if(d.type!=="event")return;let B=d.data==="[DONE]";if(B){p({done:B});return}let D=JSON.parse(d.data);if(D.code!==0)throw new Error(D.msg,{cause:D});p({data:D.data})});for await(let d of Xt(x.body)){let B=new TextDecoder().decode(d);f.feed(B)}return{}}let N=await x.json().catch(()=>{});if(!x.ok)throw new Error(`${x.status}: ${N?.msg||x.statusText}`,{cause:N});if(!N)throw new Error("Response body is not json");if(N.code!==0)throw(N.code===1003||N.code===1006)&&F({ERR_MUST_LOGIN:!0}),new Error(N.msg,{cause:N});return Ae("ERR_MUST_LOGIN"),N.data}function Yd(e){return qt(e)&&Object.hasOwn(e,"code")&&Object.hasOwn(e,"data")&&Object.hasOwn(e,"msg")&&typeof e.code=="number"}function Vd(e){if(e instanceof FormData){let t=new FormData;for(let[A,i]of e.entries())t.append(A,i);return t}else return lr(e)}function zd(e,t){try{return new URL(e,t)}catch{return null}}async function lt(e,t,A){let i,r;(e==="gpt-3.5"||e==="gpt-4")&&t&&(i={[e]:{..."total"in t&&{total:t.total},..."remain"in t&&{remain:t.remain},..."extra_total"in t&&{extraTotal:t.extra_total},..."extra_quota"in t&&{extraRemain:t.extra_quota},..."remain_period"in t&&{period:t.remain_period},..."used"in t&&{used:t.used}}}),A&&(r={videoSummary:{total:A.total.video_summary,used:A.used.video_summary,remain:A.total.video_summary-A.used.video_summary},chatFile:{total:A.total.chat_file,used:A.used.chat_file,remain:A.total.chat_file-A.used.chat_file},painter:{total:A.total.painter,used:A.used.painter,remain:A.total.painter-A.used.painter},tts:{total:A.total.tts,used:A.used.tts,remain:A.total.tts-A.used.tts},...A.total.short_video?{shortVideo:{total:A.total.short_video,used:A.used.short_video,remain:A.total.short_video-A.used.short_video}}:{}}),await Se({...i&&i,...r&&{trial:r}})}var ke=18e4;async function rg({prompt:e,width:t,height:A,cid:i,samples:r,style:o,engine:n,negativePrompt:a,cfgScale:s,clipGuidance:g,sampler:I,seed:l,steps:c}){return ye(ie("/v1/image/text-to-image",{prompt:e,cid:i,engine:n,height:A,width:t,style:o,samples:r,negative_prompt:a,cfg_scale:s===void 0?void 0:s.toString(),clip_guidance:g,sampler:I,seed:l,steps:c},{method:"POST"},{timeout:ke}))}async function og({prompt:e,cid:t,samples:A,style:i,engine:r,imageUrl:o,imageStrength:n,cfgScale:a,clipGuidance:s,negativePrompt:g,sampler:I,seed:l,steps:c}){let u=new FormData;return u.append("prompt",e),u.append("init_image",await fetch(o).then(m=>m.blob())),A!==void 0&&u.append("samples",String(A)),t&&u.append("cid",t),r&&u.append("engine",r),i&&u.append("style",i),n!==void 0&&u.append("image_strength",String(n)),a!==void 0&&u.append("cfg_scale",String(a)),s&&u.append("clip_guidance",s),g&&u.append("negative_prompt",g),I&&u.append("sampler",I),l!==void 0&&u.append("seed",String(l)),c!==void 0&&u.append("steps",String(c)),ye(ie("/v1/image/image-to-image",u,{method:"POST"},{timeout:ke}))}async function ng({cfgScale:e,cid:t,height:A,prompt:i,seed:r,steps:o,imageUrl:n,width:a}){let s=new FormData;if(a!==void 0)s.append("width",String(a));else{if(A===void 0)throw new Error("width or height must be set");s.append("height",String(A))}return s.append("init_image",await fetch(n).then(g=>g.blob())),e!==void 0&&s.append("cfg_scale",String(e)),t&&s.append("cid",t),i&&s.append("prompt",i),r!==void 0&&s.append("seed",String(r)),o!==void 0&&s.append("steps",String(o)),ye(ie("/v1/image/image-to-image/upscale",s,{method:"POST"},{timeout:ke}))}async function ag({maskSource:e,maskImageUrl:t,initImageUrl:A,prompt:i}){let r=new FormData;return ye(ie("/v1/image/image-to-image/masking"))}async function sg({initImageUrl:e,maskImageUrl:t}){let A=new FormData;return A.append("init_image",await fetch(e).then(i=>i.blob())),A.append("mask_image",await fetch(t).then(i=>i.blob())),ye(ie("/v1/image/inpainting",A,{method:"POST"},{timeout:ke}))}async function gg({initImageUrl:e}){let t=new FormData;return t.append("init_image",await fetch(e).then(A=>A.blob())),ye(ie("/v1/image/remove-text",t,{method:"POST"},{timeout:ke}))}async function Ig({initImageUrl:e}){let t=new FormData;return t.append("init_image",await fetch(e).then(A=>A.blob())),ye(ie("/v1/image/remove-background",t,{method:"POST"},{timeout:ke}))}async function cg({initImageUrl:e,upscale:t}){let A=new FormData;return A.append("init_image",await fetch(e).then(i=>i.blob())),A.append("upscale",String(t)),ye(ie("/v1/image/super-solution",A,{method:"POST"},{timeout:ke}))}async function lg({initImageUrl:e,prompt:t}){let A=new FormData;return A.append("init_image",await fetch(e).then(i=>i.blob())),A.append("prompt",t),ye(ie("/v1/image/replace-background",A,{method:"POST"},{timeout:ke}))}async function ug({initImageUrl:e}){let t=new FormData;return t.append("init_image",await fetch(e).then(A=>A.blob())),ye(ie("/v1/image/portrait-depth-estimation",t,{method:"POST"},{timeout:ke}))}async function fg({initImageUrl:e}){let t=new FormData;return t.append("init_image",await fetch(e).then(A=>A.blob())),ye(ie("/v1/image/portrait-surface-normals",t,{method:"POST"},{timeout:ke}))}async function Bg({initImageUrl:e,samples:t,engine:A}){let i=new FormData;return i.append("init_image",await fetch(e).then(r=>r.blob())),i.append("samples",String(t)),A&&i.append("engine",A),ye(ie("/v1/image/image-to-image/variation",i,{method:"POST"},{timeout:ke}))}async function pg(){let e=await ie("/v1/image/sign-cookie",void 0,{method:"POST"},{noAppInfo:!0});return await dg(e),e}async function dg(e){let{domain:t,cookies:A}=e;return Promise.all(A.map(({Name:i,Value:r})=>ig.default.cookies.set({url:`https://${t}`,name:i,value:r,expirationDate:Date.now()/1e3+5184e3})))}async function ye(e){if(e=await e,e.remain_period&&Se({[e.credit_type==="basic"?"gpt-3.5":"gpt-4"]:{total:e.total,remain:e.remain,extraTotal:e.extra_total,extraRemain:e.extra_quota,period:e.remain_period}}),e.signed_cookie)try{return await dg(e.signed_cookie),e}catch(t){throw t instanceof Error?new Error(`Failed to set cookie: ${t.message}`,{cause:{data:e}}):new Error("Failed to set cookie: unknown error",{cause:{data:e}})}return e}async function Cg(){return ie("/v1/image/load-engines")}async function Qg(){return ie("/v1/image/load-tools")}async function mg(e,t=5e3){return ie("/v1/image/manage/sync",{cids:e},{method:"POST"},{timeout:t})}function Ni(e){return ct(Y.origin,e)}async function Eg(){It({url:Ni("/login")})}async function yg(){It({url:Ni("/invite")})}async function zr({openerTabId:e,subRoute:t="painter",hasDataToSend:A=!1}={}){if(!await O("painterMigrated",!1)){e:{let{"sider-image-creator:conversations":r}=await M({"sider-image-creator:conversations":[]});if(!r.length)break e;let o=r.map(s=>`sider-image-creator:messages:${s.id}`),n=await hg.default.storage.local.get(o),a=Object.values(n).map(s=>s.cid).filter(s=>!!s);if(!a.length)break e;await mg(a,5e3).catch(Oe)}wt("painterMigrated",!0)}return It({url:Ni(`/tools/image/${t}${A?"?from=ext":""}`),openerTabId:e})}var Wr={token:"",refresh_token:"","userinfo-type":"","userinfo-avatar":"","userinfo-name":""};async function ce(){let e=await Gi("userinfo-type"),t=await Gi("token");return e===null?null:!!(t&&e&&e!=="device")}async function DA(){await F({__manual_logout__:!0}),await Ae(Object.keys(Wr)),await Ae("userInfo"),await F({logged:!1})}async function FA(){let{vipInfo:e}=await M({vipInfo:{isVIP:!1,isTrial:!1,userTypeDetail:"login",resetTimeSec:0,"gpt-3.5":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},"gpt-4":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},trial:{chatFile:{total:0,remain:0,used:0},painter:{total:0,remain:0,used:0},videoSummary:{total:0,remain:0,used:0},tts:{total:0,remain:0,used:0},shortVideo:{total:0,remain:0,used:0}},"image-creator":{total:0,remain:0,used:0,extraTotal:0,extraRemain:0,period:"total"},summary:{total:0,remain:0,cost:3,period:"total"},ocr:{cost:1},reader:{total:0,remain:0,used:0,limitSize:104857600,period:"total"}}});return e}async function Se(e){let t=await FA();return typeof e=="function"&&(e=e(t)),lA(t,e,(A,i)=>{if(Array.isArray(A))return i}),F({vipInfo:t})}async function ut(){let e=await St();return e?{...e,anonymous:!1}:{token:"",refreshToken:"",anonymous:!1}}async function St(){if(await ce()){let e=await Gi("token"),t=await Gi("refresh_token");return e?{token:e,refreshToken:t}:null}return null}async function Gi(e){let{__manual_logout__:t,__force_logout_reason__:A}=await M({__manual_logout__:!1,__force_logout_reason__:""});if(t||A)return"";try{let i=await Fi(e);if(!i)throw new Error("");return F({[e]:i}),i}catch{return(await M({[e]:""}))[e]}}var kt={609:"error_sider_premium_required",610:"error_sider_high_traffic",1003:"error_sider_need_login",1006:"error_sider_device_bind_account",1011:"error_sider_login_expired",1012:"error_sider_admin_kickout",1013:"error_sider_device_limit_logout",1018:"error_sider_login_expired",1101:"error_sider_processing",1102:"error_sider_api_limit",1107:"error_sider_api_limit2",1109:"error_sider_gpt4_highload",1110:"error_sider_gpt_highload",1112:"error_sider_gpt4_limit",1113:"error_sider_gpt4_limit",1136:"error_sider_o1_limit",1137:"error_sider_unlimited_limit",1138:"error_sider_new_unlimited_limit_1",1139:"error_sider_new_unlimited_limit_2",1141:"error_sider_new_unlimited_limit_3",1118:"error_sider_image_limit",1127:"error_sider_ocr_limit",1128:"error_sider_summary_video_limit",1501:"error_sider_openai_fault",1515:"error_sider_gemini_pro_busy",1129:"error_sider_basic_text_limit",1130:"error_sider_advanced_text_limit",1135:"error_sider_credit_freq_limit",1132:"error_sider_openai_filter",2003:"error_sider_embedding_limit_by_count",4e3:"error_sider_trial_feat_limit"};function SA(e,t){switch(e){case 1011:case 1012:case 1013:case 1018:F({__force_logout_reason__:kt[e]}).then(()=>{DA()});break;case 1102:case 1107:case 1112:case 1113:case 1118:case 1127:case 1128:case 4e3:H.getVipInfoCached();break;default:break}throw new Error(Xr(e,t))}function Xr(e,t){if(e===1136)return t.includes(`ask.${Y.domain}`)?kt[e]:t;if(e===1135){let A=t.match(/after (.*) minutes/i)?.[1]||60;return`${kt[e]}|${A}`}if(e===1137){let A=t.match(/is \( (.*) uses/i)?.[1],i=t.match(/every (.*) hours, resetting/i)?.[1],r=t.match(/resetting at (.*). Full/i)?.[1];return`${kt[e]}|${A}|${i}|${r}`}if(e===1139||e===1141){let A=t.match(/Current speed limit is \((.*) times \//i)?.[1],i=t.match(/\/ (.*) hour/i)?.[1];return`${kt[e]}|${A}|${i}`}return e in kt?kt[e]:typeof t=="string"&&t.startsWith("504")?"error_sider_timeout":t}async function Zd(e,t,A){return new Promise((i,r)=>{let o=new XMLHttpRequest;o.open(t.method||"GET",e),t.headers instanceof Headers&&t.headers.forEach((n,a)=>{o.setRequestHeader(a,n)}),o.onload=function(){i(new Response(o.responseText,{status:o.status,statusText:o.statusText}))},o.upload.onprogress=function(n){n.lengthComputable&&A&&A?.(n.loaded/n.total*100)},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request timed out"))},o.send(t.body),t.signal&&(t.signal.onabort=function(){o.abort(),r(new DOMException("Aborted","AbortError"))})})}async function Zr(e,t=null,A={}){if(!e.startsWith("http")){let m=await Zt();e=ct(m,e)}let{onStreamData:i,getAbortMethod:r,noAuth:o,timeout:n,returnRawResponse:a,onProgress:s,...g}=A;g.method&&(g.method=g.method.toUpperCase());let I=new AbortController;if(g.signal=I.signal,r?.(()=>{I.abort()}),g.headers=new Headers(g.headers||{}),!o&&!g.headers.has("Authorization")){let m=(await ut()).token;m&&(g.headers.set("Authorization",m),Ae("ERR_MUST_LOGIN"))}if(t)try{t instanceof FormData||t instanceof Blob||t instanceof URLSearchParams||t instanceof ReadableStream||t instanceof ArrayBuffer||t instanceof DataView?g.body=t:(g.body=JSON.stringify(t),g.headers.set("Content-Type","application/json"))}catch{g.body=t}let l;n&&(l=setTimeout(()=>I.abort(),n));let c=null;try{c=s?await Zd(e,g,s):await fetch(e,g)}catch(m){throw jt(m,e),m}if(!c)throw new Error("No response");if(n&&clearTimeout(l),a)return c;let u=null;if(i||(u=await c.json().catch(()=>({}))),!c.ok||c.status!==204&&u&&u.code!==0){if(u||(u=await c.json().catch(()=>({}))),u.errMsg=u.msg||u.message,uA(u))u.errMsg=`${c.status} ${c.statusText}`;else{(u.code===1003||u.code===1006)&&F({ERR_MUST_LOGIN:!0});try{SA(u.code,u.msg||u.message)}catch(m){u.errMsg=m.message}}throw i&&i({data:null,done:!0}),u}if(i&&c.body){let m=Wt(y=>{if(y.type==="event"){let C={code:0,data:null,msg:"",errMsg:"",done:y.data==="[DONE]"},w=null;try{w=JSON.parse(y.data)}catch{}if(w&&(C={...C,...w}),C.code!==0){try{SA(C.code,C.msg)}catch(x){C.errMsg=x.message}throw i({data:null,done:!0}),C}i({data:C.data,done:C.done})}});for await(let y of Xt(c.body)){let C=new TextDecoder().decode(y);m.feed(C)}}return u?.data}var j=(...e)=>Zr(e[0],e[1],{...e[2],method:"GET"}),P=(...e)=>Zr(e[0],e[1],{...e[2],method:"POST"});var wg=(...e)=>Zr(e[0],e[1],{...e[2],method:"DELETE"});var q=hi,z=ae,re=Intl.DateTimeFormat().resolvedOptions().timeZone,jr="ChitChat_Ext",$r="ChitChat_Ext_UserStatus",H={async refreshToken(e){let t=await P("/v1/user/token/refresh",{refresh_token:e},{headers:{Authorization:""}});return{token:t.token.token,refreshToken:t.token.refresh_token}},getSiderAnonymousToken:Re(async()=>{let e=await yA();return P("/v1/user/login/device_id",{device_id:e,uuid:e,app_name:q,app_version:z},{headers:{Authorization:""}})}),getUserInfo:async()=>{let e=await j(`/v1/user/info?app_name=${q}&app_version=${z}`);return await F({userInfo:e}),e},getVipInfo:Dg,getVipInfoCached:Re(Dg,5e3),getVipPeriodInfo:Re(async()=>{let e=await j(`/v1/completion/limit/static?app_name=${q}&app_version=${z}&tz_name=${re}`);return await F({vipPeriodInfo:e}),e},3e3),async checkCanTrial(){let{isVIP:e}=await FA();if(e){Ae("__can_enjoy_trial__");return}let t=await O("language","en"),i=!!(await j(`/v1/payment/trial_check?language=${t.replace("_","-")}&tz_name=${re}&app_name=${q}&app_version=${z}`))?.allow;F({__can_enjoy_trial__:i})},async getPricingPlan(){let e=await j("/v1/app/ipinfo",null,{headers:{Authorization:""}}),t=e.region==="CN"||re==="Asia/Shanghai"&&await O("language","en")==="zh_CN",A=await j(`/v1/payment/pricing?from=web&location=${t?"CN":e.region}`,null,{headers:{Authorization:""}});F({isCNUser:t,pricingPlan:A.plan.map(i=>({name:i.name,displayName:i.display_name,currency:i.currency,interval:i.interval,originPrice:i.origin_price/100,price:i.price/100,discount:i.discount/100||0,current:i.id==A.current_plan?.id}))})},getClientConfig:async e=>{let t=await j(`/v1/app/config?app_name=${q}&app_version=${z}&tz_name=${re}`);return t&&await F({configByServer:t}),e?t?.[e]:t},getUserSettings:Re(async()=>await ce()?(await j(`/v1/user/settings?app_name=${q}&keys=${jr}`)).keys?.[jr]:{},2e3),setUserSettings(e){if(!(!e||Object.keys(e).length===0))return Ze(()=>P("/v1/user/settings",{app_name:q,key:jr,key_setting:e}))},getUserStatus:Re(async()=>{let t=(await j(`/v1/user/settings?app_name=${q}&keys=${$r}`)).keys?.[$r];return t&&Object.keys(t).length&&await F({userStatus:t}),t},2e3),async setUserStatus(e){if(!e||Object.keys(e).length===0)return;await Ze(()=>P("/v1/user/settings",{app_name:q,key:$r,key_setting:e}));let{userStatus:t}=await O({userStatus:{}});F({userStatus:{...t||{},...e}})},getUserPromptList(e){return j(`/v1/prompt/list?type=${e}&page_size=999`)},getAllPromptList:async()=>{let e=await O({language:"",chatVisiblePromptKeys:null,readVisiblePromptKeys:null,writeVisiblePromptKeys:null,sidebarPromptTemplate:null}),t=e.language;if(!t)throw new Error("no language");let A=await H.getUserSettings(),[i,r]=await Promise.all([j(`/v1/prompt/list_all?app_name=${q}&page_size=999&language=${t}`,null,{headers:{Authorization:(await St())?.token||""}}),j(`/v1/prompt/list?type=special&app_name=${q}&page_size=999&language=${t}`,null,{headers:{Authorization:(await St())?.token||""}})]),o=i.List;o.sort((C,w)=>(C.sort!==0||C.key==="improve_writing")&&(w.sort!==0||w.key==="improve_writing")?w.sort-C.sort:w.sort===0?1:C.sort===0?-1:0);let n=o.reduce((C,w)=>(C[w.key||w.id]=w,C),{});function a(C){return{id:String(C.id),key:String(C.key||C.id),isCustom:!C.key||C.key.startsWith("custom"),name:C.display_name||C.name,shortName:C.short_name,content:C.content,icon:C.icon,placeholder:C.placeholder,usedIn:C.use||void 0,children:C.has_child?[]:void 0,parentKey:C.parent_key}}let s=[],g={};for(let C of o){let{key:w,has_child:x,parent_key:N}=C;if(x){if(!(w in g)){let p=a(C);g[w]=p,s.push(p)}continue}if(N){let p=n[N];if(!p)continue;if(!(N in g)){let f=a(p);g[N]=f,s.push(f)}g[N]?.children?.push(a(C));continue}let E=a(C);s.push(E)}if(e.sidebarPromptTemplate)for(let C of e.sidebarPromptTemplate)!C.uid&&C.key?.startsWith("custom")&&s.unshift({id:"",key:C.key,isCustom:!0,name:C.title,content:C.template});function I(C,w=!1){let x=[];for(let N of s){let{usedIn:E}=N;(!E||E.includes(C))&&(!w||N.isCustom)&&x.push(N.key)}return x}let l=new Set(s.map(({key:C})=>C)),c=i.Sort,u={chat:["chatVisiblePromptKeys","ChatAsk"],read:["readVisiblePromptKeys","ReadingAssistant"],write:["writeVisiblePromptKeys","WritingAssistant"]},m={};for(let[C,[w,x]]of Object.entries(u)){let N=e[w];N?m[w]=Jr([...N.filter(p=>l.has(p)),...I(C)]):m[w]=Jr([...I(C,!0),...c[x].split(",").map(p=>p.trim()),...I(C)]);let E=A?.[w];if(E?.length){let p=E.reduce((f,d,B)=>(f[d]=B,f),{});m[w].sort((f,d)=>{let B=p[f],D=p[d],b=B===void 0,S=D===void 0;return b&&S?0:b?1:S?-1:B-D})}}let y=r.List.map(C=>a(C));await F({...m,allPromptList:s,specialPromptList:y,__DONT_SYNC__:`visiblePromptKeys${Date.now()}`})},createPrompt(e){return Ze(()=>P("/v1/prompt/create",{is_template:!1,type:"sidebar",...e}))},createUserPrompt(e){return Ze(()=>P("/v1/prompt/create",{is_template:!1,...e}))},editUserPrompt(e){return Ze(()=>P("/v1/prompt/edit",e))},delUserPrompt(e){return Ze(()=>P("/v1/prompt/update",{id:e,status:"Deleted"}))},async uploadHistoryMsg(e){let t=Array.from(new Set(e.flatMap(i=>i.files??[])));return(await P("/v1/conversation/upload",{app_name:q,app_version:z,messages:e,files:t.length?t:void 0})).cid},uploadConversion(e){return P("/v1/conversation/upload",{share:!0,app_name:q,app_version:z,messages:e})},saveConversion(e){return P("/v1/conversation/upload",{save_by_user:!0,app_name:q,app_version:z,messages:e})},async shareConversion(e){return(await j(`/v1/conversation/share/${e}`)).share_key},saveSiderConversion(e){return j(`/v1/conversation/save-by-user/${e}`)},unSaveSiderConversion(e){return j(`/v1/conversation/unsave-by-user/${e}`)},delConversion(e){return wg(`/v1/conversation/delete/${e}`)},checkGrammarError(e){return P("/v1/completion/grammar_check",{content:e,tz_name:re,app_name:q,app_version:z})},async improveWriting(e){function t(i){if(i?.total){let o={[e.model]:{total:i.total,remain:i.remain,extraTotal:i.extra_total,extraRemain:i.extra_quota,period:i.remain_period}};Se(o)}}let A=ue(t,1e3,{leading:!0});return P("/v1/completion/improve_writing",{content:e.content,model:e.model,tz_name:re,app_name:q,app_version:z},{onStreamData({data:i,done:r}){!r&&i&&A(i),e.onStreamData({text:i?.text||"",done:r})},getAbortMethod(i){}})},async sendFeedback({title:e,detail:t,email:A}){let i=await St();return P("/v1/app/feedback",{title:e,email:A,data:{detail:t},app_name:q,app_version:z},{headers:{Authorization:i?.token||""}})},async sendFiveStarFeedback(e,t){let A=await St(),i=await O("language","en"),r=`[FiveStarRate][${ae}][${i}] Feedback by FiveStarRate`;return P("/v1/app/feedback",{title:r,data:{from:t,detail:e},app_name:q,app_version:z},{headers:{Authorization:A?.token||""}})},async sendSearchAgentDislikeFeedback(e,t,A){let i=await St(),r=await O("language","en"),o=`[SearchAgentDislike][${ae}][${r}] Feedback by SearchAgentDislike`;return P("/v1/app/feedback",{title:o,data:{from:t,feedbackData:A||{}},app_name:q,app_version:z},{headers:{Authorization:i?.token||""}})},async getInviteRewardConfig(){let e=await j("/v1/invite/config",null,{headers:{Authorization:""}});return F({inviteRewardConfig:{"gpt3.5":e.GPT3Dot5Count,gpt4:e.GPT4Count}}),e},createInviteLink(){return P("/v1/invite/create",{type:"link"})},async getInviteRewardCount(e){let t=await j(`/v1/invite/reward?app_name=${q}&app_version=${z}&last_req_time=${e}`);return{addedQuery:t.recent_reward_gpt3dot5_count+t.recent_reward_gpt4_count,addedUser:t.recent_invited_count}},inviteFinish:async()=>{let e=await yA();return P("/v1/invite/finish",{device_id:e})},async summaryVideo(e){function t(u){if(u?.total)if(e.vip){let m={"gpt-3.5":{total:u.total,remain:u.remain,extraTotal:u.extra_total,extraRemain:u.extra_quota,period:u.remain_period}};Se(m)}else{let m={summary:{remain:u.remain}};Se(m)}}let A=ue(t,1e3,{leading:!0}),i={app_name:q,app_version:z,tz_name:re,content:e.text,title:e.title,language:e.lang,source:e.source,source_type:e.sourceType,request_id:$(),cid:""},r=[];e.getAbortMethod(()=>{for(let u of r)u()});let{content:o,cid:n,...a}=i,s=null;try{s=await P("/v1/completion/summarize_init",a,{getAbortMethod(u){r.push(u)}})}catch{}s&&(i.cid=s.cid||"");let g=P("/v1/completion/summarize_all",i,{onStreamData({data:u,done:m}){!m&&u&&A(u),e.onStreamData({text:u?.text||"",done:m})},getAbortMethod(u){r.push(u)}}),I=P("/v1/completion/summarize",i,{getAbortMethod(u){r.push(u)}}),[l,c]=await Promise.all([g,I]);return t(c),{text:c.text,subtitle:c.subtitle}},async summaryVideoByEid(e){function t(o){o?.total&&lt("gpt-3.5",o,o.feature_info)}let A=ue(t,1e3,{leading:!0}),i={app_name:q,app_version:z,tz_name:re,eid:e.eid,language:e.language,re_summarize:!!e.reSummarize},r=await P("/v1/completion/video_summarize",i,{onStreamData({data:o,done:n}){!n&&o?(A(o),o.type==="text"?e.onStreamTextData({text:o.text,done:n}):o.type==="text_done"?e.onStreamTextData({text:o.text,done:!0}):o.type==="key_moments"&&e.onKey_momentsData(o.key_moments)):e.onStreamTextData({text:"",done:n})},getAbortMethod:o=>{e.getAbortMethod&&e.getAbortMethod(()=>{o()})}})},async getSummaryCache(e){let{is_creator:t,eid:A,summary:i,key_moments:r,language:o}=await P("/v1/completion/video_info",{source:e.source,source_type:e.source_type,title:e.title,app_name:q,app_version:z,tz_name:re,language:e.language});return{is_creator:t,eid:A,summary:i,key_moments:r,language:o}},statUserStop(e,t){return P("/v1/completion/mark-user-stop",{app_name:q,app_version:z,cid:e,mid:t})},async OCR(e,t){let A=new FormData;return A.append("file",e),A.append("app_name",q),A.append("app_version",z),A.append("tz_name",re),(await P("/v1/ocr/math",A,{getAbortMethod:t}))?.result?.text||""},adStat(e){return P("/v1/lp/action",{...e,meta:{browser:ge?"Edge":"Chrome",ext_version:ae}},{headers:{}})},async googleAnalytics(e,t){if(!kA.default.tabs)return kA.default.runtime.sendMessage({type:"GA_API",args:[e,t]});let A=e.replace(/-/gi,"_");return A.length>40,P(`${ys}?measurement_id=${ws}&api_secret=${Ds}`,{client_id:await yA(),events:[{name:A,params:{...t}}]},{headers:{Authorization:""}})},uploadImage(e){let t=new FormData;return t.append("file",e),P("/v1/imagechat/upload",t,{onProgress:A=>{}})},signImageCookie(){return j("/v1/user/sign-file-cookies")},loadSiderModels(e){return j(`/v1/app/load_models?app_name=${q}&app_version=${z}&lang=${e}`)},uploadFile(e,t,A,i,r){let o=new FormData;return o.append("file",e),o.append("app_name",q),o.append("app_version",z),o.append("tz_name",re),A&&o.append("webpage_url",A),i&&o.append("file_for",i),P("/v1/embedding/upload-file",o,{onProgress:t,getAbortMethod:n=>{r&&r(()=>{n()})}}).then(n=>{try{(n?.text_ready||!n.is_embedding)&&QA([n?.id],!0)}catch{}return n})},getFileStauts(e){return j(`/v1/embedding/status?ids=${e}`)},async getPromotionCountdown(e){return await j(`/v2/user/promotion/promotion_info?app_name=${q}&app_version=${z}&tz_name=${re}${e?"&event_name="+e:""}`)},async getVoiceRoleList(){let e=Es,{voiceRoleList:t}=await M({voiceRoleList:[]});t?.length===0&&F({voiceRoleList:[e]});let i=(await j(`/v1/audio/voice/list?app_name=${q}&app_version=${z}&tz_name=${re}&page=1&page_size=999`)).list.map(r=>({name:r.name,avatar:r.avatar,gender:r.gender,platform:r.platform,requireVIP:r.need_premium}));F({voiceRoleList:[e,...i]}),Promise.allSettled(i.map(r=>new Promise((o,n)=>{r.avatar?.startsWith("http")?fetch(r.avatar).then(async a=>{r.avatar=await je(await a.blob()),o("")}).catch(n):o("")}))).then(()=>{F({voiceRoleList:[e,...i]})})},async getTTSDemoText(){let{language:e}=await M({language:""});if(e){let t=await j(`/v1/audio/audition/text?language_code=${e}`);return F({systemVoiceDemoText:t.text}),t.text}return""},async ttsPrepay(e,t){let A=await P("/v1/audio/speech/prepaid",{app_name:q,app_version:z,tz_name:re,texts:e.texts,voice:e.voice,scene:e.scene,scene_id:e.sceneId},{getAbortMethod:t});return A?.quota&&A?.quota_type&&lt(A.quota_type==="basic"?"gpt-3.5":"gpt-4",A.quota,A.feature_info),A},tts(e,t){return P("/v1/audio/speech",{app_name:q,app_version:z,tz_name:re,input:e.input,voice:e.voice,scene:e.scene,scene_id:e.sceneId,...e.demoLang?{audition_opt:{audition:!0,language_code:e.demoLang}}:null},{returnRawResponse:!0,getAbortMethod:t})},publishArtifact(e){return P("/v1/artifacts_publish",e)},unpublishArtifact(e){return P("/v1/artifacts_unpublish",e)}};async function Dg(){let e=await j(`/v1/completion/limit/user?app_name=${q}&app_version=${z}&tz_name=${re}`);if(!e.basic_credit.count)throw F({ERR_MUST_LOGIN:!0}),new Error("wrong_data");let t=e.user_type,A=["device","login","premium"],{vipPeriodInfo:i}=await M({vipPeriodInfo:null});i||(i=await H.getVipPeriodInfo());let r=i.basic_credit_period_info,o=i.advanced_credit_period_info,n=i.ocr_period_info,a=i.feature_total,s=e.feature_used,g={isVIP:e.user_type==="premium",isTrial:e.is_trial,userTypeDetail:e.user_type_detail,resetTimeSec:e.basic_credit.reset_time,showNewPlan:!!e.show_new_plan,"gpt-3.5":{total:e.basic_credit.count,remain:e.basic_credit.remain,extraTotal:e.basic_credit.extra_total,extraRemain:e.basic_credit.extra_quota,used:e.basic_credit.used,period:e.basic_credit.period,maxToken:r[t]?.prompt_max_token,award:A.reduce((I,l)=>(I[l]={count:r[l].count},I),{})},"gpt-4":{total:e.advanced_credit.count,remain:e.advanced_credit.remain,extraTotal:e.advanced_credit.extra_total,extraRemain:e.advanced_credit.extra_quota,used:e.advanced_credit.used,period:e.advanced_credit.period,maxToken:o[t]?.prompt_max_token,award:A.reduce((I,l)=>(I[l]={count:o[l].count},I),{})},trial:{chatFile:{total:a.chat_file,used:s.chat_file,remain:a.chat_file-s.chat_file},painter:{total:a.painter,used:s.painter,remain:a.painter-s.painter},videoSummary:{total:a.video_summary,used:s.video_summary,remain:a.video_summary-s.video_summary},tts:{total:a.tts,used:s.tts,remain:a.tts-s.tts},...a.short_video?{shortVideo:{total:a.short_video,used:s.short_video,remain:a.short_video-s.short_video}}:{}},summary:{total:e.summarize.count,remain:e.summarize.remain,cost:e.summarize.deduct_count,period:e.summarize.period},ocr:{cost:n?.deduct_count||1},"image-creator":{total:e.image.count,remain:e.image.remain,used:e.image.used,extraTotal:e.image.extra_total,extraRemain:e.image.extra_quota,period:e.image.period},reader:{total:e.embedding.count,remain:e.embedding.remain,used:e.embedding.used,period:e.embedding.period,limitSize:e.embedding.size}};if(Se(g),g.isVIP){let{autoTools:I,isDoneAutoToolsAction:l}=await kA.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);(I===void 0||I&&!I.includes("search"))&&!l&&F({autoTools:Gs.filter(c=>!c.isExperimental).map(c=>c.name),isDoneAutoToolsAction:!0})}else{let{autoTools:I}=await kA.default.storage.local.get("autoTools");typeof I<"u"&&F({autoTools:[]})}return g}async function Fg(e,t){let A=await ie("/v1/completion/email_summary",e,{method:"POST",signal:t});return lt("gpt-3.5",A),A}function Sg(e,t){return ie("/v1/completion/email_reply",e,{method:"POST",signal:t.signal},{onStream:A=>{A.done||lt("gpt-3.5",A.data),t.onStream(A)}})}var kg=[{version:"4.27.0",title:"Improved Context Menu and Artifacts",logContents:"xxxx",features:[{features:["Streamlined Context Menu: Cleaner, more intuitive interface for a smoother experience"]},{features:["Enhanced Translation:  Delivers related word meanings with contextual accuracy"]},{features:["Publish & Share Artifacts: Easily share your Artifacts publicly via direct links"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_27_0",notifyType:"modal"},{version:"4.26.0",title:"Gemini models just got smarter and faster!",logContents:"xxxx",features:[{features:["Gemini 1.5 Pro: Supercharged reasoning with enhanced math and visual skills."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_26_0",notifyType:"modal"},{version:"4.25.0",title:"Gemini models just got smarter and faster!",logContents:"xxxx",features:[{features:["Gemini 1.5 Pro: Supercharged reasoning with enhanced math and visual skills."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_25_0",notifyType:"modal"},{version:"4.24.0",title:"Gemini models just got smarter and faster!",features:[{features:["Gemini 1.5 Pro: Supercharged reasoning with enhanced math and visual skills."]},{features:["Gemini 1.5 Flash: 2x faster, 3x lower latency, better at visuals and coding."]}],notifyType:"modal"},{version:"4.23.0",title:"OpenAI o1-preview & o1-mini are available now!",features:[{features:["Multi-Model Translation: Use multiple models at once for more accurate translations."]},{features:["Versatile Translation Rewrites: Rewrite translations for different scenarios."]},{features:["Bilingual Subtitles: View YouTube subtitles in both languages simultaneously."]}],notifyType:"modal"},{version:"4.20.0",title:"Translation Features Upgrade",features:[{features:["Multi-Model Translation: Use multiple models at once for more accurate translations."]},{features:["Versatile Translation Rewrites: Rewrite translations for different scenarios."]},{features:["Bilingual Subtitles: View YouTube subtitles in both languages simultaneously."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_20_0",notifyType:"modal"},{version:"4.19.0",title:"Artifacts: Real-Time Content Preview",features:[{features:["Dedicated Windows: Preview documents, websites or charts in separate windows during chats."]},{features:["Interactive and Editable: Modify content directly using natural language."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_19_0",notifyType:"modal"},{version:"4.18.0",title:"Chat Sharing is Now Live!",features:[{features:["Multiple Formats: Share your chat as a link or an image."]},{features:["Flexible Selection: Select and share an entire conversation or just part of it."]},{features:["Easy Control: Revoke shared links anytime."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_18_0",notifyType:"modal"},{version:"4.17.0",title:"Introducing Watch Highlights for YouTube",features:[{features:["Video Highlights: AI-generated narration saves you time by quickly highlighting key video points."]},{features:["Natural Narration: Realistic AI voices enhance your viewing experience."]},{features:["Multi-language Support: Easily understand videos across language barriers."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_17_0",notifyType:"modal"},{version:"4.16.0",title:"",features:[{features:[""]},{features:[""]},{features:[""]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_16_0",notifyType:"modal"},{version:"4.13.0",title:"",features:[{features:[""]},{features:[""]},{features:[""]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_13_0",notifyType:"modal"},{version:"4.12.0",title:"Deep reader to boost your critical reading skills!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Enhanced Vision: Greatly improved image understanding"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_12_0",notifyType:"modal"},{version:"4.11.0",title:"Deep reader to boost your critical reading skills!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Expanded Languages: More languages, better quality, and faster performance"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_11_0",notifyType:"modal"},{version:"4.10.0",title:"OpenAI's GPT-4o is now here!",features:[{features:["Increased Speed: Get 2x faster responses than GPT-4"]},{features:["Enhanced Vision: Greatly improved image understanding"]},{features:["Expanded Languages: More languages, better quality, and faster performance"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-v4_10_0",notifyType:"modal"},{version:"4.9.0",title:"Llama 3 Now! The next generation of Meta's state-of-the-art open source LLM.",features:[{features:["<b>New Model:</b> Support Llama 3 now"]}],videoUrl:"",notifyType:"modal"},{version:"4.8.0",title:"In-Chat Video Summary, Subtitle Extraction, Claude 3 Haiku! \u{1F680}",features:[{features:["In-Chat Summary: Get key points of YouTube videos with 'Read this page' in the chat window."]},{features:["Easy Subtitle Extraction: Get subtitles with a single click on YouTube for deeper insights."]}],videoUrl:"",notifyType:"modal"},{version:"4.7.0",title:"In-Chat Video Summary, Subtitle Extraction, Claude 3 Haiku! \u{1F680}",features:[{features:["In-Chat Summary: Get key points of YouTube videos with 'Read this page' in the chat window."]},{features:["Easy Subtitle Extraction: Get subtitles with a single click on YouTube for deeper insights."]},{features:["Claude 3 Haiku: Now available to enrich your chat experience."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_7",notifyType:"modal"},{version:"4.6.0",features:[{features:['Claude 3 Opus: Claims to have "near-human" abilities and can beat GPT-4.']},{features:["Claude 3 Sonnet: Balances intelligence and speed, ideal for retrieving info or automating sales."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_6",notifyType:"modal"},{version:"4.5.0",features:[{features:["Search Agent Widget: Experience the future of search with AI automation"]},{features:["Translate webpage: More reader-friendly translation display styles"]},{features:["Supports automatically restoring the last chat on startup"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_5",notifyType:"modal"},{version:"4.4.0",title:"Easy Artistry with Painter Tool & GPT-4 context menu",features:[{features:["New Painter Tool: Create images instantly in chat."]},{features:["Enhanced Context Menu: Use GPT-4 in context menu."]},{features:["Enhanced Context Menu: Use GPT-4 in context menu."]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_4",notifyType:"modal"},{version:"4.3.0",title:"Maximize Your Experience with Full-Screen Mode!",features:[{features:["Dive into an immersive, full-screen view"]},{features:["Enjoy all sidebar features, now in Full-Screen"]},{features:["Seamlessly toggle between modes for the best of both worlds"]}],videoUrl:"https://sider.ai/whats-new/chrome-extension/Sider-V4_3",notifyType:"modal"},{version:"4.2.0",title:"More Efficient UI & Sidebar GPTs Access (Here is the video tutorial)",features:[{features:["Refreshed Interface: Cleaner and easier to navigate"]},{features:["Collapsible Navigation Bar: Ensures a focused chat experiencewhile keeping essential features within easy reach"]},{features:["Sidebar GPTs Access: For ChatGPT Plus users, direct access toGPTs is now available in the sidebar in web app mode"]}],notifyType:"modal"},{version:"4.1.0",features:[{title:"GPT-4V(ision) Preview! & AI reply for Gmail",features:["Sider Vision is powered by GPT-4V","Better understanding of images","Quickly grasp email intentions","Select from diverse tones and personas","Effortlessly pick reply suggestions"]}],notifyType:"modal"},{version:"4.0.0",features:[{title:"GPT-4 Turbo and Chat web page!",features:["Support GPT-4 Turbo and GPT-3.5 Turbo","Translate whole web page","Chat web page in the Sidebar","Chat PDF in the Sidebar"]}],notifyType:"modal"},{version:"3.6.0",features:[{title:"Translation widget",features:["Customize your translation in a dedicated Translation widget","Improve ChatGPT anwers in Google, Bing, Baidu etc"]}],notifyType:"modal"},{version:"3.5.0",features:[{title:"Sider Vision Became Smarter",features:["GPT-4/Claude 2 + Vision","1-click to answer the same question with different bots"]}],notifyType:"modal"},{version:"3.4.0",features:[{title:"Sider Grammar Widget",features:["Check grammar errors","Fix grammar errors","Improve the writing beyond grammar"]}],notifyType:"modal"},{version:"3.3.0",features:[{title:"Sider Vision \u2014 ChatGPT sidebar with Vision",features:["Extract text from an image","Ask any question about the image","3 ways to send image to Sider Vision<div><ol><li>Take a  screenshot</li><li>Drag & Drop an image to Chat window</li><li>Upload an image</li></ol></div>"]}],notifyType:"modal"},{version:"3.2.0",features:[{title:"New pricing plan with 5x more  GPT-4 queries",features:["Great news! Our updated pricing now gives you even more access to GPT-4 and Claude 2 queries.","If you're already a premium user, you'll be upgraded automatically. Plus, we've got a new 'Unlimited' plan for all you power users!"]}],notifyType:"modal"},{version:"3.1.0",features:[{title:"More bot!",features:["Support Bard now!"]},{title:"OCR: Extract text from any image and send it to ChatGPT",features:["Recognize 10+ major languages of printed materials","Recognize handwritten in English","Recognize math equation in the text"]},{title:"Improve Painter",features:["Replace the whole background","Remove selected area"]}],notifyType:"modal"},{version:"3.0.0",features:[{features:["More Chatbots: Now Supporting Claude-instant, Claude 2, and Bard!"]},{features:["Group Chat: Compare Answers Across Chatbots!"]},{features:["Mention: Tag Chatbots with '@'!"]},{features:["Quick Prompt: Just Type '/' and Go!"]},{features:["Simple Design: Streamlined for Speed!"]}],notifyType:"modal"},{version:"2.9.0",features:[{title:"Enhanced prompt manager for",features:["Reading context menu","Writing context menu"]},{title:"AI image editor",features:["Remove background from any images","Remove text from any images"]}],notifyType:"modal"},{version:"2.8.0",features:["Reading Assistant: Use AI for fast understanding while reading web pages","Writing Assistant: Quickly generate content with AI in the web input box"],notifyType:"modal"},{version:"2.7.0",features:["Draw picture from text","Draw picture from a reference picture"],notifyType:"modal"},{version:"2.6.0",features:["Sider Supports Fixed Sidebar - You can chat between all tabs without overlapping any content (available in Chrome 114 or later)"],notifyType:"modal"},{version:"2.5.0",features:["Youtube Summary! Watch 1 hour of YouTube video in 1 minute","Compare the answers provided by humans and AI on Q&A sites such as Quora, StackOverflow, and Zhihu"],notifyType:"modal"},{version:"2.4.0",features:["Smart web access: Based on your query, the Al will decide if it needs to access the web.","Stability improvement"],notifyType:"modal"},{version:"2.3.0",features:["Support Browsing and Plugins for Plus users!","ChatGPT with internet access for everyone!"],notifyType:"modal"},{version:"2.2.0",features:["Compose any message","Reply email, tweet, comment etc"],notifyType:"modal"},{version:"2.1.0",features:["Shortcut for Quick Lookup","Resize the Quick Lookup window","Bug fixes and other UX improvements"],notifyType:"modal"},{version:"2.0.0",features:["Support GPT-4 for all users!","Invite friends and gain GPT-4 queries for both of you!","Bug fixes and other UX improvements"],notifyType:"modal"},{version:"1.1.0",features:["Full Chat in the new tab!","ChatGPT, Bing, Bard together!","Bug fixes"],notifyType:"modal"},{version:"1.0.13",features:["Continue the chat after asking questions","Switch between GPT-4 and GPT-3.5 for Plus users","Easily access and search chat history"],notifyType:"modal"},{version:"1.0.12",features:["Sync extension settings across computers","Access your prompts from different laptops","Save chats for future use","Share chats via link"],notifyType:"modal"},{version:"1.0.11",features:["Quickly access actions through a pop-up window without opening the sidebar.","Add support for additional languages.","Retain the user's language preference when using the translation feature.","Resolve shortcut conflicts on platforms like GitHub and others."],notifyType:"modal"},{version:"1.0.10",features:["Support 50+ languages now!"],notifyType:"modal"},{version:"1.0.8",features:["Support GPT-4 for Plus users! Check settings page!"],notifyType:"modal"},{version:"1.0.7",features:["Remember prompt used last time","Optimize the position of the chatGPT panel on search pages","Add an option to put the sidebar in-page icon on the left side","Optimize package size","Add dark mode","Support your API url proxy"],notifyType:"modal"},{version:"1.0.6",features:["Improve summarize feature in Youtube page"],notifyType:"modal"},{version:"1.0.5",features:["Remember the location of sidebar in\u2013age icon","Improve shortcuts","Save prompt templates from the sidebar directly"]},{version:"1.0.4",features:["Re-order prompt items in the dropdown list","Archive prompt items you will not use","Support response in 50+ languages"]},{version:"1.0.3",features:["CMD/Ctrl + Enter to do quick \u201CSubmit\u201D","Option to hide panel in the search results page","Support ESC to hide sidebar","Support summarize long article"]},{version:"1.0.2",features:["Add stop button to stop generating response","Change the place of collapse button"]},{version:"1.0.1",features:["Improve summarize feature in Youtube page","Fix some bugs related to copy/paste and print"]}];var xg=U(K());var $d=864e5;var EN=$d*30;var eC=6e3;async function tC(e=!1,t){if(H.setUserStatus({fiveStarRated:!0}),e)ve.report("rate_feedback_total"),ve.report(`rate_feedback_${t}`);else{let{__five_star_rate_from__:A}=await M({__five_star_rate_from__:""});ve.report("rate_total"),ve.report(`rate_${A}`)}Ae(["__five_star_rate_checking__","__five_star_rate_checking_timer__","__five_star_rate_show_at__","__five_star_rate_show_count__","__five_star_rate_less_show__","__five_star_rate_from__"])}async function bg(e){let{__five_star_rate_checking__:t,__five_star_rate_checking_timer__:A,userStatus:i}=await M({__five_star_rate_checking__:!1,__five_star_rate_checking_timer__:0,userStatus:{fiveStarRated:!1}});if(i?.fiveStarRated||!t)return;let r=await xg.default.tabs.get(e),o=r.pendingUrl||r.url;if(o)if(AC(o)){A&&clearTimeout(A);let n=setTimeout(()=>{tC()},eC);F({__five_star_rate_checking_timer__:n})}else A&&clearTimeout(A)}function AC(e){return new RegExp(`^https://.+?/detail/.+?/${dA}${ge?"":"/reviews"}`,"g").test(e)}var Ui=class e{constructor(t,A,i,r){this.db=null;this.dbName="";this.storeName="";this.dbMapKey="";this.idbMapKey="";if(this.dbMapKey=`${t}_${r||1}`,this.idbMapKey=`${t}_${A}`,e.IDB_MAP[this.idbMapKey])return e.IDB_MAP[this.idbMapKey];e.IDB_MAP[this.idbMapKey]=this,this.dbName=t,this.storeName=A,this.onUpgrade=i.onUpgrade,this.onError=i.onError,this.version=r}static{this.DB_MAP={}}static{this.IDB_MAP={}}async openDB(){let{dbName:t,version:A,onUpgrade:i,onError:r}=this;return e.DB_MAP[this.dbMapKey]?e.DB_MAP[this.dbMapKey]:new Promise((o,n)=>{let a=indexedDB.open(t,A);a.onerror=s=>{n(s)},a.onblocked=s=>{n(s)},a.onupgradeneeded=s=>{i(a.result,s)},a.onsuccess=()=>{let s=a.result;this.db=e.DB_MAP[this.dbMapKey]=s,s.onerror=g=>{r?.(g)},s.onversionchange=()=>{s.close(),this.db=null,delete e.DB_MAP[this.dbMapKey]},o(s)}})}async removeDB(){let t=indexedDB.deleteDatabase(this.dbName);return new Promise((A,i)=>{t.onerror=r=>{i(r)},t.onblocked=r=>{i(r)},t.onsuccess=()=>{A(!0)}})}async transactionAction(t,A){this.db||(this.db=await this.openDB());let i=this.db.transaction(this.storeName,A).objectStore(this.storeName);return new Promise((r,o)=>{let n=t(i);n.onerror=o,n.onsuccess=()=>r(n.result)})}getData(t){return this.transactionAction(A=>A.get(t))}addData(t,A){return this.transactionAction(i=>i.add(t,A),"readwrite")}setData(t,A){return this.transactionAction(i=>i.put(t,A),"readwrite")}deleteData(t){return this.transactionAction(A=>A.delete(t),"readwrite")}clearData(){return this.transactionAction(t=>t.clear(),"readwrite")}};function Ng(e){return new Ui("CACHE",e,{onUpgrade(t){try{t.createObjectStore("TRANSLATION_CACHE",{keyPath:"key"})}catch{}try{t.createObjectStore("DEMO_TTS_CACHE ",{keyPath:"key"})}catch{}}},2)}function Gg(){return Ng("TRANSLATION_CACHE")}function eo(){return Ng("DEMO_TTS_CACHE ")}var ao=U(Qe()),ft=U(K());var Lg=U(Qe()),CC=U(K());async function mC(e=he.English){let t=await ce(),A=navigator.userAgentData?.platform||"Unknown";A=A.replace(" ",""),A=A.slice(0,1).toUpperCase()+A.slice(1);let i=ct(Y.api,`/v1/app/promotion/promote_config?app_name=${hi}&app_version=${ae}&language=${e}&device_name=${A}`),r={data:[],resources:{}};try{let o=await ut(),n=await fetch(i,{headers:{Authorization:o.token}}).then(a=>a.json());!("resources"in n)&&"resources"in n.data&&(n=n.data),r.data=n.data.map(a=>({...a})),r.resources=n.resources}catch{}return r}function no(e,t){return e&&e.replace(/{{\s*([^{{}}]+)\s*}}/g,(A,i)=>{if(i.includes(",")){let[r,o,n,a]=i.split(/\s*,\s*/);i=t[r]===o?n:a}return i?t[i]||i:""})}function Yg(e,t){return e&&Object.fromEntries(Object.entries(e).map(([A,i])=>[A,no(i,t)]))}function hC(e,t){return t?t.every(A=>e.includes(A)):!0}function EC(e){return(ft.default.storage.session||ft.default.storage.local).get(e)}async function yC(){let e=ft.default.storage.session||ft.default.storage.local,t=await EC({__promote_config__:{config:{data:[],resources:{}},timeStamp:0,maxAge:3e3},__promote_variants__:{}}),A=Date.now(),{__promote_variants__:i,language:r,isCNUser:o,userInfo:n,vipInfo:a,provider:s}=await M({language:he.English,__promote_variants__:{},provider:"siderApi",isCNUser:!1,userInfo:{id:"",avatar:"",nickname:"",email:"",phone:""},vipInfo:{userTypeDetail:"login"}}),g=t.__promote_config__,I=g?.maxAge||3e3,l=g.config;if(!l||A-g?.timeStamp>I){l=await mC(r);let p=1e3*60*30;try{e.set({__promote_config__:{config:l,timeStamp:A,maxAge:p}})}catch{}}let c=navigator.userAgentData?.platform,u=a?.userTypeDetail||"login",m={lang:r,browser:ge?"edge":"chrome",__LANG__:r,__BROWSER__:ge?"edge":"chrome",__PLATFORM__:c,__VERSION__:ae,__IS_CN_USER__:o?"1":"0",__USER_PLAN__:Ss[u],__USER_ID__:n.id,__USER_NAME__:n.nickname,__USER_AVATAR__:n.avatar,__USER_EMAIL__:n.email,__USER_PHONE__:n.phone},y=[c,ge?"edge_ext":"chrome_ext",u,["device","login"].includes(u)?"free":"paid",u=="device"?"unregistered":"registered",r,s],{__promote_off__:C}=await M({__promote_off__:{}}),w={};for(let p of l.data){let f=p.activityId||p.slot;if(C&&p.key in C)continue;let d=typeof p.startAt=="number"?p.startAt:Date.parse(p.startAt),B=typeof p.stopAt=="number"?p.stopAt:Date.parse(p.stopAt);d>A||B<A||hC(y,p.condition)&&(w[f]||(w[f]=[]),w[f].push(p))}let x={...m,...Yg({...l.resources._,...l.resources.en,...l.resources[r]},m)},N={};for(let p of Object.values(w)){if(p.length==0)continue;let f=p[0].key,d=p[0].persistent,B=i[f]||t.__promote_variants__[f];if(!isFinite(B)&&(B=Math.floor(Math.random()*100),d)){let b=d=="session"&&ft.default.storage.session?"session":"local";ft.default.storage[b].set({__promote_variants__:{...b=="session"?t.__promote_variants__:i,[f]:B}})}let D=p.find(b=>B<=b.allocation);p.length==1&&p[0]?.allocation==null&&(D=p[0]),D&&(D.content=no(D.content,x),D.style=D.style?no(D.style,x):"",D.payload=Yg(D.payload,x),N[D.slot]=D)}let E=Object.fromEntries(Object.entries(N).map(([p,f])=>[p,{key:f.key,startAt:f.startAt,stopAt:f.stopAt}]));return await ft.default.storage.local.set({__promote_schedule__:E}),N}var vi;async function Vg(){return vi||(vi=yC().finally(()=>{vi=null}))}function zg(e,t){let A=e.key;A&&M({[A]:null}).then(i=>{let r=i[A]||{},o=e.host,n=e.favicon;try{o=o||new URL(t.url||"").host,n=n||t.tab?.favIconUrl||t.url+"/favicon.ico"}catch{}if(!o||o==="undefined")return;let a=e.enable;return a?delete r[o]:r={...r,[o]:{favicon:n,enable:a}},Object.entries(r).forEach(([s,g])=>{(s==="undefined"||g.enable)&&delete r[s]}),F({[A]:r})})}var Te=U(K());async function Wg({prompt:e,windowId:t}){let i=(await Te.default.tabs.query({url:"https://chat.openai.com/chat*",windowId:t}))[0];i||(i=await Te.default.tabs.create({active:!0,url:"https://chat.openai.com",windowId:t}),await new Promise(r=>{let o=(n,a,s)=>{n==i.id&&a.status=="complete"&&(r(),Te.default.tabs.onUpdated.removeListener(o))};Te.default.tabs.onUpdated.addListener(o)})),Te.default.tabs.update(i.id,{active:!0}),Te.default.tabs.sendMessage(i.id,{type:"automate-send-prompt",prompt:e}),await new Promise(r=>{let o=0,n=(a,s)=>{if(s.tab?.id===i.id)switch(a.type){case"loaded":o+=1,o<2&&Te.default.tabs.sendMessage(i.id,{type:"automate-send-prompt",prompt:e});return;case"automate-send-prompt-done":Te.default.runtime.onMessage.removeListener(n),r();return}};Te.default.runtime.onMessage.addListener(n),setTimeout(r,1e3*60)})}var kI=U(go()),oe=U(K());var pI=U(go());function UA(e,t,A,i){function r(o){return o instanceof A?o:new A(function(n){n(o)})}return new(A||(A=Promise))(function(o,n){function a(I){try{g(i.next(I))}catch(l){n(l)}}function s(I){try{g(i.throw(I))}catch(l){n(l)}}function g(I){I.done?o(I.value):r(I.value).then(a,s)}g((i=i.apply(e,t||[])).next())})}var X=class{constructor(){this.mutex=Promise.resolve()}lock(){let t=()=>{};return this.mutex=this.mutex.then(()=>new Promise(t)),new Promise(A=>{t=A})}dispatch(t){return UA(this,void 0,void 0,function*(){let A=yield this.lock();try{return yield Promise.resolve(t())}finally{A()}})}},Io;function SC(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global}var uo=SC(),co=(Io=uo.Buffer)!==null&&Io!==void 0?Io:null,kC=uo.TextEncoder?new uo.TextEncoder:null;function aI(e,t){return(e&15)+(e>>6|e>>3&8)<<4|(t&15)+(t>>6|t>>3&8)}function xC(e,t){let A=t.length>>1;for(let i=0;i<A;i++){let r=i<<1;e[i]=aI(t.charCodeAt(r),t.charCodeAt(r+1))}}function bC(e,t){if(e.length!==t.length*2)return!1;for(let A=0;A<t.length;A++){let i=A<<1;if(t[A]!==aI(e.charCodeAt(i),e.charCodeAt(i+1)))return!1}return!0}var tI=87,AI=48;function iI(e,t,A){let i=0;for(let r=0;r<A;r++){let o=t[r]>>>4;e[i++]=o>9?o+tI:o+AI,o=t[r]&15,e[i++]=o>9?o+tI:o+AI}return String.fromCharCode.apply(null,e)}var rI=co!==null?e=>{if(typeof e=="string"){let t=co.from(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.length)}if(co.isBuffer(e))return new Uint8Array(e.buffer,e.byteOffset,e.length);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")}:e=>{if(typeof e=="string")return kC.encode(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Invalid data type!")},oI="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",GA=new Uint8Array(256);for(let e=0;e<oI.length;e++)GA[oI.charCodeAt(e)]=e;function NC(e){let t=Math.floor(e.length*.75),A=e.length;return e[A-1]==="="&&(t-=1,e[A-2]==="="&&(t-=1)),t}function GC(e){let t=NC(e),A=e.length,i=new Uint8Array(t),r=0;for(let o=0;o<A;o+=4){let n=GA[e.charCodeAt(o)],a=GA[e.charCodeAt(o+1)],s=GA[e.charCodeAt(o+2)],g=GA[e.charCodeAt(o+3)];i[r]=n<<2|a>>4,r+=1,i[r]=(a&15)<<4|s>>2,r+=1,i[r]=(s&3)<<6|g&63,r+=1}return i}var Ti=16*1024,bA=4,UC=new X,lo=new Map;function MC(e,t){return UA(this,void 0,void 0,function*(){let A=null,i=null,r=!1;if(typeof WebAssembly>"u")throw new Error("WebAssembly is not supported in this environment!");let o=(f,d=0)=>{i.set(f,d)},n=()=>i,a=()=>A.exports,s=f=>{A.exports.Hash_SetMemorySize(f);let d=A.exports.Hash_GetBuffer(),B=A.exports.memory.buffer;i=new Uint8Array(B,d,f)},g=()=>new DataView(A.exports.memory.buffer).getUint32(A.exports.STATE_SIZE,!0),I=UC.dispatch(()=>UA(this,void 0,void 0,function*(){if(!lo.has(e.name)){let d=GC(e.data),B=WebAssembly.compile(d);lo.set(e.name,B)}let f=yield lo.get(e.name);A=yield WebAssembly.instantiate(f,{})})),l=()=>UA(this,void 0,void 0,function*(){A||(yield I);let f=A.exports.Hash_GetBuffer(),d=A.exports.memory.buffer;i=new Uint8Array(d,f,Ti)}),c=(f=null)=>{r=!0,A.exports.Hash_Init(f)},u=f=>{let d=0;for(;d<f.length;){let B=f.subarray(d,d+Ti);d+=B.length,i.set(B),A.exports.Hash_Update(B.length)}},m=f=>{if(!r)throw new Error("update() called before init()");let d=rI(f);u(d)},y=new Uint8Array(t*2),C=(f,d=null)=>{if(!r)throw new Error("digest() called before init()");return r=!1,A.exports.Hash_Final(d),f==="binary"?i.slice(0,t):iI(y,i,t)},w=()=>{if(!r)throw new Error("save() can only be called after init() and before digest()");let f=A.exports.Hash_GetState(),d=g(),B=A.exports.memory.buffer,D=new Uint8Array(B,f,d),b=new Uint8Array(bA+d);return xC(b,e.hash),b.set(D,bA),b},x=f=>{if(!(f instanceof Uint8Array))throw new Error("load() expects an Uint8Array generated by save()");let d=A.exports.Hash_GetState(),B=g(),D=bA+B,b=A.exports.memory.buffer;if(f.length!==D)throw new Error(`Bad state length (expected ${D} bytes, got ${f.length})`);if(!bC(e.hash,f.subarray(0,bA)))throw new Error("This state was written by an incompatible hash implementation");let S=f.subarray(bA);new Uint8Array(b,d,B).set(S),r=!0},N=f=>typeof f=="string"?f.length<Ti/4:f.byteLength<Ti,E=N;switch(e.name){case"argon2":case"scrypt":E=()=>!0;break;case"blake2b":case"blake2s":E=(f,d)=>d<=512&&N(f);break;case"blake3":E=(f,d)=>d===0&&N(f);break;case"xxhash64":case"xxhash3":case"xxhash128":E=()=>!1;break}let p=(f,d=null,B=null)=>{if(!E(f,d))return c(d),m(f),C("hex",B);let D=rI(f);return i.set(D),A.exports.Hash_Calculate(D.length,d,B),iI(y,i,t)};return yield l(),{getMemory:n,writeMemory:o,getExports:a,setMemorySize:s,init:c,update:m,digest:C,save:w,load:x,calculate:p,hashLength:t}})}function HC(e,t,A){return UA(this,void 0,void 0,function*(){let i=yield e.lock(),r=yield MC(t,A);return i(),r})}var _N=new X;var JN=new X;var PN=new DataView(new ArrayBuffer(4));var KN=new X;var ON=new X;var LN=new X;var YN=new X;var VN=new X;var zN=new X;var WN=new X;var RC="sha3",vC="AGFzbQEAAAABFARgAAF/YAF/AGACf38AYAN/f38AAwgHAAEBAgEAAwUEAQECAgYOAn8BQZCNBQt/AEGACAsHcAgGbWVtb3J5AgAOSGFzaF9HZXRCdWZmZXIAAAlIYXNoX0luaXQAAQtIYXNoX1VwZGF0ZQACCkhhc2hfRmluYWwABA1IYXNoX0dldFN0YXRlAAUOSGFzaF9DYWxjdWxhdGUABgpTVEFURV9TSVpFAwEKqBwHBQBBgAoL1wMAQQBCADcDgI0BQQBCADcD+IwBQQBCADcD8IwBQQBCADcD6IwBQQBCADcD4IwBQQBCADcD2IwBQQBCADcD0IwBQQBCADcDyIwBQQBCADcDwIwBQQBCADcDuIwBQQBCADcDsIwBQQBCADcDqIwBQQBCADcDoIwBQQBCADcDmIwBQQBCADcDkIwBQQBCADcDiIwBQQBCADcDgIwBQQBCADcD+IsBQQBCADcD8IsBQQBCADcD6IsBQQBCADcD4IsBQQBCADcD2IsBQQBCADcD0IsBQQBCADcDyIsBQQBCADcDwIsBQQBCADcDuIsBQQBCADcDsIsBQQBCADcDqIsBQQBCADcDoIsBQQBCADcDmIsBQQBCADcDkIsBQQBCADcDiIsBQQBCADcDgIsBQQBCADcD+IoBQQBCADcD8IoBQQBCADcD6IoBQQBCADcD4IoBQQBCADcD2IoBQQBCADcD0IoBQQBCADcDyIoBQQBCADcDwIoBQQBCADcDuIoBQQBCADcDsIoBQQBCADcDqIoBQQBCADcDoIoBQQBCADcDmIoBQQBCADcDkIoBQQBCADcDiIoBQQBCADcDgIoBQQBBwAwgAEEBdGtBA3Y2AoyNAUEAQQA2AoiNAQuMAwEIfwJAQQAoAoiNASIBQQBIDQBBACABIABqQQAoAoyNASICcDYCiI0BAkACQCABDQBBgAohAwwBCwJAIAIgAWsiBCAAIAQgAEkbIgNFDQAgA0EDcSEFQQAhBgJAIANBBEkNACABQYCKAWohByADQXxxIQhBACEGA0AgByAGaiIDQcgBaiAGQYAKai0AADoAACADQckBaiAGQYEKai0AADoAACADQcoBaiAGQYIKai0AADoAACADQcsBaiAGQYMKai0AADoAACAIIAZBBGoiBkcNAAsLIAVFDQAgAUHIiwFqIQMDQCADIAZqIAZBgApqLQAAOgAAIAZBAWohBiAFQX9qIgUNAAsLIAQgAEsNAUHIiwEgAhADIAAgBGshACAEQYAKaiEDCwJAIAAgAkkNAANAIAMgAhADIAMgAmohAyAAIAJrIgAgAk8NAAsLIABFDQBBACECQcgBIQYDQCAGQYCKAWogAyAGakG4fmotAAA6AAAgBkEBaiEGIAAgAkEBaiICQf8BcUsNAAsLC+QLAS1+IAApA0AhAkEAKQPAigEhAyAAKQM4IQRBACkDuIoBIQUgACkDMCEGQQApA7CKASEHIAApAyghCEEAKQOoigEhCSAAKQMgIQpBACkDoIoBIQsgACkDGCEMQQApA5iKASENIAApAxAhDkEAKQOQigEhDyAAKQMIIRBBACkDiIoBIREgACkDACESQQApA4CKASETQQApA8iKASEUAkACQCABQcgASw0AQQApA9CKASEVQQApA+CKASEWQQApA9iKASEXDAELQQApA+CKASAAKQNghSEWQQApA9iKASAAKQNYhSEXQQApA9CKASAAKQNQhSEVIBQgACkDSIUhFCABQekASQ0AQQBBACkD6IoBIAApA2iFNwPoigFBAEEAKQPwigEgACkDcIU3A/CKAUEAQQApA/iKASAAKQN4hTcD+IoBQQBBACkDgIsBIAApA4ABhTcDgIsBIAFBiQFJDQBBAEEAKQOIiwEgACkDiAGFNwOIiwELIAMgAoUhGCAFIASFIRkgByAGhSEHIAkgCIUhCCALIAqFIRogDSAMhSEJIA8gDoUhCiARIBCFIQsgEyAShSEMQQApA7iLASESQQApA5CLASETQQApA+iKASEbQQApA6CLASEcQQApA/iKASENQQApA7CLASEdQQApA4iLASEOQQApA8CLASEPQQApA5iLASEeQQApA/CKASEQQQApA6iLASERQQApA4CLASEfQcB+IQADQCAaIAcgC4UgF4UgH4UgEYVCAYmFIBSFIBCFIB6FIA+FIQIgDCAZIAqFIBaFIA6FIB2FQgGJhSAIhSAVhSANhSAchSIDIAeFISAgCSAIIAyFIBWFIA2FIByFQgGJhSAYhSAbhSAThSAShSIEIA+FISEgGCAKIBQgGoUgEIUgHoUgD4VCAYmFIBmFIBaFIA6FIB2FIgWFQjeJIiIgCyAYIAmFIBuFIBOFIBKFQgGJhSAHhSAXhSAfhSARhSIGIAqFQj6JIiNCf4WDIAMgEYVCAokiJIUhDyANIAKFQimJIiUgBCAQhUIniSImQn+FgyAihSERIBIgBYVCOIkiEiAGIA6FQg+JIidCf4WDIAMgF4VCCokiKIUhDiAEIBqFQhuJIikgKCAIIAKFQiSJIipCf4WDhSENIAYgGYVCBokiKyADIAuFQgGJIixCf4WDIBwgAoVCEokiLYUhECArIAQgHoVCCIkiLiAbIAWFQhmJIhtCf4WDhSEXIAYgHYVCPYkiGSAEIBSFQhSJIgQgCSAFhUIciSIIQn+Fg4UhFCAIIBlCf4WDIAMgH4VCLYkiA4UhGCAZIANCf4WDIBUgAoVCA4kiCYUhGSAEIAMgCUJ/hYOFIQcgCSAEQn+FgyAIhSEIIAwgAoUiAiAhQg6JIgNCf4WDIBMgBYVCFYkiBIUhCSAGIBaFQiuJIgUgAyAEQn+Fg4UhCiAEIAVCf4WDICBCLIkiBIUhCyAAQdAJaikDACAFIARCf4WDhSAChSEMICcgKEJ/hYMgKoUiBSEfIAMgBCACQn+Fg4UiAiEaICogKUJ/hYMgEoUiAyEeIC0gLkJ/hYMgG4UiBCEWICYgJCAlQn+Fg4UiBiEdIBsgK0J/hYMgLIUiKCEVICMgJiAiQn+Fg4UiIiEcIC4gLCAtQn+Fg4UiJiEbICcgKSASQn+Fg4UiJyETICMgJEJ/hYMgJYUiIyESIABBCGoiAA0AC0EAIBE3A6iLAUEAIAU3A4CLAUEAIBc3A9iKAUEAIAc3A7CKAUEAIAs3A4iKAUEAIA83A8CLAUEAIAM3A5iLAUEAIBA3A/CKAUEAIBQ3A8iKAUEAIAI3A6CKAUEAIAY3A7CLAUEAIA43A4iLAUEAIAQ3A+CKAUEAIBk3A7iKAUEAIAo3A5CKAUEAICI3A6CLAUEAIA03A/iKAUEAICg3A9CKAUEAIAg3A6iKAUEAIAw3A4CKAUEAICM3A7iLAUEAICc3A5CLAUEAICY3A+iKAUEAIBg3A8CKAUEAIAk3A5iKAQv4AgEFf0HkAEEAKAKMjQEiAUEBdmshAgJAQQAoAoiNASIDQQBIDQAgASEEAkAgASADRg0AIANByIsBaiEFQQAhAwNAIAUgA2pBADoAACADQQFqIgMgAUEAKAKIjQEiBGtJDQALCyAEQciLAWoiAyADLQAAIAByOgAAIAFBx4sBaiIDIAMtAABBgAFyOgAAQciLASABEANBAEGAgICAeDYCiI0BCwJAIAJBBEkNACACQQJ2IgNBA3EhBUEAIQQCQCADQX9qQQNJDQAgA0H8////A3EhAUEAIQNBACEEA0AgA0GACmogA0GAigFqKAIANgIAIANBhApqIANBhIoBaigCADYCACADQYgKaiADQYiKAWooAgA2AgAgA0GMCmogA0GMigFqKAIANgIAIANBEGohAyABIARBBGoiBEcNAAsLIAVFDQAgBUECdCEBIARBAnQhAwNAIANBgApqIANBgIoBaigCADYCACADQQRqIQMgAUF8aiIBDQALCwsGAEGAigEL0QYBA39BAEIANwOAjQFBAEIANwP4jAFBAEIANwPwjAFBAEIANwPojAFBAEIANwPgjAFBAEIANwPYjAFBAEIANwPQjAFBAEIANwPIjAFBAEIANwPAjAFBAEIANwO4jAFBAEIANwOwjAFBAEIANwOojAFBAEIANwOgjAFBAEIANwOYjAFBAEIANwOQjAFBAEIANwOIjAFBAEIANwOAjAFBAEIANwP4iwFBAEIANwPwiwFBAEIANwPoiwFBAEIANwPgiwFBAEIANwPYiwFBAEIANwPQiwFBAEIANwPIiwFBAEIANwPAiwFBAEIANwO4iwFBAEIANwOwiwFBAEIANwOoiwFBAEIANwOgiwFBAEIANwOYiwFBAEIANwOQiwFBAEIANwOIiwFBAEIANwOAiwFBAEIANwP4igFBAEIANwPwigFBAEIANwPoigFBAEIANwPgigFBAEIANwPYigFBAEIANwPQigFBAEIANwPIigFBAEIANwPAigFBAEIANwO4igFBAEIANwOwigFBAEIANwOoigFBAEIANwOgigFBAEIANwOYigFBAEIANwOQigFBAEIANwOIigFBAEIANwOAigFBAEHADCABQQF0a0EDdjYCjI0BQQBBADYCiI0BIAAQAkHkAEEAKAKMjQEiAEEBdmshAwJAQQAoAoiNASIBQQBIDQAgACEEAkAgACABRg0AIAFByIsBaiEFQQAhAQNAIAUgAWpBADoAACABQQFqIgEgAEEAKAKIjQEiBGtJDQALCyAEQciLAWoiASABLQAAIAJyOgAAIABBx4sBaiIBIAEtAABBgAFyOgAAQciLASAAEANBAEGAgICAeDYCiI0BCwJAIANBBEkNACADQQJ2IgFBA3EhBUEAIQQCQCABQX9qQQNJDQAgAUH8////A3EhAEEAIQFBACEEA0AgAUGACmogAUGAigFqKAIANgIAIAFBhApqIAFBhIoBaigCADYCACABQYgKaiABQYiKAWooAgA2AgAgAUGMCmogAUGMigFqKAIANgIAIAFBEGohASAAIARBBGoiBEcNAAsLIAVFDQAgBUECdCEAIARBAnQhAQNAIAFBgApqIAFBgIoBaigCADYCACABQQRqIQEgAEF8aiIADQALCwsL2AEBAEGACAvQAZABAAAAAAAAAAAAAAAAAAABAAAAAAAAAIKAAAAAAAAAioAAAAAAAIAAgACAAAAAgIuAAAAAAAAAAQAAgAAAAACBgACAAAAAgAmAAAAAAACAigAAAAAAAACIAAAAAAAAAAmAAIAAAAAACgAAgAAAAACLgACAAAAAAIsAAAAAAACAiYAAAAAAAIADgAAAAAAAgAKAAAAAAACAgAAAAAAAAIAKgAAAAAAAAAoAAIAAAACAgYAAgAAAAICAgAAAAAAAgAEAAIAAAAAACIAAgAAAAIA=",TC="f2f6f5b2",qC={name:RC,data:vC,hash:TC},_C=new X,NA=null;function nI(e){return[224,256,384,512].includes(e)?null:new Error("Invalid variant! Valid values: 224, 256, 384, 512")}function sI(e,t=512){if(nI(t))return Promise.reject(nI(t));let A=t/8;if(NA===null||NA.hashLength!==A)return HC(_C,qC,A).then(i=>(NA=i,NA.calculate(e,t,6)));try{let i=NA.calculate(e,t,6);return Promise.resolve(i)}catch(i){return Promise.reject(i)}}var XN=new X;var ZN=new X;var jN=new X;var $N=new X;var eG=new X;var tG=new X;var AG=new X;var iG=new ArrayBuffer(8);var rG=new X;var oG=new ArrayBuffer(8);var nG=new X;var aG=new ArrayBuffer(8);var sG=new X;var gG=new X;var IG=new X;var Bt=U(K());var gI=["text/x-java","text/javascript","text/html","text/x-c++","application/msword","text/x-csharp","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/pdf","text/x-script.python","text/x-c","text/x-tex","application/json","text/markdown","application/vnd.openxmlformats-officedocument.presentationml.presentation","text/x-ruby","text/x-sh","text/x-php","application/x-latext","text/x-typescript","text/plain"];var qi=class{constructor(){this.results=[];this.isBrowsing=!1}parseMessage(t){let A=t.message,i=this.results.findIndex(r=>r.id===A?.id);return A&&(A.author.role==="assistant"?this.handleAssistantMessage(A,i):A.author.role==="tool"&&(A.author.name==="browser"||A.author.name==="myfiles_browser"?this.handleBrowserMessage(A):this.handlePluginResponseMessage(A))),this.results}handleAssistantMessage(t,A){if(t.recipient!=="all")if(t.recipient!=="browser"&&t.recipient!=="myfiles_browser")if(A===-1){let i=this.results[this.results.length-1];if(i&&i.type==="browsing"){let r=i;r.isLoading=!1,r.actions.push({messageId:"1",command:"finishBrowsing"}),this.isBrowsing=!1}this.results.push({id:t?.id,type:"plugin",pluginName:t?.recipient,isLoading:!0,info:[{type:"request",text:t?.content?.parts?.[0]||t?.content?.text}]})}else{let i=this.results[A];i.info[0].text=t?.content?.parts?.[0]||t?.content?.text}else this.isBrowsing||(this.results.push({id:t?.id,type:"browsing",subType:t?.recipient==="myfiles_browser"?"myfiles":"web",isLoading:!0,actions:[{messageId:"0",command:"startBrowsing",model_slug:t.metadata?.model_slug||""}]}),this.isBrowsing=!0);else if(A===-1)this.handleNewTextMessage(t);else{let i=this.results[A],r=this.getTextWithCitations(t);i.text=r.text,i.searchSnippets=r.searchSnippets}}handleBrowserMessage(t){if(this.isBrowsing){let A=this.results[this.results.length-1];if(A.type==="browsing"){let i=A,r=t.metadata;(i.actions.length===0||r.command!==i.actions[i.actions.length-1].command||i.actions[i.actions.length-1].messageId!==t?.id)&&(r.command!=="quote_lines"||i.actions[i.actions.length-1].command!=="quote_lines")?(r.command==="search"||r.command==="click"||r.command==="quote_lines"&&i.subType==="web")&&i.actions.push({messageId:t?.id,command:r.command,model_slug:r.model_slug,status:r.status,args:r.args,_cite_metadata:r.command==="click"?this.getClickMetadata(r._cite_metadata):{}}):(i.actions[i.actions.length-1].status=r.status,(r.command==="click"||r.command==="quote_lines")&&(i.actions[i.actions.length-1]._cite_metadata=this.getClickMetadata(r._cite_metadata)))}}}handlePluginResponseMessage(t){let A=this.results[this.results.length-1];A&&(A.isLoading=!1);let i=null;if(t?.author?.name==="python"?i=JSON.stringify(t.content):t?.author?.name==="dalle.text2im"?typeof t?.content?.parts?.[0]!="string"&&(i=t?.content?.text):i=t?.content?.parts?.[0],i&&A&&A.info.push({type:"response",text:i}),t?.author?.name==="dalle.text2im"){let r=t?.content?.parts?.[0];typeof r=="object"&&r.asset_pointer&&this.results.push({id:r.asset_pointer.replace("file-service://",""),type:"image",gen_id:r?.metadata?.dalle?.gen_id,prompt:r?.metadata?.dalle?.prompt})}else t?.metadata?.jit_plugin_data?.from_server.type==="confirm_action"&&this.results.push({id:t?.id,type:"pluginConfirm",metadata:t?.metadata?.jit_plugin_data?.from_server.body})}handleNewTextMessage(t){if(this.results.length>0){let A=this.results[this.results.length-1];if(A.type==="browsing"){let i=A;i.isLoading=!1,i.actions.push({messageId:"1",command:"finishBrowsing"}),this.isBrowsing=!1}}t?.content?.parts?.[0]&&this.results.push({id:t?.id,type:"text",text:t?.content?.parts?.[0]})}getClickMetadata(t){return{metadata_list:[{url:t?.metadata_list?.[0]?.url,title:t?.metadata_list?.[0]?.title}]}}getTextWithCitations(t){let A=t?.content?.parts?.[0],i=t?.metadata?.citations,r={};if(i&&i.length>0){let o=A,n=i.length;return i.sort((a,s)=>s.end_ix-a.end_ix).forEach((a,s)=>{let g=a.start_ix,I=a.end_ix,l=a.metadata?.url;l?(o=o.slice(0,g)+`[^${n-s}](${l})`+o.slice(I),r[n-s]={link:l,title:a.metadata.title,snippet:a.metadata.text}):o=o.slice(0,g)+o.slice(I)}),{text:o,searchSnippets:r}}else return{text:A}}};async function eA(e,t,A=!1,i=!1){let{onMessage:r,...o}=t,a=await(A?tA:fetch)(e,o).catch(g=>{throw jt(g,e),g});if(!a.ok){let g=await a.json().catch(()=>({}));throw new Error(uA(g)?`${a.status} ${a.statusText}`:JSON.stringify({...g,responseStatus:a.status}))}let s=Wt(g=>{g.type==="event"&&r(g.data)});for await(let g of Xt(a.body)){let I=new TextDecoder().decode(g);if(i)try{if(JSON.parse(I).wss_url){r(I);return}}catch{}s.feed(I)}}var II=U(K());async function JC(e,t){return II.default.runtime.sendMessage({type:"getArkoseToken",target:"offscreen",userType:e,dx:t})}async function cI(e,t){return JC(e,t)}var xe="ChatGPT Webapp",po=`${xe}: error_chatgpt_auth`,Pi="https://chatgpt.com",fo="accessToken",Bo=new pI.default(10*1e3);async function pe(e,t,A,i){let r={"Content-Type":"application/json"};e&&(r.Authorization=`Bearer ${e}`),r={...r,...await FI()};let o={method:t,headers:r};return i&&(o.body=JSON.stringify(i)),tA(`${Pi}/backend-api${A}`,o)}async function dI(e,t){await pe(e,"POST","/conversation/message_feedback",t)}async function lI(e,t,A){return!0}async function CI(e){let t=await le({isForce:!0});return pe(t,"GET","/models",null).then(A=>A.json())}async function QI(e){let t=await le({isForce:!0});return pe(t,"GET","/gizmos/bootstrap?limit=2",null).then(A=>A.json()).catch(A=>({gizmos:[]}))}async function uI(e,t){let A=await le({isForce:!0});return pe(A,"POST","/conversation/gen_title/"+e,{message_id:t}).then(i=>i.json())}function PC(){return[navigator.hardwareConcurrency+1920+1080,new Date().toString(),4294705152,0,navigator.userAgent,"","",navigator.language,navigator.languages.join(","),0]}async function mI(e,t){let A=performance.now(),i=PC();for(let r=0;r<5e5;r++){i[3]=r,i[9]=Math.round(performance.now()-A);let o=JSON.stringify(i),n=btoa(String.fromCharCode(...new TextEncoder().encode(o)));if((await sI(e+n,512)).slice(0,t.length)<=t)return n}return"wQ8Lk5FbGpA2NcR9dShT6gYjU7VxZ4D"+btoa(String.fromCharCode(...new TextEncoder().encode(JSON.stringify(e+""))))}async function KC(e,t){return"gAAAAAB"+await mI(e,t)}async function OC(){return"gAAAAAC"+await mI(Math.random()+"","0")}async function hI(e,t){let A=await le({isForce:!0});return pe(A,"POST","/files",{file_name:e.name,file_size:e.size,use_case:t?"my_files":"multimodal"}).then(i=>i.json())}async function EI(e){let t=await le({});return pe(t,"POST","/files/"+e+"/uploaded",{}).then(A=>A.json())}async function Co(e){let t=await le({isForce:!0});return pe(t,"GET","/files/"+e+"/download",null).then(A=>A.json())}async function LC(){let e=await le({});return pe(e,"GET","/accounts/check/v4-2023-04-27",null).then(t=>t.json())}async function YC(){let e=await le({});return pe(e,"POST","/sentinel/chat-requirements",{p:await OC()}).then(t=>t.json())}async function fI(){let e=await le({});return pe(e,"POST","/register-websocket",null).then(t=>t.json()).then(t=>t.wss_url)}async function yI({conversationId:e,messageId:t,sandboxPath:A}){let i=await le({isForce:!0});return pe(i,"GET","/conversation/"+e+"/interpreter/download?message_id="+t+"&sandbox_path="+A.replace("sandbox:",""),null).then(r=>r.json())}async function wI(e){e||(e=await le());let t=`${Pi}/backend-api/aip/p?offset=0&limit=250&is_installed=true`;return await(await tA(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}})).json()}async function Qo(){if(Bo.get(fo))return Bo.get(fo);let e=null;try{e=await fetch(We.openaiApiSession)}catch(i){throw new Error(`${xe}: ${i.message}`)}let t=po;if(e?.status===403)throw new Error(t);let A=await e?.json().catch(()=>({}));if(!A.accessToken)throw new Error(t);return Bo.set(fo,A.accessToken),A.accessToken}async function DI(e){let t=await le();return pe(t,"POST",`/gizmos/${e}/sidebar`,{action:"keep"})}async function FI(){let e="Oai-",t={};return t[e+"Device-Id"]=await VC(),t[e+"Language"]="en-US",t}async function VC(){return(await chrome.cookies.get({url:Pi,name:"oai-did"}))?.value||$()}async function zC(e){try{return(await Bt.default.storage.local.get({selectWebAppModel:"gpt-4"})).selectWebAppModel}catch{return null}}async function SI(e){let t="";return t||(t=await le()),new Promise((A,i)=>{let r=setInterval(async()=>{let n=await(await pe(t,"GET","/files/"+e,null)).json();n.retrieval_index_status==="success"&&(clearInterval(r),A(n))},1e3)})}function BI(e){return e.map(t=>{let A={name:t.name,size:t.size,mimeType:t.type,id:t.id};return t.type.startsWith("image")?(A.width=t.width,A.height=t.height):gI.includes(t.type)&&(A.fileTokenSize=t.fileTokenSize),A})}var $e={};function WC(e){let t=mo(e);if($e[t])return $e[t];{let A=new WebSocket(e);return $e[t]=A,A}}function XC(e){let t=mo(e);if($e[t]&&$e[t].readyState===WebSocket.OPEN)return{ws:$e[t],isNew:!1};{let A=new WebSocket(e);return $e[t]=A,{ws:A,isNew:!0}}}function mo(e){return e.split("?")[0]}function _i(e){let t=mo(e);$e[t]&&delete $e[t]}async function ZC(e){let t=await Bt.default.storage.local.get("chatRequirements");return YC().then(A=>(Bt.default.storage.local.set({chatRequirements:{data:A,expireTime:Date.now()+9*60*1e3,token:e}}),A))}var Ji=class{constructor(t){this.token=t;this.token=t}async generateAnswer(t){let A,i,r,o=Promise.resolve(),n=!1,a=await ZC(this.token);async function s(){if(u.filter(Q=>Q.type==="image").length>0){let Q=u.filter(k=>k.type==="image").map(async k=>{let R=await Co(k.id);if(R.download_url)return fetch(R.download_url).then(T=>T.blob()).then(async T=>{let v=await je(T);return F({[ks+k.id]:v})})});await Promise.all(Q)}}let g=async()=>{try{await o}catch(Q){throw A&&(await s(),await lI(this.token,A,{is_visible:!1}),i&&A&&await uI(A,i),A="",i=""),new Error(`${xe}: ${Q}`)}r&&(r.onmessage=()=>{},r.onerror=()=>{},r.onclose=()=>{}),A&&(await s(),await lI(this.token,A,{is_visible:!1}),i&&A&&await uI(A,i),A="",i="")};t.getCleanupMethod?.(g);function I(Q,k){let R=k&&k.some(T=>T.type.startsWith("image"));return{content_type:R?"multimodal_text":"text",parts:R?k?.filter(T=>T.type.startsWith("image")).map(T=>({asset_pointer:"file-service://"+T.id,size_bytes:T.size,width:T.width,height:T.height})).concat([Q]):[Q]}}let l=Array.isArray(t.prompt)?t.prompt.map((Q,k)=>({id:$(),recipient:t.actionData?"all":void 0,author:t.actionData?t.actionData.author:{role:Q.role},content:k===t.prompt.length-1?I(Q.content,t.chatgptFiles):{content_type:"text",parts:[Q.content]},metadata:t.actionData?t.actionData.metaData:k===t.prompt.length-1&&t.chatgptFiles&&t.chatgptFiles.length>0?{attachments:BI(t.chatgptFiles)}:void 0})):[{id:$(),recipient:t.actionData?"all":void 0,author:t.actionData?t.actionData.author:{role:"user"},content:I(t.prompt,t.chatgptFiles),metadata:t.actionData?t.actionData.metaData:t.chatgptFiles?{attachments:BI(t.chatgptFiles)}:void 0}],c=()=>{c=null,t.onEvent({type:"done"}),g()},u=[],m=new qi,y=t.model||await zC(this.token)||"text-davinci-002-render-sha",{needArkoseToken:C}=await Bt.default.storage.local.get("needArkoseToken");function w(Q){if(Q.error&&Bt.default.storage.local.set({needArkoseToken:!0}),!Q.message?.content?.parts?.[0]&&!Q.message?.content?.text&&Q.message?.author.role!=="assistant"&&!Q.message?.metadata?.command&&!Q.message?.metadata?.jit_plugin_data||Q.message?.author.role==="system"||Q.message?.author.role==="user"||Q.message?.content?.content_type==="text"&&Q.message?.author.name===null&&Q.message?.status==="finished_successfully"&&!Q.message?.end_turn&&!Q.message_id)return;u=m.parseMessage(Q);let k=Q.message?.content?.parts?.[0];(k||u.length>0)&&(A=Q.conversation_id,t.onEvent({type:"answer",data:{message:Q.message,contents:u,text:k,messageId:Q.message.id,conversationId:Q.conversation_id}}),t.parentMsgId||(i=Q.message.id))}function x(Q){try{let k=JSON.parse(Q);return k.wss_url?k.wss_url:!1}catch{return!1}}async function N(Q){return Q||(Q=await fI()),E(Q)}function E(Q){return new Promise((k,R)=>{let T=XC(Q);r=T.ws,r.onopen=()=>{T.isNew&&setTimeout(()=>{k(!0)},500)},r.onclose=()=>{throw _i(Q),t.onEvent({type:"error",data:{error:`${xe}: Websoket error: close`}}),new Error("Websoket error: close")},r.onerror=v=>{throw _i(Q),t.onEvent({type:"error",data:{error:`${xe}: Websoket error: ${v}`}}),new Error("Websoket error: "+v)},r.onmessage=v=>{let de=JSON.parse(v.data),Je=atob(de.body).trim();if(!Je.startsWith("data: "))return;let dt=Je.replace("data: ",""),JA;if(dt==="[DONE]"){c?.();return}try{JA=JSON.parse(dt)}catch{return}w(JA)},T.isNew||k(!0)})}function p(Q){r=WC(Q),r.onopen=()=>{},r.onclose=()=>{throw _i(Q),t.onEvent({type:"error",data:{error:`${xe}: Websoket error: close`}}),new Error("Websoket error: close")},r.onerror=k=>{throw _i(Q),t.onEvent({type:"error",data:{error:`${xe}: Websoket error: ${k}`}}),new Error("Websoket error: "+k)},r.onmessage=k=>{let R=JSON.parse(k.data),T=atob(R.body).trim();if(!T.startsWith("data: "))return;let v=T.replace("data: ",""),de;if(v==="[DONE]"){c?.();return}try{de=JSON.parse(v)}catch{return}w(de)}}try{t.parentMsgId||(y==="gpt-4-gizmo:g-BlafpMvzd"?ve.report("browser_pro_new_chat"):y==="gpt-4-gizmo:g-nleealfRT"&&ve.report("shoppingGPT_new_chat"))}catch{}let d=(await Bt.default.storage.local.get("webAppNetwork")).webAppNetwork,B="";if(!d){let Q=await LC(),k=Q.accounts[Q.account_ordering[0]].features.includes("shared_websocket")?"websocket":"http";k==="websocket"&&(B=await fI()),d={method:k,wss_url:B},Bt.default.storage.local.set({webAppNetwork:d})}d.method==="websocket"&&await N(d.wss_url);let D=null;if(chrome.offscreen&&a.arkose.required)try{D=await cI(a.persona,a.arkose?.dx)}catch(Q){throw new Error(Q)}let b=()=>{let Q={};return this.token&&(Q.Authorization=`Bearer ${this.token}`),Q};async function S(){let Q="OpenAI-Sentinel-",k={};if(a.token&&(k[`${Q}Chat-Requirements-Token`]=a.token),D&&(k[`${Q}Arkose-Token`]=D),a.proofofwork?.required){let{seed:R,difficulty:T}=a.proofofwork;k[`${Q}Proof-Token`]=await KC(R,T)}return k}let G={"Content-Type":"application/json",...b(),...await S(),...await FI()};o=eA(Pi+"/backend-api/conversation",{method:"POST",signal:t.signal,headers:G,body:JSON.stringify({action:"next",conversation_mode:y.startsWith("gpt-4-gizmo:")?{gizmo_id:y.replace("gpt-4-gizmo:",""),kind:"gizmo_interaction"}:{kind:"primary_assistant"},force_paragen:!1,force_nulligen:this.token?void 0:!1,force_rate_limit:!1,force_paragen_model_slug:"",history_and_training_disabled:!1,messages:l,model:y.startsWith("gpt-4-gizmo:")?"gpt-4-gizmo":y,parent_message_id:t.parentMsgId||$(),plugin_ids:t.pluginIds,timezone_offset_min:new Date().getTimezoneOffset(),arkose_token:D||void 0,conversation_id:t.cid?t.cid:void 0,suggestions:[],websocket_request_id:$()}),onMessage(Q){try{}catch{}if(Q==="[DONE]"){c?.();return}else if(x(Q))n=!0,p(x(Q));else if(Q.startsWith("event: typing"))return;let k;try{k=JSON.parse(Q)}catch{return}w(k)}},!0,!0).catch(Q=>{let k=Q.message;try{let R=JSON.parse(k);k=R.message||R.msg||R.error?.message||R.detail?.message||R.detail||k}catch{}throw t.onEvent({type:"error",data:{error:`${xe}: ${k}`}}),new Error(`${xe}: ${k}`)}).finally(()=>{n||c?.()})}};var pt=0,Ki=!1,AA=new kI.default(1e3*30),ho="accessToken",xI="noCacheToken",jC="alwaysProxyFetch";oe.default.storage.local.get({guardChatgptTabId:0}).then(({guardChatgptTabId:e})=>{pt==0&&(pt=e),Ki=e!=0});async function bI(){let e=null;try{e=await oe.default.tabs.get(pt),await oe.default.tabs.update(e.id,{active:!0})}catch{}e||(e=await oe.default.tabs.create({url:We.openaiChat,pinned:!0,active:!0}));let t=e.id;await oe.default.storage.local.set({guardChatgptTabId:t}),pt=t,Ki=!0,await new Promise(A=>{let i=(r,o)=>{switch(r.type){case"loaded":o.tab?.id==t&&oe.default.tabs.sendMessage(t,{type:"guard-session-activate"});break;case"guard-session-activated":oe.default.runtime.onMessage.removeListener(i),A();break}};oe.default.runtime.onMessage.addListener(i),setTimeout(()=>A(),1e3*40)})}async function $C(){let e=await oe.default.tabs.create({url:We.openaiChat,pinned:!0,active:!1});return await oe.default.storage.local.set({guardChatgptTabId:e.id}),pt=e.id,Ki=!0,e}async function eQ(){let t=await oe.default.tabs.query({pinned:!0,url:"https://chatgpt.com/*"});if(t.length>0){let A=t[0];return pt=A.id,await oe.default.tabs.reload(A.id),A}return null}async function tQ(){let e=null;try{e=await oe.default.tabs.get(pt),/chat\.openai\.com/.test(e.url||"")?await oe.default.tabs.reload(e.id):e=await oe.default.tabs.update(e.id,{url:We.openaiChat})}catch{}e||(e=await eQ()),e||(e=await $C());let t=e?.id||0;await new Promise(A=>{let i=(r,o)=>{switch(r.type){case"loaded":o.tab?.id==t&&oe.default.tabs.sendMessage(t,{type:"guard-session-activate"});break;case"guard-session-activated":oe.default.runtime.onMessage.removeListener(i),A();break;case"guard-session-logout":throw Error("")}};oe.default.runtime.onMessage.addListener(i),setTimeout(()=>A(),1e3*40)})}async function le({onRefresh:e,throwGuideError:t,isForce:A}={}){if(!A&&AA.get(xI)!==!0&&AA.get(ho))return AA.get(ho);let r=await(await tA(We.openaiApiSession,{},{onRefresh:e,throwGuideError:t})).json().catch(()=>({}));return AA.set(ho,r.accessToken),r.accessToken}async function AQ(e,t,A){let i=oe.default.tabs.connect(e,{name:"guard-proxy"}),r=null,o=null,n=new Promise((u,m)=>{r=u,o=m}),a;i.onDisconnect.addListener(()=>{o(new Error("proxy fetch aborted")),a?.close()}),A?.signal?.addEventListener("abort",()=>{a?.close(),i.disconnect()});let s={type:"guard-proxy-request",key:Date.now()+"",url:t,options:A};i.postMessage(s);let g=new ReadableStream({start(u){a=u},cancel(){i.disconnect()}}),I=setTimeout(()=>o(new Error("connect timeout")),1e3*1),l=u=>{switch(u.type){case"guard-proxy-request-received":clearTimeout(I);break;case"guard-proxy-response":r(new Response(g,u.options));break;case"guard-proxy-response-chunk":a.enqueue(new TextEncoder().encode(u.value)),u.done&&(a.close(),i.onMessage.removeListener(l),i.disconnect());break;case"guard-proxy-response-error":i.onMessage.removeListener(l),i.disconnect(),o(new Error(u.error)),a.close();break}};return i.onMessage.addListener(l),await n}async function tA(e,t,A){let i=null;try{i=await fetch(e,t)}catch{}if(!i)throw new Error(po);if(i.status===401)throw new Error("");if(i.status==403){if(AA.set(xI,!0),AA.set(jC,!0),!Ki&&A?.throwGuideError)throw Error(`${xe}: error_chatgpt_session_timeout`);A?.onRefresh?.(),await tQ(),i=await AQ(pt,e,t)}return i}var MA=U(K());function NI(){iQ("NEW","#F00","#FFF")}function iQ(e,t,A){MA.default.action.setBadgeBackgroundColor({color:t}),MA.default.action.setBadgeText({text:e}),A&&MA.default.action.setBadgeTextColor({color:A})}function Eo(){return MA.default.action.setBadgeText({text:""})}var rQ={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]}},wo=class e{constructor(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,A)}init(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=A.prefix||"i18next:",this.logger=t||rQ,this.options=A,this.debug=A.debug}log(){for(var t=arguments.length,A=new Array(t),i=0;i<t;i++)A[i]=arguments[i];return this.forward(A,"log","",!0)}warn(){for(var t=arguments.length,A=new Array(t),i=0;i<t;i++)A[i]=arguments[i];return this.forward(A,"warn","",!0)}error(){for(var t=arguments.length,A=new Array(t),i=0;i<t;i++)A[i]=arguments[i];return this.forward(A,"error","")}deprecate(){for(var t=arguments.length,A=new Array(t),i=0;i<t;i++)A[i]=arguments[i];return this.forward(A,"warn","WARNING DEPRECATED: ",!0)}forward(t,A,i,r){return r&&!this.debug?null:(typeof t[0]=="string"&&(t[0]=`${i}${this.prefix} ${t[0]}`),this.logger[A](t))}create(t){return new e(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new e(this.logger,t)}},qe=new wo,oA=class{constructor(){this.observers={}}on(t,A){return t.split(" ").forEach(i=>{this.observers[i]=this.observers[i]||[],this.observers[i].push(A)}),this}off(t,A){if(this.observers[t]){if(!A){delete this.observers[t];return}this.observers[t]=this.observers[t].filter(i=>i!==A)}}emit(t){for(var A=arguments.length,i=new Array(A>1?A-1:0),r=1;r<A;r++)i[r-1]=arguments[r];this.observers[t]&&[].concat(this.observers[t]).forEach(n=>{n(...i)}),this.observers["*"]&&[].concat(this.observers["*"]).forEach(n=>{n.apply(n,[t,...i])})}};function HA(){let e,t,A=new Promise((i,r)=>{e=i,t=r});return A.resolve=e,A.reject=t,A}function GI(e){return e==null?"":""+e}function oQ(e,t,A){e.forEach(i=>{t[i]&&(A[i]=t[i])})}function xo(e,t,A){function i(n){return n&&n.indexOf("###")>-1?n.replace(/###/g,"."):n}function r(){return!e||typeof e=="string"}let o=typeof t!="string"?[].concat(t):t.split(".");for(;o.length>1;){if(r())return{};let n=i(o.shift());!e[n]&&A&&(e[n]=new A),Object.prototype.hasOwnProperty.call(e,n)?e=e[n]:e={}}return r()?{}:{obj:e,k:i(o.shift())}}function UI(e,t,A){let{obj:i,k:r}=xo(e,t,Object);i[r]=A}function nQ(e,t,A,i){let{obj:r,k:o}=xo(e,t,Object);r[o]=r[o]||[],i&&(r[o]=r[o].concat(A)),i||r[o].push(A)}function Li(e,t){let{obj:A,k:i}=xo(e,t);if(A)return A[i]}function aQ(e,t,A){let i=Li(e,A);return i!==void 0?i:Li(t,A)}function qI(e,t,A){for(let i in t)i!=="__proto__"&&i!=="constructor"&&(i in e?typeof e[i]=="string"||e[i]instanceof String||typeof t[i]=="string"||t[i]instanceof String?A&&(e[i]=t[i]):qI(e[i],t[i],A):e[i]=t[i]);return e}function iA(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var sQ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function gQ(e){return typeof e=="string"?e.replace(/[&<>"'\/]/g,t=>sQ[t]):e}var IQ=[" ",",","?","!",";"];function cQ(e,t,A){t=t||"",A=A||"";let i=IQ.filter(n=>t.indexOf(n)<0&&A.indexOf(n)<0);if(i.length===0)return!0;let r=new RegExp(`(${i.map(n=>n==="?"?"\\?":n).join("|")})`),o=!r.test(e);if(!o){let n=e.indexOf(A);n>0&&!r.test(e.substring(0,n))&&(o=!0)}return o}function Yi(e,t){let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];let i=t.split(A),r=e;for(let o=0;o<i.length;++o){if(!r||typeof r[i[o]]=="string"&&o+1<i.length)return;if(r[i[o]]===void 0){let n=2,a=i.slice(o,o+n).join(A),s=r[a];for(;s===void 0&&i.length>o+n;)n++,a=i.slice(o,o+n).join(A),s=r[a];if(s===void 0)return;if(s===null)return null;if(t.endsWith(a)){if(typeof s=="string")return s;if(a&&typeof s[a]=="string")return s[a]}let g=i.slice(o+n).join(A);return g?Yi(s,g,A):void 0}r=r[i[o]]}return r}function Vi(e){return e&&e.indexOf("_")>0?e.replace("_","-"):e}var zi=class extends oA{constructor(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=A,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){let A=this.options.ns.indexOf(t);A>-1&&this.options.ns.splice(A,1)}getResource(t,A,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,n=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure,a=[t,A];i&&typeof i!="string"&&(a=a.concat(i)),i&&typeof i=="string"&&(a=a.concat(o?i.split(o):i)),t.indexOf(".")>-1&&(a=t.split("."));let s=Li(this.data,a);return s||!n||typeof i!="string"?s:Yi(this.data&&this.data[t]&&this.data[t][A],i,o)}addResource(t,A,i,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1},n=o.keySeparator!==void 0?o.keySeparator:this.options.keySeparator,a=[t,A];i&&(a=a.concat(n?i.split(n):i)),t.indexOf(".")>-1&&(a=t.split("."),r=A,A=a[1]),this.addNamespaces(A),UI(this.data,a,r),o.silent||this.emit("added",t,A,i,r)}addResources(t,A,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(let o in i)(typeof i[o]=="string"||Object.prototype.toString.apply(i[o])==="[object Array]")&&this.addResource(t,A,o,i[o],{silent:!0});r.silent||this.emit("added",t,A,i)}addResourceBundle(t,A,i,r,o){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},a=[t,A];t.indexOf(".")>-1&&(a=t.split("."),r=i,i=A,A=a[1]),this.addNamespaces(A);let s=Li(this.data,a)||{};r?qI(s,i,o):s={...s,...i},UI(this.data,a,s),n.silent||this.emit("added",t,A,i)}removeResourceBundle(t,A){this.hasResourceBundle(t,A)&&delete this.data[t][A],this.removeNamespaces(A),this.emit("removed",t,A)}hasResourceBundle(t,A){return this.getResource(t,A)!==void 0}getResourceBundle(t,A){return A||(A=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,A)}:this.getResource(t,A)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){let A=this.getDataByLanguage(t);return!!(A&&Object.keys(A)||[]).find(r=>A[r]&&Object.keys(A[r]).length>0)}toJSON(){return this.data}},_I={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,A,i,r){return e.forEach(o=>{this.processors[o]&&(t=this.processors[o].process(t,A,i,r))}),t}},MI={},Wi=class e extends oA{constructor(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),oQ(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=A,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=qe.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;let i=this.resolve(t,A);return i&&i.res!==void 0}extractFromKey(t,A){let i=A.nsSeparator!==void 0?A.nsSeparator:this.options.nsSeparator;i===void 0&&(i=":");let r=A.keySeparator!==void 0?A.keySeparator:this.options.keySeparator,o=A.ns||this.options.defaultNS||[],n=i&&t.indexOf(i)>-1,a=!this.options.userDefinedKeySeparator&&!A.keySeparator&&!this.options.userDefinedNsSeparator&&!A.nsSeparator&&!cQ(t,i,r);if(n&&!a){let s=t.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:t,namespaces:o};let g=t.split(i);(i!==r||i===r&&this.options.ns.indexOf(g[0])>-1)&&(o=g.shift()),t=g.join(r)}return typeof o=="string"&&(o=[o]),{key:t,namespaces:o}}translate(t,A,i){if(typeof A!="object"&&this.options.overloadTranslationOptionHandler&&(A=this.options.overloadTranslationOptionHandler(arguments)),typeof A=="object"&&(A={...A}),A||(A={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);let r=A.returnDetails!==void 0?A.returnDetails:this.options.returnDetails,o=A.keySeparator!==void 0?A.keySeparator:this.options.keySeparator,{key:n,namespaces:a}=this.extractFromKey(t[t.length-1],A),s=a[a.length-1],g=A.lng||this.language,I=A.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g&&g.toLowerCase()==="cimode"){if(I){let E=A.nsSeparator||this.options.nsSeparator;return r?{res:`${s}${E}${n}`,usedKey:n,exactUsedKey:n,usedLng:g,usedNS:s,usedParams:this.getUsedParamsDetails(A)}:`${s}${E}${n}`}return r?{res:n,usedKey:n,exactUsedKey:n,usedLng:g,usedNS:s,usedParams:this.getUsedParamsDetails(A)}:n}let l=this.resolve(t,A),c=l&&l.res,u=l&&l.usedKey||n,m=l&&l.exactUsedKey||n,y=Object.prototype.toString.apply(c),C=["[object Number]","[object Function]","[object RegExp]"],w=A.joinArrays!==void 0?A.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject;if(x&&c&&(typeof c!="string"&&typeof c!="boolean"&&typeof c!="number")&&C.indexOf(y)<0&&!(typeof w=="string"&&y==="[object Array]")){if(!A.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");let E=this.options.returnedObjectHandler?this.options.returnedObjectHandler(u,c,{...A,ns:a}):`key '${n} (${this.language})' returned an object instead of string.`;return r?(l.res=E,l.usedParams=this.getUsedParamsDetails(A),l):E}if(o){let E=y==="[object Array]",p=E?[]:{},f=E?m:u;for(let d in c)if(Object.prototype.hasOwnProperty.call(c,d)){let B=`${f}${o}${d}`;p[d]=this.translate(B,{...A,joinArrays:!1,ns:a}),p[d]===B&&(p[d]=c[d])}c=p}}else if(x&&typeof w=="string"&&y==="[object Array]")c=c.join(w),c&&(c=this.extendTranslation(c,t,A,i));else{let E=!1,p=!1,f=A.count!==void 0&&typeof A.count!="string",d=e.hasDefaultValue(A),B=f?this.pluralResolver.getSuffix(g,A.count,A):"",D=A.ordinal&&f?this.pluralResolver.getSuffix(g,A.count,{ordinal:!1}):"",b=A[`defaultValue${B}`]||A[`defaultValue${D}`]||A.defaultValue;!this.isValidLookup(c)&&d&&(E=!0,c=b),this.isValidLookup(c)||(p=!0,c=n);let G=(A.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&p?void 0:c,Q=d&&b!==c&&this.options.updateMissing;if(p||E||Q){if(this.logger.log(Q?"updateKey":"missingKey",g,s,n,Q?b:c),o){let v=this.resolve(n,{...A,keySeparator:!1});v&&v.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let k=[],R=this.languageUtils.getFallbackCodes(this.options.fallbackLng,A.lng||this.language);if(this.options.saveMissingTo==="fallback"&&R&&R[0])for(let v=0;v<R.length;v++)k.push(R[v]);else this.options.saveMissingTo==="all"?k=this.languageUtils.toResolveHierarchy(A.lng||this.language):k.push(A.lng||this.language);let T=(v,de,Je)=>{let dt=d&&Je!==c?Je:G;this.options.missingKeyHandler?this.options.missingKeyHandler(v,s,de,dt,Q,A):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(v,s,de,dt,Q,A),this.emit("missingKey",v,s,de,c)};this.options.saveMissing&&(this.options.saveMissingPlurals&&f?k.forEach(v=>{this.pluralResolver.getSuffixes(v,A).forEach(de=>{T([v],n+de,A[`defaultValue${de}`]||b)})}):T(k,n,b))}c=this.extendTranslation(c,t,A,l,i),p&&c===n&&this.options.appendNamespaceToMissingKey&&(c=`${s}:${n}`),(p||E)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?c=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${n}`:n,E?c:void 0):c=this.options.parseMissingKeyHandler(c))}return r?(l.res=c,l.usedParams=this.getUsedParamsDetails(A),l):c}extendTranslation(t,A,i,r,o){var n=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...i},i.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init({...i,interpolation:{...this.options.interpolation,...i.interpolation}});let g=typeof t=="string"&&(i&&i.interpolation&&i.interpolation.skipOnVariables!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables),I;if(g){let c=t.match(this.interpolator.nestingRegexp);I=c&&c.length}let l=i.replace&&typeof i.replace!="string"?i.replace:i;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),t=this.interpolator.interpolate(t,l,i.lng||this.language,i),g){let c=t.match(this.interpolator.nestingRegexp),u=c&&c.length;I<u&&(i.nest=!1)}!i.lng&&this.options.compatibilityAPI!=="v1"&&r&&r.res&&(i.lng=r.usedLng),i.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var c=arguments.length,u=new Array(c),m=0;m<c;m++)u[m]=arguments[m];return o&&o[0]===u[0]&&!i.context?(n.logger.warn(`It seems you are nesting recursively key: ${u[0]} in key: ${A[0]}`),null):n.translate(...u,A)},i)),i.interpolation&&this.interpolator.reset()}let a=i.postProcess||this.options.postProcess,s=typeof a=="string"?[a]:a;return t!=null&&s&&s.length&&i.applyPostProcessor!==!1&&(t=_I.handle(s,t,A,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(i)},...i}:i,this)),t}resolve(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i,r,o,n,a;return typeof t=="string"&&(t=[t]),t.forEach(s=>{if(this.isValidLookup(i))return;let g=this.extractFromKey(s,A),I=g.key;r=I;let l=g.namespaces;this.options.fallbackNS&&(l=l.concat(this.options.fallbackNS));let c=A.count!==void 0&&typeof A.count!="string",u=c&&!A.ordinal&&A.count===0&&this.pluralResolver.shouldUseIntlApi(),m=A.context!==void 0&&(typeof A.context=="string"||typeof A.context=="number")&&A.context!=="",y=A.lngs?A.lngs:this.languageUtils.toResolveHierarchy(A.lng||this.language,A.fallbackLng);l.forEach(C=>{this.isValidLookup(i)||(a=C,!MI[`${y[0]}-${C}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(a)&&(MI[`${y[0]}-${C}`]=!0,this.logger.warn(`key "${r}" for languages "${y.join(", ")}" won't get resolved as namespace "${a}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(w=>{if(this.isValidLookup(i))return;n=w;let x=[I];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(x,I,w,C,A);else{let E;c&&(E=this.pluralResolver.getSuffix(w,A.count,A));let p=`${this.options.pluralSeparator}zero`,f=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(x.push(I+E),A.ordinal&&E.indexOf(f)===0&&x.push(I+E.replace(f,this.options.pluralSeparator)),u&&x.push(I+p)),m){let d=`${I}${this.options.contextSeparator}${A.context}`;x.push(d),c&&(x.push(d+E),A.ordinal&&E.indexOf(f)===0&&x.push(d+E.replace(f,this.options.pluralSeparator)),u&&x.push(d+p))}}let N;for(;N=x.pop();)this.isValidLookup(i)||(o=N,i=this.getResource(w,C,N,A))}))})}),{res:i,usedKey:r,exactUsedKey:o,usedLng:n,usedNS:a}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,A,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,A,i,r):this.resourceStore.getResource(t,A,i,r)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],i=t.replace&&typeof t.replace!="string",r=i?t.replace:t;if(i&&typeof t.count<"u"&&(r.count=t.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!i){r={...r};for(let o of A)delete r[o]}return r}static hasDefaultValue(t){let A="defaultValue";for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&A===i.substring(0,A.length)&&t[i]!==void 0)return!0;return!1}};function yo(e){return e.charAt(0).toUpperCase()+e.slice(1)}var Xi=class{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=qe.create("languageUtils")}getScriptPartFromCode(t){if(t=Vi(t),!t||t.indexOf("-")<0)return null;let A=t.split("-");return A.length===2||(A.pop(),A[A.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(A.join("-"))}getLanguagePartFromCode(t){if(t=Vi(t),!t||t.indexOf("-")<0)return t;let A=t.split("-");return this.formatLanguageCode(A[0])}formatLanguageCode(t){if(typeof t=="string"&&t.indexOf("-")>-1){let A=["hans","hant","latn","cyrl","cans","mong","arab"],i=t.split("-");return this.options.lowerCaseLng?i=i.map(r=>r.toLowerCase()):i.length===2?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),A.indexOf(i[1].toLowerCase())>-1&&(i[1]=yo(i[1].toLowerCase()))):i.length===3&&(i[0]=i[0].toLowerCase(),i[1].length===2&&(i[1]=i[1].toUpperCase()),i[0]!=="sgn"&&i[2].length===2&&(i[2]=i[2].toUpperCase()),A.indexOf(i[1].toLowerCase())>-1&&(i[1]=yo(i[1].toLowerCase())),A.indexOf(i[2].toLowerCase())>-1&&(i[2]=yo(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let A;return t.forEach(i=>{if(A)return;let r=this.formatLanguageCode(i);(!this.options.supportedLngs||this.isSupportedCode(r))&&(A=r)}),!A&&this.options.supportedLngs&&t.forEach(i=>{if(A)return;let r=this.getLanguagePartFromCode(i);if(this.isSupportedCode(r))return A=r;A=this.options.supportedLngs.find(o=>{if(o===r)return o;if(!(o.indexOf("-")<0&&r.indexOf("-")<0)&&o.indexOf(r)===0)return o})}),A||(A=this.getFallbackCodes(this.options.fallbackLng)[0]),A}getFallbackCodes(t,A){if(!t)return[];if(typeof t=="function"&&(t=t(A)),typeof t=="string"&&(t=[t]),Object.prototype.toString.apply(t)==="[object Array]")return t;if(!A)return t.default||[];let i=t[A];return i||(i=t[this.getScriptPartFromCode(A)]),i||(i=t[this.formatLanguageCode(A)]),i||(i=t[this.getLanguagePartFromCode(A)]),i||(i=t.default),i||[]}toResolveHierarchy(t,A){let i=this.getFallbackCodes(A||this.options.fallbackLng||[],t),r=[],o=n=>{n&&(this.isSupportedCode(n)?r.push(n):this.logger.warn(`rejecting language code not found in supportedLngs: ${n}`))};return typeof t=="string"&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&o(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&o(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&o(this.getLanguagePartFromCode(t))):typeof t=="string"&&o(this.formatLanguageCode(t)),i.forEach(n=>{r.indexOf(n)<0&&o(this.formatLanguageCode(n))}),r}},lQ=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],uQ={1:function(e){return+(e>1)},2:function(e){return+(e!=1)},3:function(e){return 0},4:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},5:function(e){return e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5},6:function(e){return e==1?0:e>=2&&e<=4?1:2},7:function(e){return e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2},8:function(e){return e==1?0:e==2?1:e!=8&&e!=11?2:3},9:function(e){return+(e>=2)},10:function(e){return e==1?0:e==2?1:e<7?2:e<11?3:4},11:function(e){return e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3},12:function(e){return+(e%10!=1||e%100==11)},13:function(e){return+(e!==0)},14:function(e){return e==1?0:e==2?1:e==3?2:3},15:function(e){return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2},16:function(e){return e%10==1&&e%100!=11?0:e!==0?1:2},17:function(e){return e==1||e%10==1&&e%100!=11?0:1},18:function(e){return e==0?0:e==1?1:2},19:function(e){return e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3},20:function(e){return e==1?0:e==0||e%100>0&&e%100<20?1:2},21:function(e){return e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0},22:function(e){return e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3}},fQ=["v1","v2","v3"],BQ=["v4"],HI={zero:0,one:1,two:2,few:3,many:4,other:5};function pQ(){let e={};return lQ.forEach(t=>{t.lngs.forEach(A=>{e[A]={numbers:t.nr,plurals:uQ[t.fc]}})}),e}var Do=class{constructor(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=A,this.logger=qe.create("pluralResolver"),(!this.options.compatibilityJSON||BQ.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=pQ()}addRule(t,A){this.rules[t]=A}getRule(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(Vi(t),{type:A.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.getRule(t,A);return this.shouldUseIntlApi()?i&&i.resolvedOptions().pluralCategories.length>1:i&&i.numbers.length>1}getPluralFormsOfKey(t,A){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,i).map(r=>`${A}${r}`)}getSuffixes(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=this.getRule(t,A);return i?this.shouldUseIntlApi()?i.resolvedOptions().pluralCategories.sort((r,o)=>HI[r]-HI[o]).map(r=>`${this.options.prepend}${A.ordinal?`ordinal${this.options.prepend}`:""}${r}`):i.numbers.map(r=>this.getSuffix(t,r,A)):[]}getSuffix(t,A){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=this.getRule(t,i);return r?this.shouldUseIntlApi()?`${this.options.prepend}${i.ordinal?`ordinal${this.options.prepend}`:""}${r.select(A)}`:this.getSuffixRetroCompatible(r,A):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,A){let i=t.noAbs?t.plurals(A):t.plurals(Math.abs(A)),r=t.numbers[i];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(r===2?r="plural":r===1&&(r=""));let o=()=>this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString();return this.options.compatibilityJSON==="v1"?r===1?"":typeof r=="number"?`_plural_${r.toString()}`:o():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?o():this.options.prepend&&i.toString()?this.options.prepend+i.toString():i.toString()}shouldUseIntlApi(){return!fQ.includes(this.options.compatibilityJSON)}};function RI(e,t,A){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,o=aQ(e,t,A);return!o&&r&&typeof A=="string"&&(o=Yi(e,A,i),o===void 0&&(o=Yi(t,A,i))),o}var Fo=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=qe.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(A=>A),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});let A=t.interpolation;this.escape=A.escape!==void 0?A.escape:gQ,this.escapeValue=A.escapeValue!==void 0?A.escapeValue:!0,this.useRawValueToEscape=A.useRawValueToEscape!==void 0?A.useRawValueToEscape:!1,this.prefix=A.prefix?iA(A.prefix):A.prefixEscaped||"{{",this.suffix=A.suffix?iA(A.suffix):A.suffixEscaped||"}}",this.formatSeparator=A.formatSeparator?A.formatSeparator:A.formatSeparator||",",this.unescapePrefix=A.unescapeSuffix?"":A.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":A.unescapeSuffix||"",this.nestingPrefix=A.nestingPrefix?iA(A.nestingPrefix):A.nestingPrefixEscaped||iA("$t("),this.nestingSuffix=A.nestingSuffix?iA(A.nestingSuffix):A.nestingSuffixEscaped||iA(")"),this.nestingOptionsSeparator=A.nestingOptionsSeparator?A.nestingOptionsSeparator:A.nestingOptionsSeparator||",",this.maxReplaces=A.maxReplaces?A.maxReplaces:1e3,this.alwaysFormat=A.alwaysFormat!==void 0?A.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){let t=`${this.prefix}(.+?)${this.suffix}`;this.regexp=new RegExp(t,"g");let A=`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`;this.regexpUnescape=new RegExp(A,"g");let i=`${this.nestingPrefix}(.+?)${this.nestingSuffix}`;this.nestingRegexp=new RegExp(i,"g")}interpolate(t,A,i,r){let o,n,a,s=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function g(m){return m.replace(/\$/g,"$$$$")}let I=m=>{if(m.indexOf(this.formatSeparator)<0){let x=RI(A,s,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(x,void 0,i,{...r,...A,interpolationkey:m}):x}let y=m.split(this.formatSeparator),C=y.shift().trim(),w=y.join(this.formatSeparator).trim();return this.format(RI(A,s,C,this.options.keySeparator,this.options.ignoreJSONStructure),w,i,{...r,...A,interpolationkey:C})};this.resetRegExp();let l=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,c=r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>g(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?g(this.escape(m)):g(m)}].forEach(m=>{for(a=0;o=m.regex.exec(t);){let y=o[1].trim();if(n=I(y),n===void 0)if(typeof l=="function"){let w=l(t,o,r);n=typeof w=="string"?w:""}else if(r&&Object.prototype.hasOwnProperty.call(r,y))n="";else if(c){n=o[0];continue}else this.logger.warn(`missed to pass in variable ${y} for interpolating ${t}`),n="";else typeof n!="string"&&!this.useRawValueToEscape&&(n=GI(n));let C=m.safeValue(n);if(t=t.replace(o[0],C),c?(m.regex.lastIndex+=n.length,m.regex.lastIndex-=o[0].length):m.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),t}nest(t,A){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,o,n;function a(s,g){let I=this.nestingOptionsSeparator;if(s.indexOf(I)<0)return s;let l=s.split(new RegExp(`${I}[ ]*{`)),c=`{${l[1]}`;s=l[0],c=this.interpolate(c,n);let u=c.match(/'/g),m=c.match(/"/g);(u&&u.length%2===0&&!m||m.length%2!==0)&&(c=c.replace(/'/g,'"'));try{n=JSON.parse(c),g&&(n={...g,...n})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${s}`,y),`${s}${I}${c}`}return delete n.defaultValue,s}for(;r=this.nestingRegexp.exec(t);){let s=[];n={...i},n=n.replace&&typeof n.replace!="string"?n.replace:n,n.applyPostProcessor=!1,delete n.defaultValue;let g=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){let I=r[1].split(this.formatSeparator).map(l=>l.trim());r[1]=I.shift(),s=I,g=!0}if(o=A(a.call(this,r[1].trim(),n),n),o&&r[0]===t&&typeof o!="string")return o;typeof o!="string"&&(o=GI(o)),o||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${t}`),o=""),g&&(o=s.reduce((I,l)=>this.format(I,l,i.lng,{...i,interpolationkey:r[1].trim()}),o.trim())),t=t.replace(r[0],o),this.regexp.lastIndex=0}return t}};function dQ(e){let t=e.toLowerCase().trim(),A={};if(e.indexOf("(")>-1){let i=e.split("(");t=i[0].toLowerCase().trim();let r=i[1].substring(0,i[1].length-1);t==="currency"&&r.indexOf(":")<0?A.currency||(A.currency=r.trim()):t==="relativetime"&&r.indexOf(":")<0?A.range||(A.range=r.trim()):r.split(";").forEach(n=>{if(!n)return;let[a,...s]=n.split(":"),g=s.join(":").trim().replace(/^'+|'+$/g,"");A[a.trim()]||(A[a.trim()]=g),g==="false"&&(A[a.trim()]=!1),g==="true"&&(A[a.trim()]=!0),isNaN(g)||(A[a.trim()]=parseInt(g,10))})}return{formatName:t,formatOptions:A}}function rA(e){let t={};return function(i,r,o){let n=r+JSON.stringify(o),a=t[n];return a||(a=e(Vi(r),o),t[n]=a),a(i)}}var So=class{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=qe.create("formatter"),this.options=t,this.formats={number:rA((A,i)=>{let r=new Intl.NumberFormat(A,{...i});return o=>r.format(o)}),currency:rA((A,i)=>{let r=new Intl.NumberFormat(A,{...i,style:"currency"});return o=>r.format(o)}),datetime:rA((A,i)=>{let r=new Intl.DateTimeFormat(A,{...i});return o=>r.format(o)}),relativetime:rA((A,i)=>{let r=new Intl.RelativeTimeFormat(A,{...i});return o=>r.format(o,i.range||"day")}),list:rA((A,i)=>{let r=new Intl.ListFormat(A,{...i});return o=>r.format(o)})},this.init(t)}init(t){let i=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=i.formatSeparator?i.formatSeparator:i.formatSeparator||","}add(t,A){this.formats[t.toLowerCase().trim()]=A}addCached(t,A){this.formats[t.toLowerCase().trim()]=rA(A)}format(t,A,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return A.split(this.formatSeparator).reduce((a,s)=>{let{formatName:g,formatOptions:I}=dQ(s);if(this.formats[g]){let l=a;try{let c=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},u=c.locale||c.lng||r.locale||r.lng||i;l=this.formats[g](a,u,{...I,...r,...c})}catch(c){this.logger.warn(c)}return l}else this.logger.warn(`there was no format function for ${g}`);return a},t)}};function CQ(e,t){e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)}var ko=class extends oA{constructor(t,A,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=A,this.services=i,this.languageUtils=i.languageUtils,this.options=r,this.logger=qe.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(i,r.backend,r)}queueLoad(t,A,i,r){let o={},n={},a={},s={};return t.forEach(g=>{let I=!0;A.forEach(l=>{let c=`${g}|${l}`;!i.reload&&this.store.hasResourceBundle(g,l)?this.state[c]=2:this.state[c]<0||(this.state[c]===1?n[c]===void 0&&(n[c]=!0):(this.state[c]=1,I=!1,n[c]===void 0&&(n[c]=!0),o[c]===void 0&&(o[c]=!0),s[l]===void 0&&(s[l]=!0)))}),I||(a[g]=!0)}),(Object.keys(o).length||Object.keys(n).length)&&this.queue.push({pending:n,pendingCount:Object.keys(n).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(o),pending:Object.keys(n),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(t,A,i){let r=t.split("|"),o=r[0],n=r[1];A&&this.emit("failedLoading",o,n,A),i&&this.store.addResourceBundle(o,n,i),this.state[t]=A?-1:2;let a={};this.queue.forEach(s=>{nQ(s.loaded,[o],n),CQ(s,t),A&&s.errors.push(A),s.pendingCount===0&&!s.done&&(Object.keys(s.loaded).forEach(g=>{a[g]||(a[g]={});let I=s.loaded[g];I.length&&I.forEach(l=>{a[g][l]===void 0&&(a[g][l]=!0)})}),s.done=!0,s.errors.length?s.callback(s.errors):s.callback())}),this.emit("loaded",a),this.queue=this.queue.filter(s=>!s.done)}read(t,A,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,n=arguments.length>5?arguments[5]:void 0;if(!t.length)return n(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:A,fcName:i,tried:r,wait:o,callback:n});return}this.readingCalls++;let a=(g,I)=>{if(this.readingCalls--,this.waitingReads.length>0){let l=this.waitingReads.shift();this.read(l.lng,l.ns,l.fcName,l.tried,l.wait,l.callback)}if(g&&I&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,t,A,i,r+1,o*2,n)},o);return}n(g,I)},s=this.backend[i].bind(this.backend);if(s.length===2){try{let g=s(t,A);g&&typeof g.then=="function"?g.then(I=>a(null,I)).catch(a):a(null,g)}catch(g){a(g)}return}return s(t,A,a)}prepareLoading(t,A){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();typeof t=="string"&&(t=this.languageUtils.toResolveHierarchy(t)),typeof A=="string"&&(A=[A]);let o=this.queueLoad(t,A,i,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach(n=>{this.loadOne(n)})}load(t,A,i){this.prepareLoading(t,A,{},i)}reload(t,A,i){this.prepareLoading(t,A,{reload:!0},i)}loadOne(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",i=t.split("|"),r=i[0],o=i[1];this.read(r,o,"read",void 0,void 0,(n,a)=>{n&&this.logger.warn(`${A}loading namespace ${o} for language ${r} failed`,n),!n&&a&&this.logger.log(`${A}loaded namespace ${o} for language ${r}`,a),this.loaded(t,n,a)})}saveMissing(t,A,i,r,o){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(A)){this.logger.warn(`did not save key "${i}" as the namespace "${A}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(i==null||i==="")){if(this.backend&&this.backend.create){let s={...n,isUpdate:o},g=this.backend.create.bind(this.backend);if(g.length<6)try{let I;g.length===5?I=g(t,A,i,r,s):I=g(t,A,i,r),I&&typeof I.then=="function"?I.then(l=>a(null,l)).catch(a):a(null,I)}catch(I){a(I)}else g(t,A,i,r,a,s)}!t||!t[0]||this.store.addResource(t[0],A,i,r)}}};function vI(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let A={};if(typeof t[1]=="object"&&(A=t[1]),typeof t[1]=="string"&&(A.defaultValue=t[1]),typeof t[2]=="string"&&(A.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){let i=t[3]||t[2];Object.keys(i).forEach(r=>{A[r]=i[r]})}return A},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function TI(e){return typeof e.ns=="string"&&(e.ns=[e.ns]),typeof e.fallbackLng=="string"&&(e.fallbackLng=[e.fallbackLng]),typeof e.fallbackNS=="string"&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Oi(){}function QQ(e){Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(A=>{typeof e[A]=="function"&&(e[A]=e[A].bind(e))})}var Zi=class e extends oA{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=arguments.length>1?arguments[1]:void 0;if(super(),this.options=TI(t),this.services={},this.logger=qe,this.modules={external:[]},QQ(this),A&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,A),this;setTimeout(()=>{this.init(t,A)},0)}}init(){var t=this;let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;typeof A=="function"&&(i=A,A={}),!A.defaultNS&&A.defaultNS!==!1&&A.ns&&(typeof A.ns=="string"?A.defaultNS=A.ns:A.ns.indexOf("translation")<0&&(A.defaultNS=A.ns[0]));let r=vI();this.options={...r,...this.options,...TI(A)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...r.interpolation,...this.options.interpolation}),A.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=A.keySeparator),A.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=A.nsSeparator);function o(I){return I?typeof I=="function"?new I:I:null}if(!this.options.isClone){this.modules.logger?qe.init(o(this.modules.logger),this.options):qe.init(null,this.options);let I;this.modules.formatter?I=this.modules.formatter:typeof Intl<"u"&&(I=So);let l=new Xi(this.options);this.store=new zi(this.options.resources,this.options);let c=this.services;c.logger=qe,c.resourceStore=this.store,c.languageUtils=l,c.pluralResolver=new Do(l,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),I&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(c.formatter=o(I),c.formatter.init(c,this.options),this.options.interpolation.format=c.formatter.format.bind(c.formatter)),c.interpolator=new Fo(this.options),c.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},c.backendConnector=new ko(o(this.modules.backend),c.resourceStore,c,this.options),c.backendConnector.on("*",function(u){for(var m=arguments.length,y=new Array(m>1?m-1:0),C=1;C<m;C++)y[C-1]=arguments[C];t.emit(u,...y)}),this.modules.languageDetector&&(c.languageDetector=o(this.modules.languageDetector),c.languageDetector.init&&c.languageDetector.init(c,this.options.detection,this.options)),this.modules.i18nFormat&&(c.i18nFormat=o(this.modules.i18nFormat),c.i18nFormat.init&&c.i18nFormat.init(this)),this.translator=new Wi(this.services,this.options),this.translator.on("*",function(u){for(var m=arguments.length,y=new Array(m>1?m-1:0),C=1;C<m;C++)y[C-1]=arguments[C];t.emit(u,...y)}),this.modules.external.forEach(u=>{u.init&&u.init(this)})}if(this.format=this.options.interpolation.format,i||(i=Oi),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){let I=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);I.length>0&&I[0]!=="dev"&&(this.options.lng=I[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(I=>{this[I]=function(){return t.store[I](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(I=>{this[I]=function(){return t.store[I](...arguments),t}});let s=HA(),g=()=>{let I=(l,c)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),s.resolve(c),i(l,c)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return I(null,this.t.bind(this));this.changeLanguage(this.options.lng,I)};return this.options.resources||!this.options.initImmediate?g():setTimeout(g,0),s}loadResources(t){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Oi,r=typeof t=="string"?t:this.language;if(typeof t=="function"&&(i=t),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return i();let o=[],n=a=>{if(!a||a==="cimode")return;this.services.languageUtils.toResolveHierarchy(a).forEach(g=>{g!=="cimode"&&o.indexOf(g)<0&&o.push(g)})};r?n(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(s=>n(s)),this.options.preload&&this.options.preload.forEach(a=>n(a)),this.services.backendConnector.load(o,this.options.ns,a=>{!a&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),i(a)})}else i(null)}reloadResources(t,A,i){let r=HA();return t||(t=this.languages),A||(A=this.options.ns),i||(i=Oi),this.services.backendConnector.reload(t,A,o=>{r.resolve(),i(o)}),r}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&_I.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let A=0;A<this.languages.length;A++){let i=this.languages[A];if(!(["cimode","dev"].indexOf(i)>-1)&&this.store.hasLanguageSomeTranslations(i)){this.resolvedLanguage=i;break}}}changeLanguage(t,A){var i=this;this.isLanguageChangingTo=t;let r=HA();this.emit("languageChanging",t);let o=s=>{this.language=s,this.languages=this.services.languageUtils.toResolveHierarchy(s),this.resolvedLanguage=void 0,this.setResolvedLanguage(s)},n=(s,g)=>{g?(o(g),this.translator.changeLanguage(g),this.isLanguageChangingTo=void 0,this.emit("languageChanged",g),this.logger.log("languageChanged",g)):this.isLanguageChangingTo=void 0,r.resolve(function(){return i.t(...arguments)}),A&&A(s,function(){return i.t(...arguments)})},a=s=>{!t&&!s&&this.services.languageDetector&&(s=[]);let g=typeof s=="string"?s:this.services.languageUtils.getBestMatchFromCodes(s);g&&(this.language||o(g),this.translator.language||this.translator.changeLanguage(g),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(g)),this.loadResources(g,I=>{n(I,g)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?a(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(t),r}getFixedT(t,A,i){var r=this;let o=function(n,a){let s;if(typeof a!="object"){for(var g=arguments.length,I=new Array(g>2?g-2:0),l=2;l<g;l++)I[l-2]=arguments[l];s=r.options.overloadTranslationOptionHandler([n,a].concat(I))}else s={...a};s.lng=s.lng||o.lng,s.lngs=s.lngs||o.lngs,s.ns=s.ns||o.ns,s.keyPrefix=s.keyPrefix||i||o.keyPrefix;let c=r.options.keySeparator||".",u;return s.keyPrefix&&Array.isArray(n)?u=n.map(m=>`${s.keyPrefix}${c}${m}`):u=s.keyPrefix?`${s.keyPrefix}${c}${n}`:n,r.t(u,s)};return typeof t=="string"?o.lng=t:o.lngs=t,o.ns=A,o.keyPrefix=i,o}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;let i=A.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,o=this.languages[this.languages.length-1];if(i.toLowerCase()==="cimode")return!0;let n=(a,s)=>{let g=this.services.backendConnector.state[`${a}|${s}`];return g===-1||g===2};if(A.precheck){let a=A.precheck(this,n);if(a!==void 0)return a}return!!(this.hasResourceBundle(i,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||n(i,t)&&(!r||n(o,t)))}loadNamespaces(t,A){let i=HA();return this.options.ns?(typeof t=="string"&&(t=[t]),t.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{i.resolve(),A&&A(r)}),i):(A&&A(),Promise.resolve())}loadLanguages(t,A){let i=HA();typeof t=="string"&&(t=[t]);let r=this.options.preload||[],o=t.filter(n=>r.indexOf(n)<0);return o.length?(this.options.preload=r.concat(o),this.loadResources(n=>{i.resolve(),A&&A(n)}),i):(A&&A(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";let A=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],i=this.services&&this.services.languageUtils||new Xi(vI());return A.indexOf(i.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=arguments.length>1?arguments[1]:void 0;return new e(t,A)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Oi,i=t.forkResourceStore;i&&delete t.forkResourceStore;let r={...this.options,...t,isClone:!0},o=new e(r);return(t.debug!==void 0||t.prefix!==void 0)&&(o.logger=o.logger.clone(t)),["store","services","language"].forEach(a=>{o[a]=this[a]}),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},i&&(o.store=new zi(this.store.data,r),o.services.resourceStore=o.store),o.translator=new Wi(o.services,r),o.translator.on("*",function(a){for(var s=arguments.length,g=new Array(s>1?s-1:0),I=1;I<s;I++)g[I-1]=arguments[I];o.emit(a,...g)}),o.init(r,A),o.translator.options=r,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}},ne=Zi.createInstance();ne.createInstance=Zi.createInstance;var vG=ne.createInstance,TG=ne.dir,qG=ne.init,_G=ne.loadResources,JG=ne.reloadResources,PG=ne.use,KG=ne.changeLanguage,OG=ne.getFixedT,LG=ne.t,YG=ne.exists,VG=ne.setDefaultNamespace,zG=ne.hasLoadedNamespace,WG=ne.loadNamespaces,XG=ne.loadLanguages;var be=U(K());var zI=U(Qe());var wQ=U(Qe(),1);var vA=U(Qe(),1);var mQ=U(PI());var LI=U(Qe(),1);var TA=(0,LI.createContext)();var ji=U(Qe(),1);var YI=U(Qe(),1);var VI=U(Qe(),1);var xQ=U(Qe(),1);var FQ=U(Qe(),1);var bQ=U(Qe());async function WI(e){let A=Dt(`/i18n/${e}.json`);return await(await fetch(A)).json()}async function Go({image:e,type:t,quality:A=1}){if(e instanceof Blob||e instanceof ImageBitmap)return NQ({image:e,type:t,quality:A});if(typeof e=="string"){let o=e;e=new Image,e.src=o}e.complete||await e.decode();let i=new OffscreenCanvas(e.naturalWidth,e.naturalHeight);return i.getContext("2d").drawImage(e,0,0),i.convertToBlob({type:t,quality:A})}async function NQ({image:e,type:t,quality:A=1}){if(e instanceof Blob&&e.type===t)return e;let i=e instanceof Blob?await createImageBitmap(e):e,r=new OffscreenCanvas(i.width,i.height);return r.getContext("2d").drawImage(i,0,0),r.convertToBlob({type:t,quality:A})}function XI(e){return!be.default.sidePanel||!be.default.sidePanel.open||e?.windowId===void 0?!1:be.default.sidePanel.open({windowId:e?.windowId}).then(async()=>be.default.runtime.getContexts?await be.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(A=>A.length>0):!1).catch(t=>!1)}function $I(e,t,A=new Map,i){for(let{children:r,i18nKey:o,...n}of e)t&&be.default.contextMenus.create({...n,parentId:i}),o&&A.set(n.id,o),r&&$I(r,t,A,n.id);return A}function ZI(e,t){let A=$I(e,t);return function(){let r=he.English;ne.init({resources:{},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1,defaultVariables:{APP_NAME:Qs,AI:"AI"}}}).then(()=>O("language",he.English)).then(o=>{o!==r&&(r=o,jI(o,A))}).finally(()=>{ps.subscribe(o=>{if(!qr(o,"language"))return;let n=o.language.newValue;n&&n!==r&&(r=n,jI(n,A))})})}}async function jI(e,t){if(!ne.hasResourceBundle(e,"translation")){let i=await WI(e);ne.addResourceBundle(e,"translation",i)}let A=ne.getFixedT(e,"translation");for(let[i,r]of t.entries())be.default.contextMenus.update(i,{title:A(r)})}function ec(){let e=[{id:"toggle-page-translation",documentUrlPatterns:["http://*/*","https://*/*"],title:"Translate the page / Show original text",i18nKey:"contextMenu.togglePageTranslation"},{contexts:["selection"],id:"query-selection",title:"Ask Sider",i18nKey:"contextMenu.askSider"},{contexts:["image"],title:"AI Image Tools",id:"ai-image-tools",i18nKey:"contextMenu.imageTools",children:[{contexts:["image"],id:"chat-with-image",title:"Chat with Image",i18nKey:"imageToolbar.chatWithImage"},{contexts:["image"],id:"extract-text-from-image",title:"Extract Text",i18nKey:"imageToolbar.extractText"},{contexts:["image"],id:"remove-background",title:"Remove Background",i18nKey:"imageToolbar.removeBackground"},{contexts:["image"],id:"remove-text",title:"Remove Text",i18nKey:"imageToolbar.removeText"},{contexts:["image"],id:"reomve-brushed-area",title:"Remove Brushed Area",i18nKey:"imageToolbar.inpaint"},{contexts:["image"],id:"replace-background",title:"Replace Background",i18nKey:"imageToolbar.replaceBackground"},{contexts:["image"],id:"upscale-image",title:"Upscale",i18nKey:"imageToolbar.upscale"},{contexts:["image"],id:"variation",title:"Create Variations",i18nKey:"imageToolbar.variation"}]}];be.default.runtime.onInstalled.addListener(()=>{ZI(e,!0)}),be.default.contextMenus.onClicked.addListener((A,i)=>{switch(A.menuItemId){case"toggle-page-translation":{let r=i?.id;if(r===void 0)return;zt("toggle-page-translation",null,{tabId:r});break}case"query-selection":{return XI(i),be.default.storage.local.set({initialSelectionText:A.selectionText}).then(()=>{});break}case"chat-with-image":case"extract-text-from-image":{(async function(){let r=A.srcUrl;if(!r)return;let o=A.menuItemId==="chat-with-image",n=["image/png","image/jpeg"];await XI(i),wt("lastTab",o?"chat":"ocr");let s=await(await fetch(r)).blob(),g=await createImageBitmap(s);n.includes(s.type)||(s=await Go({image:g,type:"image/png"}));let I=await je(s),l=!1;for await(let c of Ls())if(c){l=!0;break}zt(o?"send-image-to-chat":"send-image-to-ocr",{base64:I,imageUrl:r,width:g.width,height:g.height,type:s.type},l?{view:"sidebar"}:{tabId:i?.id})})();break}case"upscale-image":case"remove-background":case"remove-text":case"replace-background":case"reomve-brushed-area":case"variation":{let r=A.menuItemId,o=A.srcUrl;if(!o)return;(async function(){let n=["image/png","image/jpeg"],s=await(await fetch(o)).blob(),g=await createImageBitmap(s);n.includes(s.type)||(s=await Go({image:g,type:"image/png"}));let I=await je(s),l=await new Promise(async(c,u)=>{let m=new AbortController,y=setTimeout(()=>{m.abort(),c(C)},1e4);Z("website-painter-ready",({originalSender:w,sender:x})=>{x.tab?.id===C.id&&(m.abort(),clearTimeout(y),c(C))},{signal:m.signal});let C=await zr({subRoute:_r(r,{variation:"painter",_:r}),hasDataToSend:!0})});zt("send-image-to-image-tools",{toolName:r,base64:I,imageUrl:o,width:g.width,height:g.height,type:s.type},{tabId:l.id})})()}}}),ZI(e,!1)()}var $i=U(K());var Uo="do_ocr";async function Mo(e){$i.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(A=>{A?$i.default.runtime.sendMessage({type:Uo,data:{img:e,isForSidepanel:!0}}):t()}).catch(t);async function t(){Js({url:Dt("standalone.html")}),await Ft(500),$i.default.runtime.sendMessage({type:Uo,data:{img:e,isForSidepanel:!1}})}}async function Ho(){if(await O("language"))return;let t=navigator.languages;for(let A of t){A=A.replace("-","_");let i=A.split("_");i[0]=i[0].toLowerCase(),i[1]&&(i[1]=i[1].toUpperCase()),A=i.join("_");let r="";if(A in Nr?r=A:r=Object.keys(Nr).find(o=>i[0]===o.split("_")[0])||"",r){await F({__DONT_SYNC__:`language${Date.now()}`,language:r});return}}await F({__DONT_SYNC__:`language${Date.now()}`,language:he.English})}var tc=U(K());function Ac(){tc.default.storage.local.onChanged.addListener(e=>{if(e.__DONT_SYNC__?.newValue)return;let t=Object.keys(e).filter(A=>A in Ei);t.length&&GQ(t)})}var ic=async e=>{if(!await ce())return;await rc();let A=await M(e);A["provider:gpt3"]&&(A["provider:gpt3"].apiKey=""),er(A,"translatorHostConfig"),er(A,"quickActionInputIconDisabledHost"),er(A,"sidebarFabDisabledHost"),er(A,"webAssistantImageDisabledHost"),H.setUserSettings(A)},Ro=new Map,GQ=e=>{let t=e.sort().toString();Ro.has(t)||Ro.set(t,ue(ic,2e3)),Ro.get(t)?.(e)},rc=async()=>{let{promptTemplates:e,allPromptList:t,sidebarPromptTemplate:A}=await O(["promptTemplates","allPromptList","sidebarPromptTemplate"]),i=!1;e&&(await Promise.all(e.map(async r=>{if(r.canEdit&&!r.uid){i=!0;let o=await H.createUserPrompt({type:"search",name:r.title,content:r.template});r.uid=o.id}})),i&&await F({__DONT_SYNC__:`unsavedSearchTpl${Date.now()}`,promptTemplates:e})),i=!1,t&&(await Promise.all(t.map(async r=>{if(!r.id){i=!0;let o=await H.createPrompt({key:r.key,name:r.name,content:r.content,use:r.usedIn});if(r.id=String(o.id),A){let n=A.find(({key:a})=>a===r.key);n&&(n.uid=o.id)}}})),i&&await F({__DONT_SYNC__:`unsavedSidebarTpl${Date.now()}`,allPromptList:t,sidebarPromptTemplate:A}))},oc=async()=>{if(!await ce())throw new Error("login required");await rc(),await UQ(),await MQ()};async function UQ(){let e=Object.keys(Ei),t={...await H.getUserSettings()||{}};if(!t||!Object.keys(t).length){await ic(e);return}for(let r of Object.keys(t))(!(r in Ei)||t[r]===null)&&delete t[r];let A=await M(e),i;A["provider:gpt3"]&&(i=A["provider:gpt3"].apiKey),tr(t,"translatorHostConfig"),tr(t,"quickActionInputIconDisabledHost"),tr(t,"sidebarFabDisabledHost"),tr(t,"webAssistantImageDisabledHost"),["chatVisiblePromptKeys","readVisiblePromptKeys","writeVisiblePromptKeys"].forEach(r=>{delete t[r]}),lA(A,t,{"provider:gpt3":{apiKey:i}},(r,o)=>{if(Array.isArray(r))return o}),await F({__DONT_SYNC__:`pullFromCloud${Date.now()}`,...A})}async function MQ(){let e=await O("promptTemplates",[]),t=[],A=await H.getUserPromptList("search");if(A?.List?.length){for(let r of A.List)if(r.name){let o={id:r.id,uid:r.id,title:r.name,template:r.content,canEdit:!0};t.push(o)}}let i=e.filter(r=>!r.canEdit);i?.length||(i=[...ze]),await F({__DONT_SYNC__:`pullSearchTpl${Date.now()}`,promptTemplates:[...t,...i]})}function er(e,t){let A=[];if(e[t]&&typeof e[t]=="object"){for(let[i,r]of Object.entries(e[t]))i!=="undefined"&&A.push({__key__:i,...r||{}});e[t]=A}}function tr(e,t){let A={};if(Array.isArray(e[t])){for(let i of e[t])i.__key__&&i.__key__!=="undefined"&&(A[i.__key__]=i,delete i.__key__);e[t]=A}}function nc(){Mr("logged",e=>{HQ(!!e.logged?.newValue)}),Mr(["language"],async e=>{if(typeof e.language?.oldValue>"u")return;await ce()&&(H.getAllPromptList(),H.checkCanTrial()),Ae("systemVoiceDemoText")})}var HQ=e=>{e?RQ():vQ()},RQ=ue(()=>{vo(["getVipPeriodInfo","getUserInfo","getVipInfo","pullSettingsFromCloud","getAllPromptList","getVoiceRoleList","inviteFinishCallback","getUserStatus","checkCanTrial"].map(t=>_e(t)))},3e3,{leading:!0}),vQ=()=>{Ae("userInfo")},ac=Re(async()=>{let{__invited_reward_finish__:e}=await M({__invited_reward_finish__:!1});if(e)return;if(await ce()){let A=await H.inviteFinish();A.is_invited&&A.is_rewarded&&(F({userIsInvited:!0,inviteRewardConfig:{"gpt3.5":A.reward.GPT3Dot5Count,gpt4:A.reward.GPT4Count}}),A.already_rewarded||F({__show_invited_reward__:!0})),F({__invited_reward_finish__:!0})}},1e4);function _e(e,t=0){return Ps(e,async()=>{switch(e){case"getVipPeriodInfo":await H.getVipPeriodInfo();break;case"getVipInfo":await H.getVipInfo();break;case"getUserInfo":await H.getUserInfo();break;case"getUserStatus":await H.getUserStatus();break;case"pullSettingsFromCloud":await oc();break;case"inviteFinishCallback":await ac();break;case"getPricingPlan":await H.getPricingPlan();break;case"getAllPromptList":await H.getAllPromptList();break;case"getClientConfig":await H.getClientConfig();break;case"checkCanTrial":await H.checkCanTrial();break;case"getVoiceRoleList":await H.getVoiceRoleList();break;case"getDomainPool":await Ag();break;default:break}},t)()}async function To(e){await Ae("__manual_logout__"),await Ho();let t=await ce();F({logged:t}),sc([],e)}async function sc(e,t){let A=await ce(),r=[{name:"getAllPromptList",cacheDuration:t?0:1/0},{name:"getPricingPlan",cacheDuration:t?0:864e5},{name:"getClientConfig",cacheDuration:t?0:1/0},{name:"getDomainPool",cacheDuration:t?0:1/0},...A?[{name:"getVipPeriodInfo",cacheDuration:t?0:864e5},{name:"getUserInfo",cacheDuration:t?0:864e5},{name:"getVipInfo",cacheDuration:0},{name:"pullSettingsFromCloud",cacheDuration:1/0},{name:"getVoiceRoleList",cacheDuration:t?0:864e5},{name:"inviteFinishCallback",cacheDuration:1/0},{name:"getUserStatus",cacheDuration:t?0:864e5},{name:"checkCanTrial",cacheDuration:864e5}]:[]],o=e&&e.length>0?r.filter(n=>e.includes(n.name)):r;await vo(o.map(n=>_e(n.name,n.cacheDuration)))}async function vo(e){let t=[];(await Promise.allSettled(e)).forEach(i=>{if(i.status==="rejected"){let r=i.reason?.message;r&&t.push(r)}}),t.length>0?await F({__requestDataFailedJobNames__:t}):await Ae("__requestDataFailedJobNames__")}async function gc(){return(await Ic()).length>0}async function Ic(){let{__requestDataFailedJobNames__:e}=await M({__requestDataFailedJobNames__:[]});return e}async function cc(){let e=await Ic();e.length>0&&await sc(e)}var lc=U(K());async function uc(){let e={},t=["p","p1","p2"],A=ge?`https://*.microsoft.com/*${dA}*`:`https://*.google.com/*${dA}*`,i=await lc.default.tabs.query({url:A,currentWindow:!0});if(i.length){i.reverse();for(let r of i){let o=r.url||Y.origin,{searchParams:n}=new URL(o),a=!1;for(let[s,g]of n.entries())t.includes(s)&&g&&(a=!0,e[s]=g);if(a)break}}if(Object.keys(e).length>0)for(let[r,o]of Object.entries(e))await vr(r==="p"?"source":r,o,7);else for(let r of t){let o=await Fi(r==="p"?"source":r);o&&(e[r]=o)}if(Object.keys(e).length){H.adStat({action:"install-sider-successfully",source:e.p||"",p1:e.p1||"",p2:e.p2||""});let r=TQ(e.p1||""),o={installByAD:!0,onBoardFrom:r};(r==="grammar"||r==="translate"||r==="write"||r==="ocr")&&(o.lastTab=r==="write"?"compose":r),await F(o)}}function TQ(e){return e.includes("ytb")?"ytb":e.includes("translate")?"translate":e.includes("ocr")?"ocr":e.includes("write")?"write":e.includes("bgremover")?"bgremover":e.includes("chatpdf")?"pdf":e.includes("summarizer")?"summary":e.includes("grammar")?"grammar":e.includes("image")?"painter":e.includes("email")?"email":""}var qo=U(K());var fc="OpenAI";async function qQ(e,t){let A=await qo.default.storage.local.get("provider:gpt3"),{apiKey:i,enableCustomURL:r,customURL:o}=A["provider:gpt3"];if(i){let n=r&&o?ki(o):_Q;return fetch(n+t,{method:e,headers:{"Content-Type":"application/json",Authorization:`Bearer ${A["provider:gpt3"].apiKey}`}}).then(a=>a.json())}else return!1}async function Bc(){return qQ("GET","/v1/models")}var _Q="https://api.openai.com",Ar=class{constructor(t,A,i){this.token=t;this.model=A;this.url=i;this.token=t,this.model=A,this.url=i}async generateAnswer(t){let A="",i=ct(this.url?this.url:"https://api.openai.com","/v1","/chat/completions"),r=await qo.default.storage.local.get({enableCustomModelName:!1,customModelName:""}),o={model:r.enableCustomModelName&&r.customModelName?r.customModelName:t.model||this.model,stream:!0};Array.isArray(t.prompt)?o.messages=t.prompt:o.messages=[{role:"user",content:t.prompt}],await eA(i,{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.token}`},body:JSON.stringify(o),onMessage(n){if(n==="[DONE]"){t.onEvent({type:"done"});return}let a;try{a=JSON.parse(n);let s=a.choices[0].delta.content;if(a.choices[0].finish_reason==="stop"){t.onEvent({type:"done"});return}if(s==="<|im_end|>"||s==="<|im_sep|>"||!s)return;A+=s,t.onEvent({type:"answer",data:{text:A,messageId:a.id,conversationId:""}})}catch{return}}}).catch(n=>{let a=n.message;try{let s=JSON.parse(a);if(a=s.message||s.msg||s.error?.message||s.detail?.message||a,[502,503].includes(s.responseStatus))throw new Error(`${fc}: error_service_unavailable`)}catch{}throw new Error(`${fc}: ${a}`)})}};var dc=U(K());var ir=class{constructor(){this.results=[];this.lastText="";this.lastTextIndex=-1}parse(t){return t.type==="text"?this.handleTextMsg(t):t.type==="tool_call"?this.handleToolCallMsg(t):t.type==="llm_status"?this.handleLLMStatusMsg(t):t.type==="image"?this.handleImageMsg(t):t.type==="data_analysis_image"?this.handleDataAnalysisImage(t):t.type==="key_moments"?this.handleKeyMomentsMsg(t):t.type==="file_highlight"?this.handleFileHighlightMsg(t):t.type==="notification"&&this.handleNotificationMsg(t),t.type!=="text"&&(this.lastText="",this.lastTextIndex=-1),this.results}getLastResult(){return this.results[this.results.length-1]}handleLLMStatusMsg(t){let A=t.llm_status.id,i=this.results.findIndex(r=>r.id===A);this.results[i]?this.results[i]={...t.llm_status}:this.results.push({type:"llmStatus",id:A,status:t.llm_status.status,data:t.llm_status.data})}handleNotificationMsg(t){this.results.push({type:"notification",id:$(),notification:t.notification})}handleKeyMomentsMsg(t){t.key_moments&&this.results.push({type:"videoKeyMoments",keyMoments:t.key_moments,id:$()})}handleTextMsg(t){if(t.text)if(this.lastText){let A=this.lastText+t.text,i=pc(A),r=this.results.splice(this.lastTextIndex),o=PQ(r,i.map(n=>({type:n.type==="markdown"?"text":n.type==="artifact"?"artifact":"thinking",text:n.type==="artifact"?n.content.replace(/^\n```(.*)\n/,`
`).replace(/```\n$/,`
`).replace(/^```(.*)\n/,`
`).replace(/```$/,`
`):n.content,attrs:n.type==="artifact"?n.attributes:{},status:n.type==="artifact"||n.type==="thinking"?n.isFinished?"finish":"start":void 0,id:$()})));this.results=this.results.concat(o),this.lastText=A}else{let A=pc(t.text);/<Thinking/.test(t.text)&&A.length===0&&A.push({type:"thinking",content:"",isFinished:!1}),/<Artifact/.test(t.text)&&A.length===0&&A.push({type:"artifact",content:"",attributes:{},isFinished:!1}),this.results=this.results.concat(A.map(i=>({type:i.type==="markdown"?"text":i.type==="artifact"?"artifact":"thinking",text:i.type==="artifact"?i.content.replace(/^\n```(.*)\n/,`
`).replace(/```\n$/,`
`).replace(/^```(.*)\n/,`
`).replace(/```$/,`
`):i.content,attrs:i.type==="artifact"?i.attributes:{},status:i.type==="artifact"||i.type==="thinking"?i.isFinished?"finish":"start":void 0,id:$(),createAt:Date.now()}))),this.lastTextIndex=this.results.length-1,this.lastText=t.text}}handleToolCallMsg(t){let A=t.tool_call.id+(t.tool_call.data&&typeof t.tool_call.data.tool_call_id<"u"?t.tool_call.data.tool_call_id:"");if(t.tool_call.status==="start")this.results.push({type:"toolCall",id:A,status:t.tool_call.status,name:t.tool_call.name,data:t.tool_call.data});else if(t.tool_call.status==="processing"){let i=this.results.findIndex(o=>o.id===A),r=this.results[i];r&&(r.data={...r.data,...t.tool_call.data})}else if(t.tool_call.status==="finish"||t.tool_call.status==="fail"){let i=this.results.findIndex(o=>o.id===A),r=this.results[i];r&&(r.data={...r.data,...t.tool_call.data},r.status=t.tool_call.status)}}handleImageMsg(t){this.results.push({type:"siderImage",id:$(),images:t.images.images})}handleDataAnalysisImage(t){this.results.push({type:"siderImage",id:$(),images:[t.data_analysis_image]})}handleFileHighlightMsg(t){this.results.push({type:"fileHighlights",id:$(),highlights:t.highlights})}};function pc(e,t){let A=e.split(/(<Artifact[^>]*>?|<\/Artifact>|<Thinking>|<\/Thinking>)/),i=!1,r=!1,o={},n=[],a="",s=null,g=null,I=null,l="";for(let c=0;c<A.length;c++){let u=A[c];u.startsWith("<Artifact")?(a&&(n.push({type:"markdown",content:a.trim()}),a=""),u.endsWith(">")?(i=!0,o=JQ(u),g={type:"artifact",content:"",attributes:o,isFinished:!1},t&&o.id===t&&(s=g)):l=u):u==="</Artifact>"?i&&g?(i=!1,g.isFinished=!0,g.content=g.content.trim(),s!==g&&n.push(g),g=null):l+=u:u==="<Thinking>"?(a&&(n.push({type:"markdown",content:a.trim()}),a=""),r=!0,I={type:"thinking",content:"",isFinished:!1}):u==="</Thinking>"?r&&I&&(r=!1,I.isFinished=!0,I.content=I.content.trim(),n.push(I),I=null):i?g&&(g.content+=u):r?I&&(I.content+=u):l?(l+=u,l.includes("<Artifact")||(a+=l,l="")):a+=u}return a&&n.push({type:"markdown",content:a.trim()}),g&&n.push(g),I&&n.push(I),s||(t?null:(n=n.filter(c=>!(c.type==="markdown"&&c.content.trim()==="")),n))}function JQ(e){let t={},A=/(\w+)\s*=\s*(?:"([^"]*)"|'([^']*)'|([^>\s]+))/g,i;for(;(i=A.exec(e))!==null;){let[,r,o,n,a]=i;t[r]=o||n||a}return t}function PQ(e,t){if(e.length>t.length)return e;let A=[...e],i=t.length,r=Math.max(0,e.length-i);for(let o=0;o<i;o++){let n=r+o;if(n<A.length)for(let a in t[o])a!=="id"&&(A[n][a]=t[o][a]);else A.push({...t[o]})}return A.length,A}var rr=class{constructor(t){this.token="";this.refreshToken="";this.anonymous=!0;this.checkFileStatusTimer=null;this.cid=t}async getToken(){let t=await ut();this.token=t.token,this.refreshToken=t.refreshToken,this.anonymous=t.anonymous}async generateAnswer(t){let A={},i=null,r={};try{await this.getToken()}catch(B){throw new Error(B.errMsg)}if(!this.cid&&t.historyMsg)try{this.cid=await H.uploadHistoryMsg(t.historyMsg)}catch(B){throw new Error(B.errMsg)}let{[CA]:{model:o}}=await M({[CA]:{model:"sider"}}),n=t.model||o,a="",s="",g=!1;function I(){!g&&a&&s&&H.statUserStop(a,s),i&&clearInterval(i)}t.getCleanupMethod?.(I);async function l(B){let D=B.join(","),{text_ready:b}=await H.getFileStauts(D);return b}async function c(B){let{handle_msg:D,is_embedding:b}=await H.getFileStauts(B),S=null;if(b)try{S=JSON.parse(D)}catch{if(D)throw new Error(D)}else S={accept_model:{"gpt-3.5":!0,"gpt-4":!0,"gpt-4o":!0,"gpt3.5-16k":!0,"claude-instant":!0,claude2:!0,"claude-3-haiku":!0,"claude-3-sonnet":!0,"claude-3.5-sonnet":!0,"claude-3-opus":!0,bard:!0,"gemini-pro":!0,"gemini-1.5-pro":!0,"gemini-1.5-flash":!0,gpts:!0,"llama-3":!0}};return S}async function u(B,D){let{fileTextStatus:b}=await dc.default.storage.local.get({fileTextStatus:{}});if(B.filter(G=>b[G]).length===B.length)return null;let S=await l(B);return S?(QA(B,!0),null):new Promise((G,Q)=>{i=setInterval(async()=>{try{S=await l(B),S&&(QA(B,!0),i&&(clearInterval(i),G(null)))}catch(k){throw i&&clearInterval(i),new Error(k)}},1e3)})}t.eids&&t.sPromptTmpl&&await u(t.eids,n).catch(B=>{throw new Error("Getting file status error: "+B.toString())});let m=async(B,D,b)=>{try{return await eA(B,{method:"POST",signal:t.signal,headers:{"Content-Type":"application/json",Authorization:this.token},body:JSON.stringify(D),onMessage(S){if(S=="[DONE]"){g=!0,t.onEvent({type:"done"});return}let G=JSON.parse(S);if(G.code!==0)throw new Error(JSON.stringify({code:G.code,msg:G.msg||G.message}));a=G.data.cid,s=G.data.message_id,F({lastMessageId:s}),b(G.data)}})}catch(S){let G=S.message,Q=null;try{Q=JSON.parse(G)}catch{}SA(Q?.code,Q?.msg||Q?.message||G)}};function y(){let B={},D=t.autoTools||[],b=t.sPromptTmpl?[t.sPromptTmpl]:[];if(!b.length){let S=[];(D.includes("artifacts")||D.includes("thinking_mode"))&&(D.includes("artifacts")&&S.push({key:"artifacts",attributes:{lang:"original"}}),D.includes("thinking_mode")&&S.push({key:"thinking_mode",attributes:{}}),b=S)}return B.auto=D.filter(S=>S!=="artifacts"&&S!=="thinking_mode"),t.forceSearch?B.force="search":b&&(Array.isArray(b)?b.length>0&&!b.some(S=>S?.key==="artifacts"||S?.key==="thinking_mode"):b&&b.key!=="artifacts"&&b.key!=="thinking_mode")&&(B.force="reader"),t.forceTool&&(B.force=t.forceTool),{tools:B,sPromptTmpl:b}}let C=new xi,w=await Xe(),x=await Zt(),{outputLanguage:N}=await M({outputLanguage:""}),E=Date.now(),p=0,{tools:f,sPromptTmpl:d}=y();await m(`${x}/v3/completion/text`,{system:t.system,prompt:t.prompt,stream:!0,app_name:q,app_version:ae,tz_name:re,cid:this.cid,model:n,search:t.forceSearch,auto_search:t.autoSearch,filter_search_history:t.filterSearchHistory,from:t.from,re_answer_by_mid:t.sReqId,group_id:t.from==="chat"?"default":void 0,prompt_key:t.promptKey,chat_models:t.chatModels,image_id:t.imageId,eid:t.eid,files:t.eids,force_ocr:t.forceOcr,ocr_option:t.ocrOption,prompt_template:d.length===1&&d[0]&&!d[0].key.includes("video-summarize")?d[0]:void 0,prompt_templates:d.length>1?d:void 0,deep_search:t.deepSearch,tools:f,extra_info:{origin_url:w?.url,origin_title:w?.title},video_summarize:t.sPromptTmpl?.key.includes("video-summarize")?{enable:!0,language:t.sPromptTmpl?.attributes.lang}:void 0,search_option:t.searchOption,output_language:t.from==="chat"&&N?N.replace("_","-"):void 0},B=>{if(!B)return;if(typeof B.total<"u"){let G=B.chat_model?B.chat_model:n;B.quota_type==="fast_text"?G="gpt-3.5":B.quota_type==="advanced_text"&&(G="gpt-4");let Q={[G]:{total:B.total,remain:B.remain,extraTotal:B.extra_total,extraRemain:B.extra_quota,period:B.remain_period,used:B.used}};FA().then(k=>{let R=k[G];(R.remain!==Q[G].remain||R.extraRemain!==Q[G].extraRemain||R.period!==Q[G].period||R.extraTotal!==Q[G].extraTotal||R.total!==Q[G].total||R.used!==Q[G].used||R.period!==Q[G].period)&&(R.remain+R.extraRemain>Q[G].remain+Q[G].extraRemain||R.used!==Q[G].used||B.type==="quota")&&C.run(()=>Se(Q))})}B.type==="feature_used"&&B.feature_info&&lt(B.quota_type==="fast_text"?"gpt-3.5":"gpt-4",B,B.feature_info);let D=B.text,b=B.chat_model||n;(D||B.type!=="pulse")&&(p===0&&(p=Date.now()-E),A[b]||(A[b]=""),r[b]||(r[b]={parser:null,contents:[]},r[b].parser=new ir),D&&(A[B.chat_model]+=D),r[b].contents=r[b].parser.parse(B),t.onEvent({type:"answer",data:{text:A[b],contents:r[b].contents,messageId:B.message_id,serverRequestId:B.req_message_id,conversationId:B.cid,chatModel:B.chat_model}})),B.code&&B.code!==0&&t.onEvent({type:"error",data:{error:Xr(B.code,B.msg),chatModel:B.chat_model||n}}),B.done&&t.onEvent({type:"done",data:{chatModel:B.chat_model||n,done:!0}}),B.type==="tool_call"&&B.tool_call.name==="search"&&t.onEvent({type:"searchKeywords",data:{searchKeywords:B.tool_call.data.keywords,searchSnippets:B.tool_call.data.snippets,chatModel:B.chat_model}}),B.type==="deep_search"&&t.onEvent({type:"deepSearch",data:{deep_search:B.deep_search,cid:B.cid,message_id:B.message_id}})});try{js.report("send_message",{conversation_id:this.cid,model:t.chatModels&&t.chatModels?.length>0?t.chatModels.join(","):n,prompt_id:t.promptKey||t.sPromptTmpl?.key,uploaded_files:t.eids?.join(","),tool_enabled:f.auto.join(",")})}catch{}}};var Qc=ue(Re(async()=>{await ce()&&(await gc()&&await cc(),await Promise.allSettled([_e("getVipInfo",30*6e4),_e("pullSettingsFromCloud",6*36e5),_e("getAllPromptList",6*36e5),_e("getClientConfig",36e5),_e("getDomainPool",30*6e4)]))}),5e3,{leading:!0});var Jo=U(K());var mc=ue(async e=>{let t=await Jo.default.storage.local.get({promptTemplates:ze}),A=ze.reduce((i,{id:r},o)=>(i[r]=ze[o],i),{});for(let i of t.promptTemplates)i.id in A&&(i.title=e[i.id].title,i.template=e[i.id].template);Jo.default.storage.local.set({__DONT_SYNC__:`searchPromptTPL${Date.now()}`,...t})},200);var Po=U(K());function hc(e){Po.default.storage.local.get({userClickedWidgets:[]}).then(t=>{let A=e.filter(i=>!t.userClickedWidgets.includes(i));Po.default.storage.local.set({needShowTipWidgets:A})})}nc();Ac();h.default.runtime.onStartup.addListener(()=>{h.default.storage.local.remove("searchAgentSuggestionsCache"),To()});async function KQ(e,{system:t,question:A,type:i,cid:r,historyMsg:o,model:n,chatModels:a,pluginIds:s,forceSearch:g,autoSearch:I,filterSearchHistory:l,from:c,promptKey:u,imageId:m,eids:y,forceOcr:C,ocrOption:w,forceProvider:x,sPromptTmpl:N,parentMsgId:E,chatgptFiles:p,actionData:f,autoTools:d,forceTool:B,deepSearch:D,sReqId:b,searchOption:S}){let G=await Fs(),Q,k=x||G.provider;if(k==="chatgpt"){let v=await le({onRefresh:()=>e.postMessage({event:"GUARD_TAB_REFRESHING"}),throwGuideError:!0});Q=new Ji(v)}else if(k==="gpt3"){let{apiKey:v,enableCustomURL:de,customURL:Je,model:dt}=G.configs.gpt3,JA=de&&Je?ki(Je):"";Q=new Ar(v,dt||br,JA)}else if(k==="siderApi")Q=new rr(r);else throw new Error(`Unknown provider ${k}`);let R=()=>{},T=new AbortController;e.onDisconnect.addListener(()=>{T.abort(),R?.()}),await Q.generateAnswer({system:t,prompt:A,type:i,signal:T.signal,historyMsg:o,pluginIds:s,onEvent(v){if(v.type==="done"){v.data?.chatModel?e.postMessage(v.data):e.postMessage({event:"DONE"});return}e.postMessage(v.data)},getCleanupMethod(v){R=v},forceSearch:g,autoSearch:I,filterSearchHistory:l,from:c,promptKey:u,model:n,chatModels:a,imageId:m,eids:y,forceOcr:C,ocrOption:w,sPromptTmpl:N,cid:r,parentMsgId:E,chatgptFiles:p,actionData:f,autoTools:d,forceTool:B,deepSearch:D,sReqId:b,searchOption:S})}var OQ=async e=>{let t=await O("webAppModelsLastUpdateTime"),A=await O("webAppModels");if(e||!A||!t||t-Date.now()>1e3*60*60*24)return Promise.all([CI(),QI()]).then(([i,r])=>{let o=r.gizmos.reduce((a,s)=>(a[s.resource.gizmo.id]=s,a),{}),n=r.gizmos.map(a=>a.resource.gizmo.id);return h.default.storage.local.get(["webAppGPTs","selectWebAppModel"]).then(a=>{let g={...a.webAppGPTs||{},...o};xs.forEach(l=>{g[l]||(g[l]=bs[l])});let I={webAppGPTsList:n,webAppGPTs:g,webAppModels:i.models,webAppModelsLastUpdateTime:Date.now()};return a.selectWebAppModel||(i.models.some(l=>l.slug==="gpt-4")?I.selectWebAppModel="gpt-4":I.selectWebAppModel="text-davinci-002-render-sha"),h.default.storage.local.set(I)})})},LQ=()=>Bc().then(async e=>{if(e.data){let t=e.data.filter(r=>r.id.startsWith("gpt-3.5")||r.id.startsWith("gpt-4")).map(r=>({name:r.id})),A=await O("provider:gpt3"),i={apiModels:t};return A&&A.model&&(t.find(r=>r.name===A.model)||(i["provider:gpt3"]={...A,model:br})),h.default.storage.local.set(i)}else return e.error?.message||"error"}),Ko=null;h.default.runtime.onConnect.addListener(e=>{if(e.name==="artifacts-page"){Ko&&clearTimeout(Ko),e.onDisconnect.addListener(()=>{Ko=setTimeout(()=>{h.default.storage.local.remove("artifactsData")},500)});return}if(e.name==="sidepanel"){e.onDisconnect.addListener(()=>{h.default.storage.local.set({sidebarLastCloseTime:Date.now(),webAppNetwork:null}),h.default.storage.local.remove("chatRequirements")}),e.onMessage.addListener(A=>{});return}qs(e)||e.onMessage.addListener(async A=>{try{await KQ(e,{system:A.system,question:A.question,type:A.type,cid:A.cid,historyMsg:A.historyMsg,chatModels:A.chatModels,model:A.model,pluginIds:A.pluginIds,autoSearch:A.autoSearch,forceSearch:A.forceSearch,filterSearchHistory:A.filterSearchHistory,from:A.from,promptKey:A.promptKey,imageId:A.imageId,eids:A.eids,forceOcr:A.forceOcr,ocrOption:A.ocrOption,forceProvider:A.forceProvider,sPromptTmpl:A.sPromptTmpl,parentMsgId:A.parentMsgId,chatgptFiles:A.chatgptFiles,actionData:A.actionData,autoTools:A.autoTools,forceTool:A.forceTool,deepSearch:A.deepSearch,sReqId:A.sReqId,searchOption:A.searchOption})}catch(i){e.postMessage({error:i.message})}})});Ur("email-enhance-reply",e=>{e.onMessage(t=>{Sg(t,{signal:e.signal,onStream(A){A.done?(e.send({done:!0}),e.close()):e.send({data:A.data})}}).catch(A=>{A.name!=="AbortError"&&(e.send({error:fA(A)}),e.close())})})});Ur("email-enhance-summary",e=>{e.onMessage(t=>{Fg(t,e.signal).then(A=>e.send({data:A})).catch(A=>{A.name!=="AbortError"&&e.send({error:fA(A)})}).finally(()=>e.close())})});h.default.runtime.onMessage.addListener(async(e,t)=>{let A=Hs(e,t);if(A)return A;switch(e.type){case"FEEDBACK":{let i=await Qo();await dI(i,e.data);break}case"OPEN_OPTIONS_PAGE":{Tr(e.section,e.hash,e.otherParams);break}case"GET_ACCESS_TOKEN":return Qo();case"SEND_CHATGPT":return Wg({prompt:e.promt});case"IS_CHAT_LOGIN":return Ks().then(i=>{t.tab?.id&&h.default.tabs.sendMessage(t.tab.id,{type:"CHAT_LOGIN_STATE",value:i}),h.default.runtime.sendMessage({type:"CHAT_LOGIN_STATE",value:i})});case"POPUP_OPEN":return _A(e.isShow);case"OPEN_URL_IN_NEW_TAB":return h.default.tabs.create(e.details);case"OPEN_URL":{h.default.tabs.create({url:e.url});break}case"UPDATE_TAB":return _s(e.queryInfo,e.updateDetails);case"RELOAD_TAB":return Si(e.queryInfo,!0);case"SWITCH_TAB":return Si(e.queryInfo);case"GET_CHATGPT_MODELS":return OQ(e.isForce);case"GET_API_MODELS":return LQ();case"GET_COOKIE":try{let i=await h.default.cookies.get(e.data);return i?.value?decodeURIComponent(i.value):""}catch(i){return Promise.reject(i)}case"SET_COOKIE":try{return await h.default.cookies.set(e.data)}catch(i){return Promise.reject(i)}case"SET_PROMPT_BY_I18N":{if(e.tplType==="search")return mc(e.translation);break}case"CHECK_SCHEDULE_JOB":{Qc();break}case"REFRESH_VIP_INFO":{Ze(async()=>{if((await H.getVipInfo()).isVIP){let{autoTools:r,isDoneAutoToolsAction:o}=await h.default.storage.local.get(["autoTools","isDoneAutoToolsAction"]);(r===void 0||r&&r.length===0)&&!o&&F({autoTools:Ns,isDoneAutoToolsAction:!0})}else throw new Error("")},2e3);break}case"UPDATE_USERINFO":{await H.getUserInfo();break}case"USER_LOGIN":{await F(Object.keys(Wr).reduce((i,r)=>{let o=e?.data[r];return o&&(i[r]=o),i},{})),await Ae(["__manual_logout__","__force_logout_reason__"]),await F({logged:!0});break}case"USER_LOGOUT":{await DA();break}case"FORWARD_TO_CHAT":{h.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(i=>{if(i)return h.default.runtime.sendMessage({...e,type:"SEND_TO_CHAT",isForSidepanel:!0});h.default.tabs.sendMessage(t.tab?.id,{...e,type:"SEND_TO_CHAT"})}).catch(()=>{h.default.tabs.sendMessage(t.tab?.id,{...e,type:"SEND_TO_CHAT"})});return}case"CONTINUE_IN_CHAT":{h.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(i=>{if(i)return h.default.runtime.sendMessage({...e,type:"DO_CONTINUE_IN_CHAT",isForSidepanel:!0});h.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_CONTINUE_IN_CHAT"})}).catch(()=>{h.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_CONTINUE_IN_CHAT"})});return}case"SEND_MSG_IN_CHAT":{h.default.runtime.sendMessage({type:"is-sidepanel-open"}).then(i=>{if(i)return h.default.runtime.sendMessage({...e,type:"DO_SEND_MSG_IN_CHAT",isForSidepanel:!0});h.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_SEND_MSG_IN_CHAT"})}).catch(()=>{h.default.tabs.sendMessage(t.tab?.id,{...e,type:"DO_SEND_MSG_IN_CHAT"})});return}case"CHECK_PINNED":return!!(await h.default.action.getUserSettings())?.isOnToolbar;case"OPEN_CHAT_PAGE":return Os("",()=>{h.default.runtime.sendMessage({type:"switchChat",data:{contact:e.contact||"chat",conversation:e.currentCid}})},()=>F({activeConversation:{contact:e.contact||"chat",conversation:e.currentCid}}));case"QUERY_SELECTION":return h.default.tabs.sendMessage(e.tabId||t.tab?.id,{type:"query-selection",selectionText:e.selectionText});case"TOGGLE_HOST_TRANSLATOR_FAB":return zg(e,t);case"TOGGLE_SIDEBAR":{_A(e.isShow);break}case"GUARD_CHATGPT_TAB":{bI();break}case"TOGGLE_TRANSLATOR":h.default.tabs.sendMessage(e.tabId||t.tab?.id,{type:"toggle-translator",show:e.show});break;case"GO_LOGIN":{Eg();break}case"GO_INVITE":{yg();break}case"GET_INVITE_LINK":return H.createInviteLink();case"GET_CHATGPT_PLUGINS":return YQ();case"REMOVE_SELECTION":{let i=await Xe();i?.id&&h.default.tabs.sendMessage(i.id,{type:"remove-selection"});break}case"SEND_TO_CURRENT_TAB":{let i=await Xe();i?.id&&h.default.tabs.sendMessage(i.id,e.data);break}case"CAPTURE_VISIBLE_TAB":return h.default.tabs.captureVisibleTab(void 0,{format:"jpeg"});case"RUNTIME_FORWARD_MSG":return h.default.runtime.sendMessage(e.msg);case"FORWARD_MSG":{let i=await Xe();if(i?.id)return h.default.tabs.sendMessage(i.id,e);break}case"FORWARD_TO_CONTENT":{let i=await Xe();if(i?.id){let r=e.subtype;return delete e.type,delete e.subtype,h.default.tabs.sendMessage(i.id,{type:r,...e})}break}case"FORWARD_MSG_TO_SELF":return h.default.runtime.sendMessage({...e,type:e.originalType});case"GET_SRC_SUFFIX":{let i="",r=await Ec();r.length||await H.signImageCookie(),r=await Ec();let o=r.join("&");return i=o?"?"+o:"",i;break}case"CLEAR_BADGE":return Eo();case"GA_API":return H.googleAnalytics(...Array.from(e.args));case"SIDER_STAT_API":return Lr(...Array.from(e.args));case"DETECT_PAGE_LANGUAGE":return(await h.default.tabs.detectLanguage()).replace("-","_");case"TRANSLATION_CACHE":{let i=Gg();if(e.action==="get")return await Promise.all(e.keys.map(r=>i.getData(r)));if(e.action==="set")return await Promise.all(e.values.map(r=>i.setData(r)));if(e.action==="clear")return await i.clearData();break}case"DEMO_TTS_CACHE":{let i=eo();if(e.action==="get")return await i.getData(e.key);if(e.action==="set")return await i.setData(e.value);if(e.action==="clear")return await i.clearData();break}case"GET_PROMOTE_DATA":{Vg().then(i=>{let r={type:"PROMOTE_DATA",data:i};return t.tab?.id?h.default.tabs.sendMessage(t.tab.id,r):h.default.runtime.sendMessage(r)});break}case"GET_IMAGE":return Co(e.id).then(i=>i);case"GET_CHATGPT_UPLOAD_URL":return hI(e.data,e.isMyFile);case"REPORT_CHATGPT_FILE_UPLOADED":return EI(e.fileId);case"GET_CHATGPT_FILE_STATUS":return SI(e.fileId);case"GET_INTERPRETER_DOWNLOAD_URL":return yI(e.data);case"GET_IS_SIDEPANEL_OPEN":return h.default.runtime.getContexts?h.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(i=>i.length>0):!1;case"OPEN_SIDEPANEL":return VQ(t.tab);case"CLOSE_SIDEPANEL":return!h.default.sidePanel||!h.default.sidePanel.setOptions?!1:h.default.sidePanel.setOptions({enabled:!1}).then(()=>h.default.sidePanel.setOptions({enabled:!0}));case"KEEP_GPT_IN_SIDEBAR":return DI(e.id);case"GET_FAVICON":return t.tab?.favIconUrl;case"GET_TABS":return h.default.tabs.query({currentWindow:!0});case"GET_CURRENT_TAB":return Xe();case"GET_READABILITY_TEXT_FROM_TAB":return h.default.tabs.sendMessage(e.tabId,{type:"get-readability-text"});case"ENSURE_CONTENT":return hA(e.tabId);case"GET_SIDEPANEL_OPEN":return h.default.runtime.getContexts?.({contextTypes:["SIDE_PANEL"]}).then(i=>i.length>0);case"OPEN_ARTIFACT_PAGE":return h.default.runtime.getContexts?.({documentUrls:[Dt("artifacts.html")]}).then(i=>{i.length===0?It({url:"/artifacts.html"}):h.default.windows.getCurrent().then(r=>{i[0].windowId!==r.id?h.default.tabs.move(i[0].tabId,{windowId:r.id,index:-1}).then(()=>{h.default.tabs.update(i[0].tabId,{active:!0})}):h.default.tabs.update(i[0].tabId,{active:!0})})});case"OPEN_BLOCK_PREVIEW_PAGE":return h.default.runtime.getContexts?.({documentUrls:[Dt("block-preview.html")]}).then(i=>{i.length===0?It({url:"/block-preview.html"}):h.default.windows.getCurrent().then(r=>{i[0].windowId!==r.id?h.default.tabs.move(i[0].tabId,{windowId:r.id,index:-1}).then(()=>{h.default.tabs.update(i[0].tabId,{active:!0})}):h.default.tabs.update(i[0].tabId,{active:!0})})});case"CLEAR_ARTIFACTS_DATA":return h.default.storage.local.remove("artifactsData");case"UPLOAD_ROAST":{let{obj:i,siteType:r}=e,o=`https://roast-vs-boast.${Y.domain}/api/combined_agent_direct`;return r==="facebook"?o=`https://roast-vs-boast.${Y.domain}/api/facebook/roast`:r==="instagram"&&(o=`https://roast-vs-boast.${Y.domain}/api/instagram_agent_direct`),fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:e.obj})}).then(n=>n.json())}default:break}return new Promise(i=>{setTimeout(()=>{i()},32)})});async function Ec(){return(await h.default.cookies.getAll({domain:Y.domain})).filter(t=>t.name.startsWith("CloudFront-")&&t.domain==="."+Y.domain).map(t=>t.name.split("CloudFront-")[1]+"="+t.value)}Z("sider-image-creator-get-signed-cookie",pg);Z("sider-image-creator-get-engine-list",Cg);var qA;Z("sider-image-creator-get-tools-list",()=>qA||(qA=Qg(),qA.then(e=>(wt("siderImageCreatorToolsList",e.tools),e)).finally(()=>qA=void 0)));Z("sider-image-creator-text-to-image",({data:e})=>rg(e));Z("sider-image-creator-image-to-image",({data:e})=>og(e));Z("sider-image-creator-image-to-image-upscale",({data:e})=>ng(e));Z("sider-image-creator-image-to-image-masking",({data:e})=>ag(e));Z("sider-image-creator-image-to-image-inpainting",({data:e})=>sg(e));Z("sider-image-creator-image-to-image-remove-text",({data:e})=>gg(e));Z("sider-image-creator-image-to-image-remove-background",({data:e})=>Ig(e));Z("sider-image-creator-image-to-image-replace-background",({data:e})=>lg(e));Z("sider-image-creator-image-to-image-upscaling",({data:e})=>cg(e));Z("sider-image-creator-image-to-image-portrait-depth",({data:e})=>ug(e));Z("sider-image-creator-image-to-image-portrait-normals",({data:e})=>fg(e));Z("sider-image-creator-image-to-image-variation",({data:e})=>Bg(e));Z("open-standalone-page",()=>Pr());Z("detect-language",({data:e,sender:t})=>h.default.tabs.detectLanguage(e??t.tab?.id));Z("get-window-value",async({data:{tabId:e,keys:t},sender:A})=>{let i=e==="sender"?A.tab?.id:e;if(i===void 0)throw new Error("tabId is required");return h.default.scripting.executeScript({args:[t],target:{tabId:i},func:r=>{let o={};e:for(let[n,a]of Object.entries(r)){let s=window;for(let g of a){if(s==null){o[n]=void 0;continue e}s=s[g]}o[n]=s}return o},world:"MAIN"}).then(([r])=>{if(!r)throw new Error("executeScript failed");let{error:o,result:n}=r;if(o)throw o instanceof Error?o:new Error("executeScript failed: unknown error");return n})});Z("detect-youtube-ad",async({data:{tabId:e},sender:t})=>{let A=e==="sender"?t.tab?.id:e;if(A===void 0)throw new Error("tabId is required");return h.default.scripting.executeScript({target:{tabId:A},func:()=>{let i=document.querySelector("#movie_player");if(!i)return;function r(o,n){let a=new CustomEvent("sider-onYoutubeChange",{detail:{eventName:o,value:n}});window.dispatchEvent(a)}i.addEventListener("onAdStateChange",o=>{r("onAdStateChange",o)}),i.addEventListener("onStateChange",o=>{r("onStateChange",o)})},world:"MAIN"}).then(([i])=>{if(!i)throw new Error("executeScript failed");let{error:r,result:o}=i;if(r)throw r instanceof Error?r:new Error("executeScript failed: unknown error");return o})});Z("fetch-base64-from-bg",async({data:e})=>{let{url:t}=e,i=await(await fetch(t)).blob();return{base64:await je(i),size:i.size,type:i.type}});Z("get-sender",({sender:e})=>e);chrome&&chrome.sidePanel&&chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>{});h.default.runtime.onInstalled.addListener(async e=>{if(e.reason==="install"&&(h.default.storage.local.set({installedAt:Date.now(),installedFirstVersion:h.default.runtime.getManifest().version,__autoShowSwitchbar__:!0}),await uc(),setTimeout(async()=>{h.default.tabs.create({url:Y.origin+"/setup"})},200)),(e.reason==="install"||e.reason==="update")&&(To(e.reason==="update"),h.default.storage.local.get("provider:siderApi").then(t=>{t&&t["provider:siderApi"]?.model==="gpt-4"&&h.default.storage.local.set({"provider:siderApi":{model:"gpt-4o"}}),t&&t["provider:siderApi"]?.model==="gemini-pro"&&h.default.storage.local.set({"provider:siderApi":{model:"gemini-1.5-flash"}}),t&&(t["provider:siderApi"]?.model==="claude-3-sonnet"||t["provider:siderApi"]?.model==="claude-3-opus")&&h.default.storage.local.set({"provider:siderApi":{model:"claude-3.5-sonnet"}})}),h.default.storage.local.get(["autoTools","forceOpenArtifacts"]).then(t=>{if(t&&!t.forceOpenArtifacts&&(!t.autoTools||!t.autoTools.includes("artifacts"))){let A=t.autoTools||[];h.default.storage.local.set({autoTools:["artifacts",...A],forceOpenArtifacts:!0})}}),h.default.storage.local.get(["toolsShowNew","isSetThinkingModeShowNew"]).then(t=>{(!t||!t.toolsShowNew||!t.toolsShowNew.includes("thinking_mode"))&&(t.isSetThinkingModeShowNew||h.default.storage.local.set({toolsShowNew:["thinking_mode",...t.toolsShowNew||[]],isSetThinkingModeShowNew:!0}))}),h.default.storage.local.get("quickAction:provider:siderApi").then(t=>{t&&(t["quickAction:provider:siderApi"]?.model==="claude-3-sonnet"||t["quickAction:provider:siderApi"]?.model==="claude-3-opus")&&h.default.storage.local.set({"quickAction:provider:siderApi":{model:"claude-3.5-sonnet"}})}),h.default.storage.local.get(["finishSwitchSider","provider:siderApi"]).then(t=>{t&&!t.finishSwitchSider&&t["provider:siderApi"]?.model==="gpt-3.5"?h.default.storage.local.set({"provider:siderApi":{model:"sider"},finishSwitchSider:!0}):h.default.storage.local.set({finishSwitchSider:!0})}),h.default.storage.local.get("siderGrammarKey").then(t=>{t&&t.siderGrammarKey?.model==="gpt-4"&&h.default.storage.local.set({siderGrammarKey:{model:"gpt-4o"}})}),h.default.storage.local.get("promptTemplates").then(t=>{if(t&&t.promptTemplates){let A=t.promptTemplates;h.default.storage.local.get("selectedSearchTemplate").then(i=>{if(i&&i.selectedSearchTemplate){let r=A.filter(s=>s.id!=="list"&&s.id!=="suggest"),o=r.findIndex(s=>s.id==="default"),n=ze.find(s=>s.id==="default");o>-1&&n&&(r[o].template=n.template,r[o].shorterAnswerTemplate=n.shorterAnswerTemplate,r[o].title=n.title),h.default.storage.local.set({promptTemplates:r}),r.find(s=>s.id===i.selectedSearchTemplate.id)||h.default.storage.local.set({selectedSearchTemplate:{id:"default",title:"Default"}})}})}}),h.default.tabs.query({active:!0,currentWindow:!0}).then(t=>{let A=t[0].id;A!==void 0&&hA(A)})),e.reason==="update"){let t=kg[0];h.default.storage.local.get({shownChangelogVersion:"",installedFirstVersion:"1.0.0"}).then(({shownChangelogVersion:A,installedFirstVersion:i})=>{A!==t.version&&t.notifyType==="modal"&&Kr(i)!==Kr(t.version)&&(NI(),hc(hs))}),h.default.storage.local.get("webAccessEnabled").then(A=>{A.webAccessEnabled&&(h.default.storage.local.set({autoTools:["search"]}),h.default.storage.local.remove("webAccessEnabled"))}),h.default.storage.local.remove(["webAppNetwork","chatRequirements"]),Ae(["__GET_TMP_GPT5_INFO_AT__","__InviteQueryArrivalQueryAt__","__INVITE_QUERY_ARRIVAL_AT__","__LAST_REFRESH_DISPLAY_DATA__","__REFRESH_DISPLAY_DATA_AT__","__LOAD_TTS_INIT_DATA_AT__","__SCHEDULE_GET_CONFIG_RUN_AT__","__SCHEDULE_GET_PRICING_RUN_AT__","__SCHEDULE_GET_PROMPTS_RUN_AT__","__SCHEDULE_PULL_SETTINGS_RUN_AT__","__SCHEDULE_RUN_AT__","__SCHEDULE_VIPINFO_RUN_AT__","ratingTipShowTimes","lastTranslateWidgetLang"]),ae==="4.18.0"&&eo().clearData()}h.default.alarms.create("refresh-image-cookie",{periodInMinutes:5*24*60})});h.default.alarms.onAlarm.addListener(e=>{e.name==="refresh-image-cookie"&&H.signImageCookie()});h.default.tabs.onActivated.addListener(e=>{let t=e.tabId;hA(t),bg(t)});ec();h.default.runtime.onMessageExternal.addListener((e,t,A)=>{if(ms.includes(t.id||""))switch(e.type){case"SIDER_OCR":A(!0),e.data?.img&&Mo(e.data.img);break;default:A(!0),_A();break}});h.default.action.onClicked.addListener(e=>{e.status==="loading"?h.default.runtime.onMessage.addListener(function t(A,i){i.tab&&i.tab.id===e.id&&A.type==="sidebar-ready"&&(h.default.runtime.onMessage.removeListener(t),_A())}):_A(),Eo()});async function _A(e){let t=await h.default.tabs.query({active:!0,currentWindow:!0});try{return await h.default.tabs.sendMessage(t[0].id,{type:"toggle-sidebar",isShow:e}),{action:"close"}}catch{return Pr(),!1}}var YQ=ue(async function(){let A=(await wI()).items;if(Array.isArray(A)){let i=A.map(r=>({id:r.id,logo:r.manifest.logo_url,name:r.manifest.name_for_human,description:r.manifest.description_for_human}));return h.default.storage.local.set({chatgptPlugins:i})}},1e3);h.default.runtime.setUninstallURL("https://sider.ai/uninstall?app_version="+h.default.runtime.getManifest().version);function VQ(e){return!h.default.sidePanel||!h.default.sidePanel.open||e?.windowId===void 0?!1:h.default.sidePanel.open({windowId:e?.windowId}).then(async()=>h.default.runtime.getContexts?await h.default.runtime.getContexts({contextTypes:["SIDE_PANEL"]}).then(A=>A.length>0):!1).catch(t=>!1)}h.default.storage.local.onChanged.addListener(e=>{e.language&&e.language.newValue&&Ys(e.language.newValue,!0)});})();
